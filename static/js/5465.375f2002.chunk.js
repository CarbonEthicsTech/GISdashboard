"use strict";(self.webpackChunkgis_dashboard=self.webpackChunkgis_dashboard||[]).push([[5465],{49901:function(e,t,r){r.d(t,{G:function(){return o}});var n=r(29439),i=r(15671),s=r(43144),a=r(10064),o=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";(0,i.Z)(this,e),this.major=t,this.minor=r,this._context=n}return(0,s.Z)(e,[{key:"lessThan",value:function(e,t){return this.major<e||e===this.major&&this.minor<t}},{key:"since",value:function(e,t){return!this.lessThan(e,t)}},{key:"validate",value:function(e){if(this.major!==e.major){var t=this._context&&this._context+":",r=this._context&&this._context+" ";throw new a.Z(t+"unsupported-version","Required major ".concat(r,"version is '").concat(this.major,"', but got '${version.major}.${version.minor}'"),{version:e})}}},{key:"clone",value:function(){return new e(this.major,this.minor,this._context)}}],[{key:"parse",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=t.split("."),s=(0,n.Z)(i,2),o=s[0],u=s[1],l=/^\s*\d+\s*$/;if(!o||!o.match||!l.test(o))throw new a.Z((r&&r+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:t});if(!u||!u.match||!l.test(u))throw new a.Z((r&&r+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:t});return new e(parseInt(o,10),parseInt(u,10),r)}}]),e}()},75465:function(e,t,r){r.r(t),r.d(t,{DictionaryLoader:function(){return w}});var n=r(93433),i=r(1413),s=r(29439),a=r(74165),o=r(37762),u=r(15861),l=r(15671),c=r(43144),h=r(51995),f=r(76200),p=r(10064),y=(r(93169),r(32718)),m=r(16054),d=r(66978),v=r(643),b=r(49901),g=r(52410),_=r(819),k=r(75021),x="esri.renderers.support.DictionaryLoader",Z={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}},w=function(){function e(t,r,n){(0,l.Z)(this,e),this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new m.z(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=t,this.config=r,this.fieldMap=n}return(0,c.Z)(e,[{key:"getSymbolFields",value:function(){return this._symbolFields}},{key:"getSymbolAsync",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t,r){var n,i,s,u,l,c,f,p,y,m,b,g,_,k,x,Z,w,C,S,M,P,I,L,j,R,T,N,F=this;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(r)),e.prev=1,e.next=4,this._dictionaryPromise;case 4:n=e.sent,e.next=11;break;case 7:if(e.prev=7,e.t0=e.catch(1),!(0,d.D_)(e.t0)){e.next=11;break}return e.abrupt("return",(this._dictionaryPromise=null,null));case 11:if(i=this._dictionaryVersion&&this._dictionaryVersion.since(4,0),s={},this.fieldMap){u=(0,o.Z)(this._symbolFields);try{for(u.s();!(l=u.n()).done;)c=l.value,f=this._getFieldName(this.fieldMap[c]),s[c]=f?i?t.attributes[f]:""+t.attributes[f]:""}catch(a){u.e(a)}finally{u.f()}}p=null,e.prev=14,p=null===(y=n)||void 0===y?void 0:y(s,r),e.next=21;break;case 18:return e.prev=18,e.t1=e.catch(14),e.abrupt("return",null);case 21:if(p&&"string"==typeof p){e.next=23;break}return e.abrupt("return",null);case 23:if(m=(0,v.hP)(p).toString(),!(b=this._symbolCache.get(m))){e.next=26;break}return e.abrupt("return",(b.catch((function(){F._symbolCache.pop(m)})),b));case 26:g=p.split(";"),_=[],k=[],x=(0,o.Z)(g),e.prev=28,x.s();case 30:if((Z=x.n()).done){e.next=62;break}if(!(w=Z.value)){e.next=60;break}if(!w.includes("po:")){e.next=38;break}3===(C=w.substr(3).split("|")).length&&(S=C[0],M=C[1],P=C[2],"DashTemplate"===M?P=P.split(" ").map((function(e){return Number(e)})):"Color"===M?(I=new h.Z(P).toRgba(),P=[I[0],I[1],I[2],255*I[3]]):P=Number(P),k.push({primitiveName:S,propertyName:M,value:P})),e.next=60;break;case 38:if(!w.includes("|")){e.next=59;break}L=(0,o.Z)(w.split("|")),e.prev=40,L.s();case 42:if((j=L.n()).done){e.next=49;break}if(R=j.value,!this._itemNames.has(R)){e.next=47;break}return _.push(R),e.abrupt("break",49);case 47:e.next=42;break;case 49:e.next=54;break;case 51:e.prev=51,e.t2=e.catch(40),L.e(e.t2);case 54:return e.prev=54,L.f(),e.finish(54);case 57:e.next=60;break;case 59:this._itemNames.has(w)&&_.push(w);case 60:e.next=30;break;case 62:e.next=67;break;case 64:e.prev=64,e.t3=e.catch(28),x.e(e.t3);case 67:return e.prev=67,x.f(),e.finish(67);case 70:return T=null==t.geometry||!t.geometry.hasZ&&"point"===t.geometry.type,N=this._cimPartsToCIMSymbol(_,k,T,r),e.abrupt("return",(this._symbolCache.put(m,N,1),N));case 72:case"end":return e.stop()}}),e,this,[[1,7],[14,18],[28,64,67,70],[40,51,54,57]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"fetchResources",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t){var r,n,u,l,c,h,m,d,v,k,Z,w,C,S,M,P,I,L,j,R,T,N=this;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._dictionaryPromise){e.next=2;break}return e.abrupt("return",this._dictionaryPromise);case 2:if(this.url){e.next=4;break}return e.abrupt("return",void y.Z.getLogger(x).error("no valid URL!"));case 4:return r=(0,f.default)(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:null!=t?t.signal:null}),e.next=7,Promise.all([r,(0,_.LC)()]);case 7:if(n=e.sent,u=(0,s.Z)(n,1),l=u[0].data){e.next=12;break}throw this._dictionaryPromise=null,new p.Z("esri.renderers.DictionaryRenderer","Bad dictionary data!");case 12:if(c=l.authoringInfo,h=l.dictionary_version,m=l.expression,d=l.itemsNames,v=m,k=!1,h&&(this._dictionaryVersion=b.G.parse(h),k=this._dictionaryVersion.since(4,0)),this._refSymbolUrlTemplate=this.url+"/"+l.cimRefTemplateUrl,this._itemNames=new Set(d),this._symbolFields=c.symbol,Z={},this.config)for(C in w=this.config)Z[C]=w[C];if(c.configuration){S=(0,o.Z)(c.configuration);try{for(S.s();!(M=S.n()).done;)P=M.value,Z.hasOwnProperty(P.name)||(Z[P.name]=P.value)}catch(F){S.e(F)}finally{S.f()}}if(I=[],null==t||!t.fields||!this.fieldMap){e.next=36;break}L=(0,o.Z)(this._symbolFields),e.prev=21,R=(0,a.Z)().mark((function e(){var r,n,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=j.value,n=N.fieldMap[r],s=t.fields.filter((function(e){return e.name.toLowerCase()===(null===n||void 0===n?void 0:n.toLowerCase())})),s.length>0&&I.push((0,i.Z)((0,i.Z)({},s[0]),{},{type:k?s[0].type:"esriFieldTypeString"}));case 3:case"end":return e.stop()}}),e)})),L.s();case 24:if((j=L.n()).done){e.next=28;break}return e.delegateYield(R(),"t0",26);case 26:e.next=24;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(21),L.e(e.t1);case 33:return e.prev=33,L.f(),e.finish(33);case 36:return I.length>0&&(this._fieldIndex=new g.Z(I)),T=(0,_.pp)(v,null!=t?t.spatialReference:null,I,Z).then((function(e){var t={scale:0};return function(r,n){var i;if(null==e)return null;var s=e.repurposeFeature({geometry:null,attributes:r});return t.scale=null!=n&&null!==(i=n.scale)&&void 0!==i?i:void 0,e.evaluate({$feature:s,$view:t},e.services)}})).catch((function(e){return y.Z.getLogger(x).error("Creating dictinoary expression failed:",e),null})),e.abrupt("return",(this._dictionaryPromise=T,T));case 39:case"end":return e.stop()}}),e,this,[[21,30,33,36]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_cimPartsToCIMSymbol",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t,r,n,i){var s,u,l,c,h,f;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s=new Array(t.length),u=0;u<t.length;u++)s[u]=this._getSymbolPart(t[u],i);return e.next=4,Promise.all(s);case 4:if(l=e.sent,c=this.fieldMap){h=(0,o.Z)(l);try{for(h.s();!(f=h.n()).done;)C(f.value,c)}catch(a){h.e(a)}finally{h.f()}}return e.abrupt("return",new k.Z({data:this._combineSymbolParts(l,r,n)}));case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"_getSymbolPart",value:function(){var e=(0,u.Z)((0,a.Z)().mark((function e(t,r){var n,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._ongoingRequests.has(t)){e.next=2;break}return e.abrupt("return",this._ongoingRequests.get(t).then((function(e){return e.data})));case 2:return n=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,t),s=(0,f.default)(n,(0,i.Z)({responseType:"json",query:{f:"json"}},r)),this._ongoingRequests.set(t,s),e.prev=4,e.next=7,s;case 7:return e.abrupt("return",e.sent.data);case 10:throw e.prev=10,e.t0=e.catch(4),this._ongoingRequests.delete(t),e.t0;case 13:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_combineSymbolParts",value:function(e,t,r){if(!e||0===e.length)return null;var s=(0,i.Z)({},e[0]);if(e.length>1){s.symbolLayers=[];var a,u=(0,o.Z)(e);try{for(u.s();!(a=u.n()).done;){var l,c=a.value;(l=s.symbolLayers).unshift.apply(l,(0,n.Z)(c.symbolLayers))}}catch(h){u.e(h)}finally{u.f()}}return r&&(s.callout=Z),{type:"CIMSymbolReference",symbol:s,primitiveOverrides:t}}},{key:"_getFieldName",value:function(e){if(null!==this._fieldIndex){var t=this._fieldIndex.get(e);return t?t.name:e}return e}}]),e}();function C(e,t){if(e){var r=e.symbolLayers;if(r)for(var n=r.length;n--;){var i=r[n];i&&!1!==i.enable&&"CIMVectorMarker"===i.type&&S(i,t)}}}function S(e,t){var r=e.markerGraphics;if(r){var n,i=(0,o.Z)(r);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s){var a=s.symbol;if(a)switch(a.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":C(a,t);break;case"CIMTextSymbol":a.fieldMap=t}}}}catch(u){i.e(u)}finally{i.f()}}}}}]);
//# sourceMappingURL=5465.375f2002.chunk.js.map