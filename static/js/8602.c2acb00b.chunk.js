"use strict";(self.webpackChunkgis_dashboard=self.webpackChunkgis_dashboard||[]).push([[8602],{83040:function(e,t,i){i.d(t,{Z:function(){return g}});var r,n=i(15671),a=i(43144),o=i(60136),s=i(29388),l=i(27366),u=i(43404),d=i(46784),p=i(49861),c=i(25243),y=(i(63780),i(93169),i(27135)),h=i(38511),f=i(69912),v=i(66591),m=i(85249),_=new u.X({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"}),b=r=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var r;return(0,n.Z)(this,i),(r=t.call(this,e)).alias=null,r.defaultValue=void 0,r.description=null,r.domain=null,r.editable=!0,r.length=-1,r.name=null,r.nullable=!0,r.type=null,r.valueType=null,r.visible=!0,r}return(0,a.Z)(i,[{key:"readDescription",value:function(e,t){var i,r,n=t.description,a=null;try{a=n?JSON.parse(n):null}catch(o){}return null!==(i=null===(r=a)||void 0===r?void 0:r.value)&&void 0!==i?i:null}},{key:"readValueType",value:function(e,t){var i=t.description,r=null;try{r=i?JSON.parse(i):null}catch(n){}return r?_.fromJSON(r.fieldValueType):null}},{key:"clone",value:function(){return new r({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}}]),i}(d.wq);(0,l._)([(0,p.Cb)({type:String,json:{write:!0}})],b.prototype,"alias",void 0),(0,l._)([(0,p.Cb)({type:[String,Number],json:{write:{allowNull:!0}}})],b.prototype,"defaultValue",void 0),(0,l._)([(0,p.Cb)()],b.prototype,"description",void 0),(0,l._)([(0,h.r)("description")],b.prototype,"readDescription",null),(0,l._)([(0,p.Cb)({types:v.V5,json:{read:{reader:v.im},write:!0}})],b.prototype,"domain",void 0),(0,l._)([(0,p.Cb)({type:Boolean,json:{write:!0}})],b.prototype,"editable",void 0),(0,l._)([(0,p.Cb)({type:c.z8,json:{write:!0}})],b.prototype,"length",void 0),(0,l._)([(0,p.Cb)({type:String,json:{write:!0}})],b.prototype,"name",void 0),(0,l._)([(0,p.Cb)({type:Boolean,json:{write:!0}})],b.prototype,"nullable",void 0),(0,l._)([(0,y.J)(m.v)],b.prototype,"type",void 0),(0,l._)([(0,p.Cb)()],b.prototype,"valueType",void 0),(0,l._)([(0,h.r)("valueType",["description"])],b.prototype,"readValueType",null),(0,l._)([(0,p.Cb)({type:Boolean,json:{read:!1}})],b.prototype,"visible",void 0);var g=b=r=(0,l._)([(0,f.j)("esri.layers.support.Field")],b)},66591:function(e,t,i){i.d(t,{im:function(){return x},V5:function(){return F}});i(93169);var r,n=i(15671),a=i(43144),o=i(60136),s=i(29388),l=i(27366),u=i(84652),d=i(49861),p=(i(25243),i(27135)),c=i(69912),y=i(46784),h=(i(63780),r=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var r;return(0,n.Z)(this,i),(r=t.call(this,e)).name=null,r.code=null,r}return(0,a.Z)(i,[{key:"clone",value:function(){return new r({name:this.name,code:this.code})}}]),i}(y.wq));(0,l._)([(0,d.Cb)({type:String,json:{write:!0}})],h.prototype,"name",void 0),(0,l._)([(0,d.Cb)({type:[String,Number],json:{write:!0}})],h.prototype,"code",void 0),h=r=(0,l._)([(0,c.j)("esri.layers.support.CodedValue")],h);var f=new(i(43404).X)({inherited:"inherited",codedValue:"coded-value",range:"range"}),v=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var r;return(0,n.Z)(this,i),(r=t.call(this,e)).name=null,r.type=null,r}return(0,a.Z)(i)}(y.wq);(0,l._)([(0,d.Cb)({type:String,json:{write:!0}})],v.prototype,"name",void 0),(0,l._)([(0,p.J)(f)],v.prototype,"type",void 0);var m,_=v=(0,l._)([(0,c.j)("esri.layers.support.Domain")],v),b=m=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var r;return(0,n.Z)(this,i),(r=t.call(this,e)).codedValues=null,r.type="coded-value",r}return(0,a.Z)(i,[{key:"getName",value:function(e){var t=null;if(this.codedValues){var i=String(e);this.codedValues.some((function(e){return String(e.code)===i&&(t=e.name),!!t}))}return t}},{key:"clone",value:function(){return new m({codedValues:(0,u.d9)(this.codedValues),name:this.name})}}]),i}(_);(0,l._)([(0,d.Cb)({type:[h],json:{write:!0}})],b.prototype,"codedValues",void 0),(0,l._)([(0,p.J)({codedValue:"coded-value"})],b.prototype,"type",void 0);var g,w=b=m=(0,l._)([(0,c.j)("esri.layers.support.CodedValueDomain")],b),T=(i(32718),i(10064),g=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var r;return(0,n.Z)(this,i),(r=t.call(this,e)).type="inherited",r}return(0,a.Z)(i,[{key:"clone",value:function(){return new g}}]),i}(_));(0,l._)([(0,p.J)({inherited:"inherited"})],T.prototype,"type",void 0);var Z,k=T=g=(0,l._)([(0,c.j)("esri.layers.support.InheritedDomain")],T),V=Z=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(e){var r;return(0,n.Z)(this,i),(r=t.call(this,e)).maxValue=null,r.minValue=null,r.type="range",r}return(0,a.Z)(i,[{key:"clone",value:function(){return new Z({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}}]),i}(_);(0,l._)([(0,d.Cb)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(e,t,i){t[i]=[this.minValue||0,e]}}}})],V.prototype,"maxValue",void 0),(0,l._)([(0,d.Cb)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[0]}},write:{target:"range",writer:function(e,t,i){t[i]=[e,this.maxValue||0]}}}})],V.prototype,"minValue",void 0),(0,l._)([(0,p.J)({range:"range"})],V.prototype,"type",void 0);var I=V=Z=(0,l._)([(0,c.j)("esri.layers.support.RangeDomain")],V),F={key:"type",base:_,typeMap:{range:V,"coded-value":w,inherited:k}};function x(e){if(!e||!e.type)return null;switch(e.type){case"range":return I.fromJSON(e);case"codedValue":return w.fromJSON(e);case"inherited":return k.fromJSON(e)}return null}},85249:function(e,t,i){i.d(t,{v:function(){return r}});var r=new(i(43404).X)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"})},37481:function(e,t,i){i.r(t),i.d(t,{default:function(){return w}});var r=i(74165),n=i(15861),a=i(37762),o=i(15671),s=i(43144),l=i(10064),u=i(32718),d=i(65156),p=i(376),c=i(77095),y=i(20311),h=i(31904),f=i(86638),v=i(36876),m=u.Z.getLogger("esri.views.2d.layers.features.support.whereUtils"),_={getAttribute:function(e,t){return e.field(t)}};function b(e,t){return g.apply(this,arguments)}function g(){return g=(0,n.Z)((0,r.Z)().mark((function e(t,n){var a,o,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e(8562).then(i.bind(i,48562));case 2:return a=e.sent,e.prev=3,(o=a.WhereClause.create(t,n)).isStandardized||(s=new l.Z("mapview - bad input","Unable to apply filter's definition expression, as expression is not standardized.",o),m.error(s)),e.abrupt("return",(function(e){var t=e.readArcadeFeature();return o.testFeature(t,_)}));case 9:return e.prev=9,e.t0=e.catch(3),e.abrupt("return",(m.warn("mapview-bad-where-clause","Encountered an error when evaluating where clause",t),function(e){return!0}));case 12:case"end":return e.stop()}}),e,null,[[3,9]])}))),g.apply(this,arguments)}var w=function(){function e(t){(0,o.Z)(this,e),this._geometryBounds=(0,d.Ue)(),this._idToVisibility=new Map,this._serviceInfo=t}return(0,s.Z)(e,[{key:"hash",get:function(){return this._hash}},{key:"check",value:function(e){return this._applyFilter(e)}},{key:"clear",value:function(){var e=this._resetAllHiddenIds();return this.update(),{show:e,hide:[]}}},{key:"invalidate",value:function(){var e=this;this._idToVisibility.forEach((function(t,i){e._idToVisibility.set(i,0)}))}},{key:"setKnownIds",value:function(e){var t,i=(0,a.Z)(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;this._idToVisibility.set(r,1)}}catch(n){i.e(n)}finally{i.f()}}},{key:"setTrue",value:function(e){var t=this,i=[],r=[],n=new Set(e);return this._idToVisibility.forEach((function(e,a){var o=!!(1&t._idToVisibility.get(a)),s=n.has(a);!o&&s?i.push(a):o&&!s&&r.push(a),t._idToVisibility.set(a,s?3:0)})),{show:i,hide:r}}},{key:"createQuery",value:function(){var e=this.geometry,t=this.spatialRel,i=this.where,r=this.timeExtent,n=this.objectIds;return f.Z.fromJSON({geometry:e,spatialRel:t,where:i,timeExtent:r,objectIds:n})}},{key:"update",value:function(){var e=(0,n.Z)((0,r.Z)().mark((function e(t,i){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._hash=JSON.stringify(t),e.next=3,(0,h.j6)(t,null,i);case 3:return n=e.sent,e.next=6,Promise.all([this._setGeometryFilter(n),this._setIdFilter(n),this._setAttributeFilter(n),this._setTimeFilter(n)]);case 6:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"_setAttributeFilter",value:function(){var e=(0,n.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.where){e.next=2;break}return e.abrupt("return",(this._clause=null,void(this.where=null)));case 2:return e.next=4,b(t.where,this._serviceInfo.fieldsIndex);case 4:this._clause=e.sent,this.where=t.where;case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_setIdFilter",value:function(e){this._idsToShow=e&&e.objectIds&&new Set(e.objectIds),this._idsToHide=e&&e.hiddenIds&&new Set(e.hiddenIds),this.objectIds=e&&e.objectIds}},{key:"_setGeometryFilter",value:function(){var e=(0,n.Z)((0,r.Z)().mark((function e(t){var i,n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.geometry){e.next=2;break}return e.abrupt("return",(this._spatialQueryOperator=null,this.geometry=null,void(this.spatialRel=null)));case 2:return i=t.geometry,n=t.spatialRel||"esriSpatialRelIntersects",e.next=6,(0,c.cW)(n,i,this._serviceInfo.geometryType,this._serviceInfo.hasZ,this._serviceInfo.hasM);case 6:a=e.sent,(0,p.$P)(this._geometryBounds,i),this._spatialQueryOperator=a,this.geometry=i,this.spatialRel=n;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_setTimeFilter",value:function(e){if(this.timeExtent=this._timeOperator=null,e&&e.timeExtent)if(this._serviceInfo.timeInfo)this.timeExtent=e.timeExtent,this._timeOperator=(0,y.y)(this._serviceInfo.timeInfo,e.timeExtent,v.k);else{var t=new l.Z("feature-layer-view:time-filter-not-available","Unable to apply time filter, as layer doesn't have time metadata.",e.timeExtent);u.Z.getLogger("esri.views.2d.layers.features.controllers.FeatureFilter").error(t)}}},{key:"_applyFilter",value:function(e){return this._filterByGeometry(e)&&this._filterById(e)&&this._filterByTime(e)&&this._filterByExpression(e)}},{key:"_filterByExpression",value:function(e){return!this.where||this._clause(e)}},{key:"_filterById",value:function(e){return(!this._idsToHide||!this._idsToHide.size||!this._idsToHide.has(e.getObjectId()))&&(!this._idsToShow||!this._idsToShow.size||this._idsToShow.has(e.getObjectId()))}},{key:"_filterByGeometry",value:function(e){if(!this.geometry)return!0;var t=e.readHydratedGeometry();return!!t&&this._spatialQueryOperator(t)}},{key:"_filterByTime",value:function(e){return null==this._timeOperator||this._timeOperator(e)}},{key:"_resetAllHiddenIds",value:function(){var e=this,t=[];return this._idToVisibility.forEach((function(i,r){1&i||(e._idToVisibility.set(r,1),t.push(r))})),t}}]),e}()}}]);
//# sourceMappingURL=8602.c2acb00b.chunk.js.map