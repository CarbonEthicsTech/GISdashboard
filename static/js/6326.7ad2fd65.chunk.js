"use strict";(self.webpackChunkgis_dashboard=self.webpackChunkgis_dashboard||[]).push([[6326],{83040:function(e,t,r){r.d(t,{Z:function(){return x}});var n,i=r(15671),a=r(43144),o=r(60136),s=r(29388),l=r(27366),u=r(43404),c=r(46784),p=r(49861),h=r(25243),f=(r(63780),r(93169),r(27135)),d=r(38511),y=r(69912),m=r(66591),v=r(85249),g=new u.X({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"}),_=n=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).alias=null,n.defaultValue=void 0,n.description=null,n.domain=null,n.editable=!0,n.length=-1,n.name=null,n.nullable=!0,n.type=null,n.valueType=null,n.visible=!0,n}return(0,a.Z)(r,[{key:"readDescription",value:function(e,t){var r,n,i=t.description,a=null;try{a=i?JSON.parse(i):null}catch(o){}return null!==(r=null===(n=a)||void 0===n?void 0:n.value)&&void 0!==r?r:null}},{key:"readValueType",value:function(e,t){var r=t.description,n=null;try{n=r?JSON.parse(r):null}catch(i){}return n?g.fromJSON(n.fieldValueType):null}},{key:"clone",value:function(){return new n({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}}]),r}(c.wq);(0,l._)([(0,p.Cb)({type:String,json:{write:!0}})],_.prototype,"alias",void 0),(0,l._)([(0,p.Cb)({type:[String,Number],json:{write:{allowNull:!0}}})],_.prototype,"defaultValue",void 0),(0,l._)([(0,p.Cb)()],_.prototype,"description",void 0),(0,l._)([(0,d.r)("description")],_.prototype,"readDescription",null),(0,l._)([(0,p.Cb)({types:m.V5,json:{read:{reader:m.im},write:!0}})],_.prototype,"domain",void 0),(0,l._)([(0,p.Cb)({type:Boolean,json:{write:!0}})],_.prototype,"editable",void 0),(0,l._)([(0,p.Cb)({type:h.z8,json:{write:!0}})],_.prototype,"length",void 0),(0,l._)([(0,p.Cb)({type:String,json:{write:!0}})],_.prototype,"name",void 0),(0,l._)([(0,p.Cb)({type:Boolean,json:{write:!0}})],_.prototype,"nullable",void 0),(0,l._)([(0,f.J)(v.v)],_.prototype,"type",void 0),(0,l._)([(0,p.Cb)()],_.prototype,"valueType",void 0),(0,l._)([(0,d.r)("valueType",["description"])],_.prototype,"readValueType",null),(0,l._)([(0,p.Cb)({type:Boolean,json:{read:!1}})],_.prototype,"visible",void 0);var x=_=n=(0,l._)([(0,y.j)("esri.layers.support.Field")],_)},66591:function(e,t,r){r.d(t,{im:function(){return V},V5:function(){return T}});r(93169);var n,i=r(15671),a=r(43144),o=r(60136),s=r(29388),l=r(27366),u=r(84652),c=r(49861),p=(r(25243),r(27135)),h=r(69912),f=r(46784),d=(r(63780),n=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).name=null,n.code=null,n}return(0,a.Z)(r,[{key:"clone",value:function(){return new n({name:this.name,code:this.code})}}]),r}(f.wq));(0,l._)([(0,c.Cb)({type:String,json:{write:!0}})],d.prototype,"name",void 0),(0,l._)([(0,c.Cb)({type:[String,Number],json:{write:!0}})],d.prototype,"code",void 0),d=n=(0,l._)([(0,h.j)("esri.layers.support.CodedValue")],d);var y=new(r(43404).X)({inherited:"inherited",codedValue:"coded-value",range:"range"}),m=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).name=null,n.type=null,n}return(0,a.Z)(r)}(f.wq);(0,l._)([(0,c.Cb)({type:String,json:{write:!0}})],m.prototype,"name",void 0),(0,l._)([(0,p.J)(y)],m.prototype,"type",void 0);var v,g=m=(0,l._)([(0,h.j)("esri.layers.support.Domain")],m),_=v=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).codedValues=null,n.type="coded-value",n}return(0,a.Z)(r,[{key:"getName",value:function(e){var t=null;if(this.codedValues){var r=String(e);this.codedValues.some((function(e){return String(e.code)===r&&(t=e.name),!!t}))}return t}},{key:"clone",value:function(){return new v({codedValues:(0,u.d9)(this.codedValues),name:this.name})}}]),r}(g);(0,l._)([(0,c.Cb)({type:[d],json:{write:!0}})],_.prototype,"codedValues",void 0),(0,l._)([(0,p.J)({codedValue:"coded-value"})],_.prototype,"type",void 0);var x,b=_=v=(0,l._)([(0,h.j)("esri.layers.support.CodedValueDomain")],_),w=(r(32718),r(10064),x=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).type="inherited",n}return(0,a.Z)(r,[{key:"clone",value:function(){return new x}}]),r}(g));(0,l._)([(0,p.J)({inherited:"inherited"})],w.prototype,"type",void 0);var k,Z=w=x=(0,l._)([(0,h.j)("esri.layers.support.InheritedDomain")],w),S=k=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).maxValue=null,n.minValue=null,n.type="range",n}return(0,a.Z)(r,[{key:"clone",value:function(){return new k({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}}]),r}(g);(0,l._)([(0,c.Cb)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(e,t,r){t[r]=[this.minValue||0,e]}}}})],S.prototype,"maxValue",void 0),(0,l._)([(0,c.Cb)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[0]}},write:{target:"range",writer:function(e,t,r){t[r]=[e,this.maxValue||0]}}}})],S.prototype,"minValue",void 0),(0,l._)([(0,p.J)({range:"range"})],S.prototype,"type",void 0);var C=S=k=(0,l._)([(0,h.j)("esri.layers.support.RangeDomain")],S),T={key:"type",base:g,typeMap:{range:S,"coded-value":b,inherited:Z}};function V(e){if(!e||!e.type)return null;switch(e.type){case"range":return C.fromJSON(e);case"codedValue":return b.fromJSON(e);case"inherited":return Z.fromJSON(e)}return null}},85249:function(e,t,r){r.d(t,{v:function(){return n}});var n=new(r(43404).X)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"})},21857:function(e,t,r){r.d(t,{CS:function(){return _},Cw:function(){return g},Yu:function(){return w},j5:function(){return x},lm:function(){return Z}});var n=r(74165),i=r(15861),a=r(37762),o=r(42265),s=r(19545),l=r(44055),u=r(76200),c=r(84652),p=r(35995),h=r(78952),f=r(41414),d=r(376),y=r(9014),m=r(49818),v={esriGeometryPoint:"points",esriGeometryPolyline:"polylines",esriGeometryPolygon:"polygons"};function g(e){var t=e.folders||[],r=t.slice(),n=new Map,i=new Map,o=new Map,s=new Map,l=new Map,u={esriGeometryPoint:i,esriGeometryPolyline:o,esriGeometryPolygon:s};(e.featureCollection&&e.featureCollection.layers||[]).forEach((function(e){var t=(0,c.d9)(e);t.featureSet.features=[];var r=e.featureSet.geometryType;n.set(r,t);var a=e.layerDefinition.objectIdField;"esriGeometryPoint"===r?b(i,a,e.featureSet.features):"esriGeometryPolyline"===r?b(o,a,e.featureSet.features):"esriGeometryPolygon"===r&&b(s,a,e.featureSet.features)})),e.groundOverlays&&e.groundOverlays.forEach((function(e){l.set(e.id,e)})),t.forEach((function(t){t.networkLinkIds.forEach((function(n){var i=function(e,t,r){var n=function(e,t){var r;return t.some((function(t){return t.id===e&&(r=t,!0)})),r}(e,r);return n&&(n.parentFolderId=t,n.networkLink=n),n}(n,t.id,e.networkLinks);i&&r.push(i)}))})),r.forEach((function(e){if(e.featureInfos){e.points=(0,c.d9)(n.get("esriGeometryPoint")),e.polylines=(0,c.d9)(n.get("esriGeometryPolyline")),e.polygons=(0,c.d9)(n.get("esriGeometryPolygon")),e.mapImages=[];var t,r=(0,a.Z)(e.featureInfos);try{for(r.s();!(t=r.n()).done;){var i=t.value;switch(i.type){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryPolygon":var o,s=u[i.type].get(i.id);s&&(null===(o=e[v[i.type]])||void 0===o||o.featureSet.features.push(s));break;case"GroundOverlay":var p=l.get(i.id);p&&e.mapImages.push(p)}}}catch(h){r.e(h)}finally{r.f()}e.fullExtent=Z([e])}}));var p=Z(r);return{folders:t,sublayers:r,extent:p}}function _(e,t,r,n){var i=s.id&&s.id.findCredential(e);e=(0,p.fl)(e,{token:i&&i.token});var a=o.Z.kmlServiceUrl;return(0,u.default)(a,{query:{url:e,model:"simple",folders:"",refresh:0!==r||void 0,outSR:JSON.stringify(t)},responseType:"json",signal:n})}function x(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=[],a={},o=t.sublayers,s=t.folders.map((function(e){return e.id}));return o.forEach((function(t){var o=new e;if(r?o.read(t,r):o.read(t),n.length&&s.includes(o.id)&&(o.visible=n.includes(o.id)),a[t.id]=o,null!=t.parentFolderId&&-1!==t.parentFolderId){var l,u=a[t.parentFolderId];u.sublayers||(u.sublayers=[]),null===(l=u.sublayers)||void 0===l||l.unshift(o)}else i.unshift(o)})),i}function b(e,t,r){r.forEach((function(r){e.set(r.attributes[t],r)}))}function w(e){return k.apply(this,arguments)}function k(){return(k=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i,o,s,u,c,p,h,f;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=m.Z.fromJSON(t.featureSet).features,i=t.layerDefinition,o=(0,y.i)(i.drawingInfo.renderer),s=l.Z.fromJSON(t.popupInfo),u=[],c=(0,a.Z)(r),e.prev=2,c.s();case 4:if((p=c.n()).done){e.next=12;break}return h=p.value,e.next=8,o.getSymbolAsync(h);case 8:f=e.sent,h.symbol=f,h.popupTemplate=s,h.visible=!0,u.push(h);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),c.e(e.t0);case 17:return e.prev=17,c.f(),e.finish(17);case 20:return e.abrupt("return",u);case 21:case"end":return e.stop()}}),e,null,[[2,14,17,20]])})))).apply(this,arguments)}function Z(e){var t,r=(0,f.Ue)(f.Gv),n=(0,f.Ue)(f.Gv),i=(0,a.Z)(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(o.polygons&&o.polygons.featureSet&&o.polygons.featureSet.features){var s,l=(0,a.Z)(o.polygons.featureSet.features);try{for(l.s();!(s=l.n()).done;){var u=s.value;(0,d.Yg)(r,u.geometry),(0,f.TC)(n,r)}}catch(w){l.e(w)}finally{l.f()}}if(o.polylines&&o.polylines.featureSet&&o.polylines.featureSet.features){var c,p=(0,a.Z)(o.polylines.featureSet.features);try{for(p.s();!(c=p.n()).done;){var y=c.value;(0,d.Yg)(r,y.geometry),(0,f.TC)(n,r)}}catch(w){p.e(w)}finally{p.f()}}if(o.points&&o.points.featureSet&&o.points.featureSet.features){var m,v=(0,a.Z)(o.points.featureSet.features);try{for(v.s();!(m=v.n()).done;){var g=m.value;(0,d.Yg)(r,g.geometry),(0,f.TC)(n,r)}}catch(w){v.e(w)}finally{v.f()}}if(o.mapImages){var _,x=(0,a.Z)(o.mapImages);try{for(x.s();!(_=x.n()).done;){var b=_.value;(0,d.Yg)(r,b.extent),(0,f.TC)(n,r)}}catch(w){x.e(w)}finally{x.f()}}}}catch(w){i.e(w)}finally{i.f()}return(0,f.fS)(n,f.Gv)?void 0:{xmin:n[0],ymin:n[1],zmin:n[2],xmax:n[3],ymax:n[4],zmax:n[5],spatialReference:h.Z.WGS84}}},49818:function(e,t,r){r.d(t,{Z:function(){return S}});var n,i=r(29439),a=r(37762),o=r(15671),s=r(43144),l=r(60136),u=r(29388),c=r(27366),p=r(59486),h=r(52639),f=r(43404),d=r(46784),y=r(84652),m=r(49861),v=(r(25243),r(38511)),g=r(69912),_=r(31201),x=r(78952),b=r(77981),w=r(83040),k=new f.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null}),Z=n=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).displayFieldName=null,n.exceededTransferLimit=!1,n.features=[],n.fields=null,n.geometryType=null,n.hasM=!1,n.hasZ=!1,n.queryGeometry=null,n.spatialReference=null,n}return(0,s.Z)(r,[{key:"readFeatures",value:function(e,t){for(var r=x.Z.fromJSON(t.spatialReference),n=[],i=0;i<e.length;i++){var a=e[i],o=h.Z.fromJSON(a),s=a.geometry&&a.geometry.spatialReference;null==o.geometry||s||(o.geometry.spatialReference=r);var l=a.aggregateGeometries,u=o.aggregateGeometries;if(l&&null!=u)for(var c in u){var p=u[c],f=l[c],d=null===f||void 0===f?void 0:f.spatialReference;null==p||d||(p.spatialReference=r)}n.push(o)}return n}},{key:"writeGeometryType",value:function(e,t,r,n){if(e)k.write(e,t,r,n);else{var i=this.features;if(i){var o,s=(0,a.Z)(i);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(l&&null!=l.geometry)return void k.write(l.geometry.type,t,r,n)}}catch(u){s.e(u)}finally{s.f()}}}}},{key:"readQueryGeometry",value:function(e,t){if(!e)return null;var r=!!e.spatialReference,n=(0,b.im)(e);return n&&!r&&t.spatialReference&&(n.spatialReference=x.Z.fromJSON(t.spatialReference)),n}},{key:"writeSpatialReference",value:function(e,t){if(e)t.spatialReference=e.toJSON();else{var r=this.features;if(r){var n,i=(0,a.Z)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o&&null!=o.geometry&&o.geometry.spatialReference)return void(t.spatialReference=o.geometry.spatialReference.toJSON())}}catch(s){i.e(s)}finally{i.f()}}}}},{key:"clone",value:function(){return new n(this.cloneProperties())}},{key:"cloneProperties",value:function(){return(0,y.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}},{key:"toJSON",value:function(e){var t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(var r=0;r<t.features.length;r++){var n=t.features[r];if(n.geometry){var i=e&&e[r];n.geometry=i&&i.toJSON()||n.geometry}}return t}},{key:"quantize",value:function(e){for(var t=(0,i.Z)(e.scale,2),r=t[0],n=t[1],a=(0,i.Z)(e.translate,2),o=a[0],s=a[1],l=this.features,u=this._getQuantizationFunction(this.geometryType,(function(e){return Math.round((e-o)/r)}),(function(e){return Math.round((s-e)/n)})),c=0,p=l.length;c<p;c++)(null===u||void 0===u?void 0:u(l[c].geometry))||(l.splice(c,1),c--,p--);return this.transform=e,this}},{key:"unquantize",value:function(){var e,t,r=this.geometryType,n=this.features,o=this.transform;if(!o)return this;var s=(0,i.Z)(o.translate,2),l=s[0],u=s[1],c=(0,i.Z)(o.scale,2),p=c[0],h=c[1],f=null,d=null;if(this.hasZ&&null!=(null===o||void 0===o||null===(e=o.scale)||void 0===e?void 0:e[2])){var y=(0,i.Z)(o.translate,3)[2],m=(0,i.Z)(o.scale,3)[2];f=function(e){return e*m+y}}if(this.hasM&&null!=(null===o||void 0===o||null===(t=o.scale)||void 0===t?void 0:t[3])){var v=(0,i.Z)(o.translate,4)[3],g=(0,i.Z)(o.scale,4)[3];d=function(e){return null==e?e:e*g+v}}var _,x=this._getHydrationFunction(r,(function(e){return e*p+l}),(function(e){return u-e*h}),f,d),b=(0,a.Z)(n);try{for(b.s();!(_=b.n()).done;){var w=_.value.geometry;null!=w&&x&&x(w)}}catch(k){b.e(k)}finally{b.f()}return this.transform=null,this}},{key:"_quantizePoints",value:function(e,t,r){for(var n,i,a=[],o=0,s=e.length;o<s;o++){var l=e[o];if(o>0){var u=t(l[0]),c=r(l[1]);u===n&&c===i||(a.push([u-n,c-i]),n=u,i=c)}else n=t(l[0]),i=r(l[1]),a.push([n,i])}return a.length>0?a:null}},{key:"_getQuantizationFunction",value:function(e,t,r){var n=this;return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var i=(0,b.oU)(e)?e.rings:e.paths,a=[],o=0,s=i.length;o<s;o++){var l=i[o],u=n._quantizePoints(l,t,r);u&&a.push(u)}return a.length>0?((0,b.oU)(e)?e.rings=a:e.paths=a,e):null}:"multipoint"===e?function(e){var i=n._quantizePoints(e.points,t,r);return i&&i.length>0?(e.points=i,e):null}:"extent"===e?function(e){return e}:null}},{key:"_getHydrationFunction",value:function(e,t,r,n,i){return"point"===e?function(e){e.x=t(e.x),e.y=r(e.y),n&&(e.z=n(e.z))}:"polyline"===e||"polygon"===e?function(e){for(var a,o,s=(0,b.oU)(e)?e.rings:e.paths,l=0,u=s.length;l<u;l++)for(var c=s[l],p=0,h=c.length;p<h;p++){var f=c[p];p>0?(a+=f[0],o+=f[1]):(a=f[0],o=f[1]),f[0]=t(a),f[1]=r(o)}if(n&&i)for(var d=0,y=s.length;d<y;d++)for(var m=s[d],v=0,g=m.length;v<g;v++){var _=m[v];_[2]=n(_[2]),_[3]=i(_[3])}else if(n)for(var x=0,w=s.length;x<w;x++)for(var k=s[x],Z=0,S=k.length;Z<S;Z++){var C=k[Z];C[2]=n(C[2])}else if(i)for(var T=0,V=s.length;T<V;T++)for(var R=s[T],I=0,P=R.length;I<P;I++){var M=R[I];M[2]=i(M[2])}}:"extent"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax),n&&null!=e.zmax&&null!=e.zmin&&(e.zmax=n(e.zmax),e.zmin=n(e.zmin)),i&&null!=e.mmax&&null!=e.mmin&&(e.mmax=i(e.mmax),e.mmin=i(e.mmin))}:"multipoint"===e?function(e){for(var a,o,s=e.points,l=0,u=s.length;l<u;l++){var c=s[l];l>0?(a+=c[0],o+=c[1]):(a=c[0],o=c[1]),c[0]=t(a),c[1]=r(o)}if(n&&i)for(var p=0,h=s.length;p<h;p++){var f=s[p];f[2]=n(f[2]),f[3]=i(f[3])}else if(n)for(var d=0,y=s.length;d<y;d++){var m=s[d];m[2]=n(m[2])}else if(i)for(var v=0,g=s.length;v<g;v++){var _=s[v];_[2]=i(_[2])}}:null}}]),r}(d.wq);(0,c._)([(0,m.Cb)({type:String,json:{write:!0}})],Z.prototype,"displayFieldName",void 0),(0,c._)([(0,m.Cb)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],Z.prototype,"exceededTransferLimit",void 0),(0,c._)([(0,m.Cb)({type:[h.Z],json:{write:!0}})],Z.prototype,"features",void 0),(0,c._)([(0,v.r)("features")],Z.prototype,"readFeatures",null),(0,c._)([(0,m.Cb)({type:[w.Z],json:{write:!0}})],Z.prototype,"fields",void 0),(0,c._)([(0,m.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:k.read}}})],Z.prototype,"geometryType",void 0),(0,c._)([(0,_.c)("geometryType")],Z.prototype,"writeGeometryType",null),(0,c._)([(0,m.Cb)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],Z.prototype,"hasM",void 0),(0,c._)([(0,m.Cb)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],Z.prototype,"hasZ",void 0),(0,c._)([(0,m.Cb)({types:p.qM,json:{write:!0}})],Z.prototype,"queryGeometry",void 0),(0,c._)([(0,v.r)("queryGeometry")],Z.prototype,"readQueryGeometry",null),(0,c._)([(0,m.Cb)({type:x.Z,json:{write:!0}})],Z.prototype,"spatialReference",void 0),(0,c._)([(0,_.c)("spatialReference")],Z.prototype,"writeSpatialReference",null),(0,c._)([(0,m.Cb)({json:{write:!0}})],Z.prototype,"transform",void 0),(Z=n=(0,c._)([(0,g.j)("esri.rest.support.FeatureSet")],Z)).prototype.toJSON.isDefaultToJSON=!0;var S=Z},45956:function(e,t,r){r.d(t,{JZ:function(){return Z},RL:function(){return S},eY:function(){return T}});var n=r(29439),i=r(74165),a=r(15861),o=r(15671),s=r(43144),l=r(97326),u=r(11752),c=r(61120),p=r(60136),h=r(29388),f=r(92026),d=r(66978),y=r(22753),m=r(23588),v=r(15245),g=r(87422),_=r(10978),x=r(83826),b=r(8548),w=r(57808),k=r(52311);function Z(e){return e&&"render"in e}function S(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,e.render(t.getContext("2d")),t}function C(e){return Z(e)?e instanceof _.Z?(0,f.yw)(e.getRenderedRasterPixels(),(function(e){return e.renderedRasterPixels})):S(e):e}var T=function(e){(0,p.Z)(r,e);var t=(0,h.Z)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,o.Z)(this,r),(e=t.call(this)).blendFunction="standard",e._sourceWidth=0,e._sourceHeight=0,e._textureInvalidated=!1,e._texture=null,e.stencilRef=0,e.coordScale=[1,1],e._height=void 0,e.pixelRatio=1,e.resolution=0,e.rotation=0,e._source=null,e._width=void 0,e.x=0,e.y=0,e.immutable=i,e.source=n,e.requestRender=e.requestRender.bind((0,l.Z)(e)),e}return(0,s.Z)(r,[{key:"destroy",value:function(){this._texture&&(this._texture.dispose(),this._texture=null),null!=this._uploadStatus&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)}},{key:"isSourceScaled",get:function(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}},{key:"height",get:function(){return void 0!==this._height?this._height:this._sourceHeight},set:function(e){this._height=e}},{key:"source",get:function(){return this._source},set:function(e){null==e&&null==this._source||(this._source=e,this.invalidateTexture(),this.requestRender())}},{key:"width",get:function(){return void 0!==this._width?this._width:this._sourceWidth},set:function(e){this._width=e}},{key:"beforeRender",value:function(e){(0,u.Z)((0,c.Z)(r.prototype),"beforeRender",this).call(this,e),this.updateTexture(e)}},{key:"setSourceAsync",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null!=this._uploadStatus&&this._uploadStatus.controller.abort(),n=new AbortController,a=(0,d.hh)(),e.abrupt("return",((0,d.$F)(r,(function(){return n.abort()})),(0,d.$F)(n,(function(e){return a.reject(e)})),this._uploadStatus={controller:n,resolver:a},this.source=t,a.promise));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"invalidateTexture",value:function(){this._textureInvalidated||(this._textureInvalidated=!0,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):this._source&&(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width))}},{key:"updateTransitionProperties",value:function(e,t){e>=64&&(this.fadeTransitionEnabled=!1,this.inFadeTransition=!1),(0,u.Z)((0,c.Z)(r.prototype),"updateTransitionProperties",this).call(this,e,t)}},{key:"setTransform",value:function(e){var t=(0,y.g)(this.transforms.dvs),r=e.toScreenNoRotation([0,0],[this.x,this.y]),i=(0,n.Z)(r,2),a=i[0],o=i[1],s=this.resolution/this.pixelRatio/e.resolution,l=s*this.width,u=s*this.height,c=Math.PI*this.rotation/180;(0,y.h)(t,t,(0,v.f)(a,o)),(0,y.h)(t,t,(0,v.f)(l/2,u/2)),(0,y.r)(t,t,-c),(0,y.h)(t,t,(0,v.f)(-l/2,-u/2)),(0,y.l)(t,t,(0,v.f)(l,u)),(0,y.m)(this.transforms.dvs,e.displayViewMat3,t)}},{key:"setSamplingProfile",value:function(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))}},{key:"bind",value:function(e,t){this._texture&&e.bindTexture(this._texture,t)}},{key:"updateTexture",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r,n,a,o,s,l,u,c,p,h,f;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.context,n=t.painter,this._textureInvalidated){e.next=3;break}return e.abrupt("return");case 3:if(this._textureInvalidated=!1,this._texture||(this._texture=this._createTexture(r)),this.source){e.next=5;break}return e.abrupt("return",void this._texture.setData(null));case 5:if(this._texture.resize(this._sourceWidth,this._sourceHeight),a=C(this.source),e.prev=7,null==this._uploadStatus){e.next=16;break}return o=this._uploadStatus,s=o.controller,l=o.resolver,u={signal:s.signal},c=this.width,p=this.height,h=this._texture,f=n.textureUploadManager,e.next=12,f.enqueueTextureUpdate({data:a,texture:h,width:c,height:p},u);case 12:l.resolve(),this._uploadStatus=null,e.next=17;break;case 16:this._texture.setData(a);case 17:this.ready(),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(7),(0,d.H9)(e.t0);case 23:case"end":return e.stop()}}),e,this,[[7,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onDetach",value:function(){this.destroy()}},{key:"_createTransforms",value:function(){return{dvs:(0,m.c)()}}},{key:"_createTexture",value:function(e){var t=this.immutable&&e.type===x.zO.WEBGL2,r=new k.X;return r.internalFormat=t?b.lP.RGBA8:b.VI.RGBA,r.wrapMode=b.e8.CLAMP_TO_EDGE,r.isImmutable=t,r.width=this._sourceWidth,r.height=this._sourceHeight,new w.x(e,r)}}]),r}(g.s)},90110:function(e,t,r){r.d(t,{c:function(){return h}});var n=r(93433),i=r(15671),a=r(43144),o=r(11752),s=r(61120),l=r(60136),u=r(29388),c=r(62272),p=r(80613),h=function(e){(0,l.Z)(r,e);var t=(0,u.Z)(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments))._hasCrossfade=!1,e}return(0,a.Z)(r,[{key:"requiresDedicatedFBO",get:function(){return this._hasCrossfade}},{key:"beforeRender",value:function(e){(0,o.Z)((0,s.Z)(r.prototype),"beforeRender",this).call(this,e),this._manageFade()}},{key:"prepareRenderPasses",value:function(e){var t=this,i=e.registerRenderPass({name:"bitmap",brushes:[c.U.bitmap],target:function(){return t.children},drawPhase:p.jx.MAP});return[].concat((0,n.Z)((0,o.Z)((0,s.Z)(r.prototype),"prepareRenderPasses",this).call(this,e)),[i])}},{key:"_manageFade",value:function(){this.children.reduce((function(e,t){return e+(t.inFadeTransition?1:0)}),0)>=2?(this.children.forEach((function(e){return e.blendFunction="additive"})),this._hasCrossfade=!0):(this.children.forEach((function(e){return e.blendFunction="standard"})),this._hasCrossfade=!1)}}]),r}(r(64510).Z)},10978:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(15671),i=r(43144),a=function(){function e(t,r,i){(0,n.Z)(this,e),this.pixelBlock=t,this.extent=r,this.originalPixelBlock=i}return(0,i.Z)(e,[{key:"width",get:function(){return null!=this.pixelBlock?this.pixelBlock.width:0}},{key:"height",get:function(){return null!=this.pixelBlock?this.pixelBlock.height:0}},{key:"render",value:function(e){var t,r=this.pixelBlock;if(null!=r){var n=this.filter({extent:this.extent,pixelBlock:null!==(t=this.originalPixelBlock)&&void 0!==t?t:r});if(null!=n.pixelBlock){n.pixelBlock.maskIsAlpha&&(n.pixelBlock.premultiplyAlpha=!0);var i=n.pixelBlock.getAsRGBA(),a=e.createImageData(n.pixelBlock.width,n.pixelBlock.height);a.data.set(i),e.putImageData(a,0,0)}}}},{key:"getRenderedRasterPixels",value:function(){var e=this.filter({extent:this.extent,pixelBlock:this.pixelBlock});return null==e.pixelBlock?null:(e.pixelBlock.maskIsAlpha&&(e.pixelBlock.premultiplyAlpha=!0),{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)})}}]),e}()},6326:function(e,t,r){r.r(t),r.d(t,{default:function(){return W}});var n=r(93433),i=r(1413),a=r(29439),o=r(37762),s=r(74165),l=r(15861),u=r(60136),c=r(29388),p=r(43144),h=r(15671),f=r(27366),d=r(19545),y=r(40281),m=r(92026),v=r(94172),g=r(35995),_=r(49861),x=(r(25243),r(63780),r(93169),r(69912)),b=r(53866),w=r(52587),k=r(78952),Z=r(21857),S=r(23084),C=r(78983),T=r(45956),V=r(90110),R=r(95986),I=r(75391),P=r(77318),M=r(67581),A=r(76200),O=r(585),F=r(80394),G=r(25866),B=r(40658),E=r(8548),D=r(53634),j=r(48673),L=r(42724),N=r(57808),U=r(52311),q=function(){function e(t){if((0,h.Z)(this,e),this._ownsRctx=!1,t)this._ownsRctx=!1,this._rctx=t;else{if(e._instance)return e._instanceRefCount++,e._instance;e._instanceRefCount=1,e._instance=this,this._ownsRctx=!0;var r=document.createElement("canvas").getContext("webgl");r.getExtension("OES_texture_float"),this._rctx=new L.x(r,{})}var n=(0,B.s)("raster/reproject","raster/reproject",new Map([["a_position",0]]),{applyProjection:!0,bilinear:!1,bicubic:!1});this._program=this._rctx.programCache.acquire(n.shaders.vertexShader,n.shaders.fragmentShader,n.attributes),this._rctx.useProgram(this._program),this._program.setUniform1f("u_opacity",1),this._program.setUniform1i("u_image",0),this._program.setUniform1i("u_flipY",0),this._program.setUniform1i("u_transformGrid",1),this._quad=new G.Z(this._rctx,[0,0,1,0,0,1,1,1])}return(0,p.Z)(e,[{key:"reprojectTexture",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=(0,w.project)(e.extent,t),i=new O.Z({x:(e.extent.xmax-e.extent.xmin)/e.texture.descriptor.width,y:(e.extent.ymax-e.extent.ymin)/e.texture.descriptor.height,spatialReference:e.extent.spatialReference}),a=(0,F.VO)(i,t,e.extent),o=(a.x+a.y)/2,s=Math.round((n.xmax-n.xmin)/o),l=Math.round((n.ymax-n.ymin)/o);o=(n.width/s+n.height/l)/2;var u=new O.Z({x:o,y:o,spatialReference:n.spatialReference}),c=(0,F.Qp)({projectedExtent:n,srcBufferExtent:e.extent,pixelSize:u,hasWrapAround:!0,spacing:[16,16]}),p=(0,j.Br)(this._rctx,c),h=new U.X(s,l);h.wrapMode=E.e8.CLAMP_TO_EDGE;var f=new D.X(this._rctx,h);this._rctx.bindFramebuffer(f),this._rctx.setViewport(0,0,s,l),this._rctx.useProgram(this._program),this._rctx.bindTexture(e.texture,0),this._rctx.bindTexture(p,1),this._quad.bind();var d=e.texture.descriptor,y=d.width,m=void 0===y?0:y,v=d.height,g=void 0===v?0:v;if(this._program.setUniform2f("u_srcImageSize",m,g),this._program.setUniform2fv("u_transformSpacing",c.spacing),this._program.setUniform2fv("u_transformGridSize",c.size),this._program.setUniform2f("u_targetImageSize",s,l),this._quad.draw(),this._quad.unbind(),this._rctx.useProgram(null),this._rctx.bindFramebuffer(null),p.dispose(),r){var _=f.width,x=f.height,b=new ImageData(null!==_&&void 0!==_?_:0,null!==x&&void 0!==x?x:0);f.readPixels(0,0,null!==_&&void 0!==_?_:0,null!==x&&void 0!==x?x:0,E.VI.RGBA,E.Br.UNSIGNED_BYTE,b.data);var k=f.detachColorTexture(E.VY.COLOR_ATTACHMENT0);return f.dispose(),{texture:k,extent:n,imageData:b}}var Z=f.detachColorTexture(E.VY.COLOR_ATTACHMENT0);return f.dispose(),{texture:Z,extent:n}}},{key:"reprojectBitmapData",value:function(e,t){var r=(0,T.JZ)(e.bitmapData)?(0,T.RL)(e.bitmapData):e.bitmapData,n=new U.X;n.wrapMode=E.e8.CLAMP_TO_EDGE,n.width=e.bitmapData.width,n.height=e.bitmapData.height;var i=new N.x(this._rctx,n,r),a=this.reprojectTexture({texture:i,extent:e.extent},t,!0);a.texture.dispose();var o=document.createElement("canvas"),s=a.imageData;return o.width=s.width,o.height=s.height,o.getContext("2d").putImageData(s,0,0),{bitmapData:o,extent:a.extent}}},{key:"loadAndReprojectBitmapData",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,r,n){var i,a,o,l,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.default)(t,{responseType:"image"});case 2:if(i=e.sent.data,(a=document.createElement("canvas")).width=i.width,a.height=i.height,(o=a.getContext("2d")).drawImage(i,0,0),l=o.getImageData(0,0,a.width,a.height),!r.spatialReference.equals(n)){e.next=10;break}return e.abrupt("return",{bitmapData:l,extent:r});case 10:return u=this.reprojectBitmapData({bitmapData:l,extent:r},n),e.abrupt("return",{bitmapData:u.bitmapData,extent:u.extent});case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this._ownsRctx?(e._instanceRefCount--,0===e._instanceRefCount&&(this._quad.dispose(),this._program.dispose(),this._rctx.dispose(),e._instance=null)):(this._quad.dispose(),this._program.dispose())}}]),e}();q._instanceRefCount=0;var z=(0,p.Z)((function e(){(0,h.Z)(this,e),this.allSublayers=new Map,this.allPoints=[],this.allPolylines=[],this.allPolygons=[],this.allMapImages=[]})),J=function(e){(0,u.Z)(r,e);var t=(0,c.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments))._bitmapIndex=new Map,e._mapImageContainer=new V.c,e._kmlVisualData=new z,e._fetchController=null,e.allVisiblePoints=new C.J,e.allVisiblePolylines=new C.J,e.allVisiblePolygons=new C.J,e.allVisibleMapImages=new y.Z,e}return(0,p.Z)(r,[{key:"hitTest",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,r){var n,i,a,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.layer,e.abrupt("return",[null===(n=this._pointsView)||void 0===n?void 0:n.hitTest(t),null===(i=this._polylinesView)||void 0===i?void 0:i.hitTest(t),null===(a=this._polygonsView)||void 0===a?void 0:a.hitTest(t)].flat().filter(Boolean).map((function(e){return e.layer=o,e.sourceLayer=o,{type:"graphic",graphic:e,layer:o,mapPoint:t}})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"update",value:function(e){this._polygonsView&&this._polygonsView.processUpdate(e),this._polylinesView&&this._polylinesView.processUpdate(e),this._pointsView&&this._pointsView.processUpdate(e)}},{key:"attach",value:function(){var e=this;this._fetchController=new AbortController,this.container.addChild(this._mapImageContainer),this._polygonsView=new P.Z({view:this.view,graphics:this.allVisiblePolygons,requestUpdateCallback:function(){return e.requestUpdate()},container:new I.Z(this.view.featuresTilingScheme)}),this.container.addChild(this._polygonsView.container),this._polylinesView=new P.Z({view:this.view,graphics:this.allVisiblePolylines,requestUpdateCallback:function(){return e.requestUpdate()},container:new I.Z(this.view.featuresTilingScheme)}),this.container.addChild(this._polylinesView.container),this._pointsView=new P.Z({view:this.view,graphics:this.allVisiblePoints,requestUpdateCallback:function(){return e.requestUpdate()},container:new I.Z(this.view.featuresTilingScheme)}),this.container.addChild(this._pointsView.container),this.addAttachHandles([this.allVisibleMapImages.on("change",(function(t){t.added.forEach((function(t){return e._addMapImage(t)})),t.removed.forEach((function(t){return e._removeMapImage(t)}))})),(0,v.YP)((function(){return e.layer.visibleSublayers}),(function(t){var r,n=(0,o.Z)(e._kmlVisualData.allSublayers);try{for(n.s();!(r=n.n()).done;){var i=(0,a.Z)(r.value,2);i[0];i[1].visibility=0}}catch(p){n.e(p)}finally{n.f()}var s,l=(0,o.Z)(t);try{for(l.s();!(s=l.n()).done;){var u=s.value,c=e._kmlVisualData.allSublayers.get(u.id);c&&(c.visibility=1)}}catch(p){l.e(p)}finally{l.f()}e._refreshCollections()}))]),this.updatingHandles.addPromise(this._fetchService(this._fetchController.signal)),this._imageReprojector=new q}},{key:"detach",value:function(){this._fetchController=(0,m.IM)(this._fetchController),this._mapImageContainer.removeAllChildren(),this.container.removeAllChildren(),this._bitmapIndex.clear(),this._polygonsView=(0,m.SC)(this._polygonsView),this._polylinesView=(0,m.SC)(this._polylinesView),this._pointsView=(0,m.SC)(this._pointsView),this._imageReprojector=(0,m.SC)(this._imageReprojector)}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){this._polygonsView.viewChange(),this._polylinesView.viewChange(),this._pointsView.viewChange()}},{key:"moveEnd",value:function(){}},{key:"isUpdating",value:function(){return this._pointsView.updating||this._polygonsView.updating||this._polylinesView.updating}},{key:"_addMapImage",value:function(e){var t,r,n=this;((null===(t=this.view.spatialReference)||void 0===t?void 0:t.isWGS84)||(null===(r=this.view.spatialReference)||void 0===r?void 0:r.isWebMercator))&&this._imageReprojector.loadAndReprojectBitmapData(e.href,b.Z.fromJSON(e.extent),this.view.spatialReference).then((function(t){var r=new T.eY(t.bitmapData);r.x=t.extent.xmin,r.y=t.extent.ymax,r.resolution=t.extent.width/t.bitmapData.width,r.rotation=e.rotation,n._mapImageContainer.addChild(r),n._bitmapIndex.set(e,r)}))}},{key:"_getViewDependentUrl",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t,r){var n,a,o,l,u,c,p,h,f,y,m,v,_,x,Z,C,T,V;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.viewFormat,a=t.viewBoundScale,o=t.httpQuery,null==n){e.next=20;break}if(null!=r){e.next=4;break}throw new Error("Loading this network link requires a view state.");case 4:return e.next=6,(0,w.load)();case 6:if(null==a||1===a){e.next=11;break}(u=new b.Z(r.extent)).expand(a),l=u,e.next=12;break;case 11:l=r.extent;case 12:return l=(0,w.project)(l,k.Z.WGS84),c=(0,w.project)(l,k.Z.WebMercator),p=l.xmin,h=l.xmax,f=l.ymin,y=l.ymax,m=r.size[0]*r.pixelRatio,v=r.size[1]*r.pixelRatio,_=Math.max(c.width,c.height),x={"[bboxWest]":p.toString(),"[bboxEast]":h.toString(),"[bboxSouth]":f.toString(),"[bboxNorth]":y.toString(),"[lookatLon]":l.center.x.toString(),"[lookatLat]":l.center.y.toString(),"[lookatRange]":_.toString(),"[lookatTilt]":"0","[lookatHeading]":r.rotation.toString(),"[lookatTerrainLon]":l.center.x.toString(),"[lookatTerrainLat]":l.center.y.toString(),"[lookatTerrainAlt]":"0","[cameraLon]":l.center.x.toString(),"[cameraLat]":l.center.y.toString(),"[cameraAlt]":_.toString(),"[horizFov]":"60","[vertFov]":"60","[horizPixels]":m.toString(),"[vertPixels]":v.toString(),"[terrainEnabled]":"0","[clientVersion]":d.i8,"[kmlVersion]":"2.2","[clientName]":"ArcGIS API for JavaScript","[language]":"en-US"},Z=function(e){for(var t in e){var r=void 0;for(r in x)e[t]=e[t].replace(r,x[r])}},C=(0,g.u0)(n),Z(C),T={},null!=o&&(T=(0,g.u0)(o),Z(T)),(V=(0,S.en)(t.href)).query=(0,i.Z)((0,i.Z)((0,i.Z)({},V.query),C),T),e.abrupt("return","".concat(V.path,"?").concat((0,g.B7)(C)));case 20:return e.abrupt("return",t.href);case 21:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_fetchService",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(t){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new z,e.next=3,this._loadVisualData(this.layer.url,r,t);case 3:this._kmlVisualData=r,this._refreshCollections();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_refreshCollections",value:function(){var e=this;this.allVisiblePoints.removeAll(),this.allVisiblePolylines.removeAll(),this.allVisiblePolygons.removeAll(),this.allVisibleMapImages.removeAll(),this.allVisiblePoints.addMany(this._kmlVisualData.allPoints.filter((function(t){return e._isSublayerVisible(t.sublayerId)})).map((function(e){return e.item}))),this.allVisiblePolylines.addMany(this._kmlVisualData.allPolylines.filter((function(t){return e._isSublayerVisible(t.sublayerId)})).map((function(e){return e.item}))),this.allVisiblePolygons.addMany(this._kmlVisualData.allPolygons.filter((function(t){return e._isSublayerVisible(t.sublayerId)})).map((function(e){return e.item}))),this.allVisibleMapImages.addMany(this._kmlVisualData.allMapImages.filter((function(t){return e._isSublayerVisible(t.sublayerId)})).map((function(e){return e.item})))}},{key:"_isSublayerVisible",value:function(e){var t=this._kmlVisualData.allSublayers.get(e);return!(null===t||void 0===t||!t.visibility)&&(-1===t.parentFolderId||this._isSublayerVisible(t.parentFolderId))}},{key:"_loadVisualData",value:function(e,t,r){var i=this;return this._fetchParsedKML(e,r).then(function(){var e=(0,l.Z)((0,s.Z)().mark((function e(a){var l,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=(0,o.Z)(a.sublayers),e.prev=1,c=(0,s.Z)().mark((function e(){var a,o,l,c,p,h,f,d,y,m;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p=u.value,t.allSublayers.set(p.id,p),!p.points){e.next=8;break}return e.next=5,(0,Z.Yu)(p.points);case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=[];case 9:if(h=e.t0,!p.polylines){e.next=16;break}return e.next=13,(0,Z.Yu)(p.polylines);case 13:e.t1=e.sent,e.next=17;break;case 16:e.t1=[];case 17:if(f=e.t1,!p.polygons){e.next=24;break}return e.next=21,(0,Z.Yu)(p.polygons);case 21:e.t2=e.sent,e.next=25;break;case 24:e.t2=[];case 25:if(d=e.t2,y=p.mapImages||[],(a=t.allPoints).push.apply(a,(0,n.Z)(h.map((function(e){return{item:e,sublayerId:p.id}})))),(o=t.allPolylines).push.apply(o,(0,n.Z)(f.map((function(e){return{item:e,sublayerId:p.id}})))),(l=t.allPolygons).push.apply(l,(0,n.Z)(d.map((function(e){return{item:e,sublayerId:p.id}})))),(c=t.allMapImages).push.apply(c,(0,n.Z)(y.map((function(e){return{item:e,sublayerId:p.id}})))),!p.networkLink){e.next=33;break}return e.next=30,i._getViewDependentUrl(p.networkLink,i.view.state);case 30:return m=e.sent,e.next=33,i._loadVisualData(m,t,r);case 33:case"end":return e.stop()}}),e)})),l.s();case 4:if((u=l.n()).done){e.next=8;break}return e.delegateYield(c(),"t0",6);case 6:e.next=4;break;case 8:e.next=13;break;case 10:e.prev=10,e.t1=e.catch(1),l.e(e.t1);case 13:return e.prev=13,l.f(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,10,13,16]])})));return function(t){return e.apply(this,arguments)}}())}},{key:"_fetchParsedKML",value:function(e,t){return(0,Z.CS)(e,this.layer.spatialReference,this.layer.refreshInterval,t).then((function(e){return(0,Z.Cw)(e.data)}))}},{key:"_removeMapImage",value:function(e){var t=this._bitmapIndex.get(e);t&&(this._mapImageContainer.removeChild(t),this._bitmapIndex.delete(e))}}]),r}((0,R.y)(M.Z));(0,f._)([(0,_.Cb)()],J.prototype,"_pointsView",void 0),(0,f._)([(0,_.Cb)()],J.prototype,"_polylinesView",void 0),(0,f._)([(0,_.Cb)()],J.prototype,"_polygonsView",void 0),(0,f._)([(0,_.Cb)()],J.prototype,"updating",void 0);var W=J=(0,f._)([(0,x.j)("esri.views.2d.layers.KMLLayerView2D")],J)},48673:function(e,t,r){r.d(t,{Br:function(){return c},Fm:function(){return m},N9:function(){return g},RA:function(){return _},Tc:function(){return h},Ue:function(){return f},iC:function(){return p},s9:function(){return u},v:function(){return v},xW:function(){return y},zS:function(){return d}});var n=r(29439),i=r(6394),a=r(83826),o=r(8548),s=r(57808),l=r(52311);function u(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",i=!(arguments.length>3&&void 0!==arguments[3]&&arguments[3]&&"u8"===t.pixelType),u=i?o.Br.FLOAT:o.Br.UNSIGNED_BYTE,c=null==t.pixels||0===t.pixels.length?null:i?t.getAsRGBAFloat():t.getAsRGBA(),p=null===(r=e.capabilities.textureFloat)||void 0===r?void 0:r.textureFloatLinear,h=new l.X;return h.width=t.width,h.height=t.height,h.internalFormat=e.type===a.zO.WEBGL2&&i?o.lP.RGBA32F:o.VI.RGBA,h.samplingMode=!p||"bilinear"!==n&&"cubic"!==n?o.cw.NEAREST:o.cw.LINEAR,h.dataType=u,h.wrapMode=o.e8.CLAMP_TO_EDGE,new s.x(e,h,c)}function c(e,t){var r=t.spacing,i=t.offsets,u=t.coefficients,c=(0,n.Z)(t.size,2),p=c[0],h=c[1],f=r[0]>1,d=new l.X;d.width=f?4*p:p,d.height=h,d.internalFormat=e.type===a.zO.WEBGL2?o.lP.RGBA32F:o.VI.RGBA,d.dataType=o.Br.FLOAT,d.samplingMode=o.cw.NEAREST,d.wrapMode=o.e8.CLAMP_TO_EDGE;var y=new Float32Array(f?p*h*16:2*i.length);if(f&&null!=u)for(var m=0,v=0;m<u.length;m++)y[v++]=u[m],m%3==2&&(y[v++]=1);else for(var g=0;g<h;g++)for(var _=0;_<p;_++){var x=4*(g*p+_),b=2*(_*h+g);y[x]=i[b],y[x+1]=i[b+1],y[x+3]=-1===i[b]?0:1}return new s.x(e,d,y)}function p(e,t){var r=new l.X;return r.internalFormat=o.VI.RGBA,r.width=t.length/4,r.height=1,r.samplingMode=o.cw.NEAREST,r.wrapMode=o.e8.CLAMP_TO_EDGE,new s.x(e,r,t)}function h(e,t,r){return{u_flipY:!(arguments.length>4&&void 0!==arguments[4])||arguments[4],u_applyTransform:!!e,u_opacity:arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u_transformSpacing:e?e.spacing:i.Z,u_transformGridSize:e?e.size:i.Z,u_targetImageSize:t,u_srcImageSize:r}}function f(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:0}}function d(e,t){return{u_scale:e,u_offset:t}}function y(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function m(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}function v(e,t){var r=e.gl,n=t.glName,i=new Map;if(null==n)return i;for(var a,o=r.getProgramParameter(n,r.ACTIVE_UNIFORMS),s=0;s<o;s++)(a=r.getActiveUniform(n,s))&&i.set(a.name,{location:r.getUniformLocation(n,a.name),info:a});return i}function g(e,t,r){Object.keys(r).forEach((function(n){var i=t.get(n)||t.get(n+"[0]");i&&function(e,t,r,n){if(null===n||null==r)return!1;var i=n.info;switch(i.type){case o.Se.FLOAT:i.size>1?e.setUniform1fv(t,r):e.setUniform1f(t,r);break;case o.Se.FLOAT_VEC2:e.setUniform2fv(t,r);break;case o.Se.FLOAT_VEC3:e.setUniform3fv(t,r);break;case o.Se.FLOAT_VEC4:e.setUniform4fv(t,r);break;case o.Se.FLOAT_MAT3:e.setUniformMatrix3fv(t,r);break;case o.Se.FLOAT_MAT4:e.setUniformMatrix4fv(t,r);break;case o.Se.INT:i.size>1?e.setUniform1iv(t,r):e.setUniform1i(t,r);break;case o.Se.BOOL:e.setUniform1i(t,r?1:0);break;case o.Se.INT_VEC2:case o.Se.BOOL_VEC2:e.setUniform2iv(t,r);break;case o.Se.INT_VEC3:case o.Se.BOOL_VEC3:e.setUniform3iv(t,r);break;case o.Se.INT_VEC4:case o.Se.BOOL_VEC4:e.setUniform4iv(t,r);break;default:return!1}}(e,n,r[n],i)}))}function _(e,t,r,n){r.length===n.length&&(n.some((function(e){return null==e}))||r.some((function(e){return null==e}))||r.forEach((function(r,i){t.setUniform1i(r,i),e.bindTexture(n[i],i)})))}}}]);
//# sourceMappingURL=6326.7ad2fd65.chunk.js.map