"use strict";(self.webpackChunkgis_dashboard=self.webpackChunkgis_dashboard||[]).push([[8396],{83040:function(e,t,r){r.d(t,{Z:function(){return w}});var i,n=r(15671),a=r(43144),o=r(60136),s=r(29388),l=r(27366),u=r(43404),c=r(46784),p=r(49861),d=r(25243),h=(r(63780),r(93169),r(27135)),y=r(38511),v=r(69912),f=r(66591),m=r(85249),g=new u.X({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"}),b=i=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).alias=null,i.defaultValue=void 0,i.description=null,i.domain=null,i.editable=!0,i.length=-1,i.name=null,i.nullable=!0,i.type=null,i.valueType=null,i.visible=!0,i}return(0,a.Z)(r,[{key:"readDescription",value:function(e,t){var r,i,n=t.description,a=null;try{a=n?JSON.parse(n):null}catch(o){}return null!==(r=null===(i=a)||void 0===i?void 0:i.value)&&void 0!==r?r:null}},{key:"readValueType",value:function(e,t){var r=t.description,i=null;try{i=r?JSON.parse(r):null}catch(n){}return i?g.fromJSON(i.fieldValueType):null}},{key:"clone",value:function(){return new i({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}}]),r}(c.wq);(0,l._)([(0,p.Cb)({type:String,json:{write:!0}})],b.prototype,"alias",void 0),(0,l._)([(0,p.Cb)({type:[String,Number],json:{write:{allowNull:!0}}})],b.prototype,"defaultValue",void 0),(0,l._)([(0,p.Cb)()],b.prototype,"description",void 0),(0,l._)([(0,y.r)("description")],b.prototype,"readDescription",null),(0,l._)([(0,p.Cb)({types:f.V5,json:{read:{reader:f.im},write:!0}})],b.prototype,"domain",void 0),(0,l._)([(0,p.Cb)({type:Boolean,json:{write:!0}})],b.prototype,"editable",void 0),(0,l._)([(0,p.Cb)({type:d.z8,json:{write:!0}})],b.prototype,"length",void 0),(0,l._)([(0,p.Cb)({type:String,json:{write:!0}})],b.prototype,"name",void 0),(0,l._)([(0,p.Cb)({type:Boolean,json:{write:!0}})],b.prototype,"nullable",void 0),(0,l._)([(0,h.J)(m.v)],b.prototype,"type",void 0),(0,l._)([(0,p.Cb)()],b.prototype,"valueType",void 0),(0,l._)([(0,y.r)("valueType",["description"])],b.prototype,"readValueType",null),(0,l._)([(0,p.Cb)({type:Boolean,json:{read:!1}})],b.prototype,"visible",void 0);var w=b=i=(0,l._)([(0,v.j)("esri.layers.support.Field")],b)},66591:function(e,t,r){r.d(t,{im:function(){return T},V5:function(){return P}});r(93169);var i,n=r(15671),a=r(43144),o=r(60136),s=r(29388),l=r(27366),u=r(84652),c=r(49861),p=(r(25243),r(27135)),d=r(69912),h=r(46784),y=(r(63780),i=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).name=null,i.code=null,i}return(0,a.Z)(r,[{key:"clone",value:function(){return new i({name:this.name,code:this.code})}}]),r}(h.wq));(0,l._)([(0,c.Cb)({type:String,json:{write:!0}})],y.prototype,"name",void 0),(0,l._)([(0,c.Cb)({type:[String,Number],json:{write:!0}})],y.prototype,"code",void 0),y=i=(0,l._)([(0,d.j)("esri.layers.support.CodedValue")],y);var v=new(r(43404).X)({inherited:"inherited",codedValue:"coded-value",range:"range"}),f=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).name=null,i.type=null,i}return(0,a.Z)(r)}(h.wq);(0,l._)([(0,c.Cb)({type:String,json:{write:!0}})],f.prototype,"name",void 0),(0,l._)([(0,p.J)(v)],f.prototype,"type",void 0);var m,g=f=(0,l._)([(0,d.j)("esri.layers.support.Domain")],f),b=m=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).codedValues=null,i.type="coded-value",i}return(0,a.Z)(r,[{key:"getName",value:function(e){var t=null;if(this.codedValues){var r=String(e);this.codedValues.some((function(e){return String(e.code)===r&&(t=e.name),!!t}))}return t}},{key:"clone",value:function(){return new m({codedValues:(0,u.d9)(this.codedValues),name:this.name})}}]),r}(g);(0,l._)([(0,c.Cb)({type:[y],json:{write:!0}})],b.prototype,"codedValues",void 0),(0,l._)([(0,p.J)({codedValue:"coded-value"})],b.prototype,"type",void 0);var w,x=b=m=(0,l._)([(0,d.j)("esri.layers.support.CodedValueDomain")],b),_=(r(32718),r(10064),w=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).type="inherited",i}return(0,a.Z)(r,[{key:"clone",value:function(){return new w}}]),r}(g));(0,l._)([(0,p.J)({inherited:"inherited"})],_.prototype,"type",void 0);var Z,k=_=w=(0,l._)([(0,d.j)("esri.layers.support.InheritedDomain")],_),C=Z=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).maxValue=null,i.minValue=null,i.type="range",i}return(0,a.Z)(r,[{key:"clone",value:function(){return new Z({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}}]),r}(g);(0,l._)([(0,c.Cb)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(e,t,r){t[r]=[this.minValue||0,e]}}}})],C.prototype,"maxValue",void 0),(0,l._)([(0,c.Cb)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[0]}},write:{target:"range",writer:function(e,t,r){t[r]=[e,this.maxValue||0]}}}})],C.prototype,"minValue",void 0),(0,l._)([(0,p.J)({range:"range"})],C.prototype,"type",void 0);var V=C=Z=(0,l._)([(0,d.j)("esri.layers.support.RangeDomain")],C),P={key:"type",base:g,typeMap:{range:C,"coded-value":x,inherited:k}};function T(e){if(!e||!e.type)return null;switch(e.type){case"range":return V.fromJSON(e);case"codedValue":return x.fromJSON(e);case"inherited":return k.fromJSON(e)}return null}},85249:function(e,t,r){r.d(t,{v:function(){return i}});var i=new(r(43404).X)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"})},8226:function(e,t,r){r.r(t),r.d(t,{default:function(){return re}});var i=r(74165),n=r(15861),a=r(15671),o=r(43144),s=r(60136),l=r(29388),u=r(27366),c=r(52639),p=r(40281),d=r(94172),h=r(49861),y=(r(25243),r(63780),r(93169),r(69912)),v=r(78983),f=r(34930),m=r(95986),g=r(77318),b=r(83978),w=r(1413),x=r(7138),_=r(32718),Z=r(66978),k=r(17314),C=r(90110),V=r(33624),P=r(10978),T=r(9229),R=function(e){(0,s.Z)(r,e);var t=(0,l.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.apply(this,arguments)).attached=!1,e.container=new V.W,e.updateRequested=!1,e.type="imagery",e._bitmapView=new C.c,e}return(0,o.Z)(r,[{key:"destroy",value:function(){this.attached&&(this.detach(),this.attached=!1),this.updateRequested=!1}},{key:"updating",get:function(){return!this.attached||this.isUpdating()}},{key:"update",value:function(e){var t=this;this.strategy.update(e).catch((function(e){(0,Z.D_)(e)||_.Z.getLogger(t).error(e)}))}},{key:"hitTest",value:function(e){return new c.Z({attributes:{},geometry:e.clone(),layer:this.layer})}},{key:"attach",value:function(){var e=this;this.container.addChild(this._bitmapView);var t=this.layer.version>=10,r=this.layer.version>=10.1?this.layer.imageMaxHeight:2048,i=this.layer.version>=10.1?this.layer.imageMaxWidth:2048;this.strategy=new T.Z({container:this._bitmapView,imageNormalizationSupported:t,imageMaxHeight:r,imageMaxWidth:i,fetchSource:this._fetchImage.bind(this),requestUpdate:function(){return e.requestUpdate()}})}},{key:"detach",value:function(){this.strategy.destroy(),this._bitmapView.removeAllChildren(),this.container.removeAllChildren(),this.updateRequested=!1}},{key:"redraw",value:function(){var e=this;this.strategy.updateExports(function(){var t=(0,n.Z)((0,i.Z)().mark((function t(r){var n,a,o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((a=r.source)&&!(a instanceof ImageBitmap)){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,e.layer.applyRenderer({extent:a.extent,pixelBlock:null!==(n=a.originalPixelBlock)&&void 0!==n?n:a.pixelBlock});case 5:o=t.sent,a.filter=function(t){return e.layer.pixelFilter?e.layer.applyFilter(t):(0,w.Z)((0,w.Z)({},o),{},{extent:a.extent})};case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){(0,Z.D_)(t)||_.Z.getLogger(e).error(t)}))}},{key:"requestUpdate",value:function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())}},{key:"isUpdating",value:function(){return this.strategy.updating||this.updateRequested}},{key:"getPixelData",value:function(){if(this.updating)return null;var e=this.strategy.bitmaps;if(1===e.length&&e[0].source)return{extent:e[0].source.extent,pixelBlock:e[0].source.originalPixelBlock};if(e.length>1){var t=this.view.extent,r=e.map((function(e){return e.source})).filter((function(e){return e.extent&&e.extent.intersects(t)})).map((function(e){return{extent:e.extent,pixelBlock:e.originalPixelBlock}})),i=(0,k.Kh)(r,t);return null!=i?{extent:i.extent,pixelBlock:i.pixelBlock}:null}return null}},{key:"_fetchImage",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t,r,n,a){var o,s,l,u,c=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=a||{}).timeExtent=this.timeExtent,a.requestAsImageElement=!0,a.returnImageBitmap=!0,e.next=3,this.layer.fetchImage(t,r,n,a);case 3:if(!(s=e.sent).imageBitmap){e.next=6;break}return e.abrupt("return",s.imageBitmap);case 6:return e.next=8,this.layer.applyRenderer(s.pixelData,{signal:a.signal});case 8:return l=e.sent,u=new P.Z(l.pixelBlock,null===(o=l.extent)||void 0===o?void 0:o.clone(),s.pixelData.pixelBlock),e.abrupt("return",(u.filter=function(e){return c.layer.applyFilter(e)},u));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,i,n){return e.apply(this,arguments)}}()}]),r}(x.Z);(0,u._)([(0,h.Cb)()],R.prototype,"attached",void 0),(0,u._)([(0,h.Cb)()],R.prototype,"container",void 0),(0,u._)([(0,h.Cb)()],R.prototype,"layer",void 0),(0,u._)([(0,h.Cb)()],R.prototype,"strategy",void 0),(0,u._)([(0,h.Cb)()],R.prototype,"timeExtent",void 0),(0,u._)([(0,h.Cb)()],R.prototype,"view",void 0),(0,u._)([(0,h.Cb)()],R.prototype,"updateRequested",void 0),(0,u._)([(0,h.Cb)()],R.prototype,"updating",null),(0,u._)([(0,h.Cb)()],R.prototype,"type",void 0);var S=R=(0,u._)([(0,y.j)("esri.views.2d.layers.imagery.ImageryView2D")],R),F=r(76200),D=r(41691),E=r(53866),j=r(80394),B=r(64145),q=r(93433),I=r(11752),O=r(61120),N=r(57874),A=r(80613),z=function(e){(0,s.Z)(r,e);var t=(0,l.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.apply(this,arguments)).symbolTypes=["triangle"],e}return(0,o.Z)(r,[{key:"requiresDedicatedFBO",get:function(){return!1}},{key:"prepareRenderPasses",value:function(e){var t=this,i=e.registerRenderPass({name:"imagery (vf)",brushes:[N.Z],target:function(){return t.children},drawPhase:A.jx.MAP});return[].concat((0,q.Z)((0,I.Z)((0,O.Z)(r.prototype),"prepareRenderPasses",this).call(this,e)),[i])}},{key:"doRender",value:function(e){var t=this;this.visible&&e.drawPhase===A.jx.MAP&&this.symbolTypes.forEach((function(i){e.renderPass=i,(0,I.Z)((0,O.Z)(r.prototype),"doRender",t).call(t,e)}))}}]),r}(r(64510).Z),U=r(29439),J=r(97326),M=r(60831),G=function(e){(0,s.Z)(r,e);var t=(0,l.Z)(r);function r(e){var i;return(0,a.Z)(this,r),(i=t.call(this,e))._loading=null,i.update=(0,Z.Ds)((function(e,t){return i._update(e,t).catch((function(e){(0,Z.D_)(e)||_.Z.getLogger((0,J.Z)(i)).error(e)}))})),i}return(0,o.Z)(r,[{key:"updating",get:function(){return!!this._loading}},{key:"redraw",value:function(e){if(this.container.children.length){var t=this.container.children[0];t.symbolizerParameters=e,t.invalidateVAO(),this.container.symbolTypes="wind_speed"===e.style?["scalar","triangle"]:"simple_scalar"===e.style?["scalar"]:["triangle"],this.container.requestRender()}}},{key:"_update",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t,r,n){var a,o,s,l,u,c,p,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stationary){e.next=2;break}return e.abrupt("return");case 2:return a=t.state,o=a.extent,s=a.spatialReference,l=new E.Z({xmin:o.xmin,ymin:o.ymin,xmax:o.xmax,ymax:o.ymax,spatialReference:s}),u=(0,U.Z)(t.state.size,2),c=u[0],p=u[1],this._loading=this.fetchPixels(l,c,p,n),e.next=6,this._loading;case 6:d=e.sent,this._addToDisplay(d,r,t.state),this._loading=null;case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,i){return e.apply(this,arguments)}}()},{key:"_addToDisplay",value:function(e,t,r){if(null==e.pixelBlock)return this.container.children.forEach((function(e){return e.destroy()})),void this.container.removeAllChildren();var i=e.extent,n=e.pixelBlock,a=new M.F(n);a.offset=[0,0],a.symbolizerParameters=t,a.rawPixelData=e,a.invalidateVAO(),a.x=i.xmin,a.y=i.ymax,a.pixelRatio=r.pixelRatio,a.rotation=r.rotation,a.resolution=r.resolution,a.width=n.width*t.symbolTileSize,a.height=n.height*t.symbolTileSize,this.container.children.forEach((function(e){return e.destroy()})),this.container.removeAllChildren(),this.container.symbolTypes="wind_speed"===t.style?["scalar","triangle"]:"simple_scalar"===t.style?["scalar"]:["triangle"],this.container.addChild(a)}}]),r}(x.Z);(0,u._)([(0,h.Cb)()],G.prototype,"fetchPixels",void 0),(0,u._)([(0,h.Cb)()],G.prototype,"container",void 0),(0,u._)([(0,h.Cb)()],G.prototype,"_loading",void 0),(0,u._)([(0,h.Cb)()],G.prototype,"updating",null);var H=G=(0,u._)([(0,y.j)("esri.views.2d.layers.imagery.ImageryVFStrategy")],G),L=function(e){(0,s.Z)(r,e);var t=(0,l.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.apply(this,arguments)).attached=!1,e.container=new z,e.type="imageryVF",e._dataParameters={exportParametersVersion:0,bbox:"",symbolTileSize:0,time:""},e._fetchpixels=function(){var t=(0,n.Z)((0,i.Z)().mark((function t(r,n,a,o){var s,l,u,c,p,d,h,y,v,f,m;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._projectFullExtentPromise;case 2:if(s=t.sent,l=e.layer.renderer.symbolTileSize,u=(0,B.BH)(r,n,a,l,s),c=u.extent,p=u.width,d=u.height,null==s||s.intersects(r)){t.next=10;break}return t.abrupt("return",{extent:c,pixelBlock:null});case 10:if(h={bbox:"".concat(c.xmin,", ").concat(c.ymin,", ").concat(c.xmax,", ").concat(c.ymax),exportParametersVersion:e.layer.exportImageServiceParameters.version,symbolTileSize:l,time:JSON.stringify(e.timeExtent||"")},!e._canReuseVectorFieldData(h)){t.next=16;break}if(null==(y=e.getPixelData())){t.next=16;break}if("".concat(y.extent.xmin,", ").concat(y.extent.ymin,", ").concat(y.extent.xmax,", ").concat(y.extent.ymax)!==h.bbox){t.next=16;break}return t.abrupt("return",y);case 16:return t.next=18,e.layer.fetchImage(c,p,d,{timeExtent:e.timeExtent,requestAsImageElement:!1,signal:o});case 18:if(v=t.sent,f=v.pixelData,e._dataParameters=h,null!=(m=null===f||void 0===f?void 0:f.pixelBlock)){t.next=24;break}return t.abrupt("return",{extent:c,pixelBlock:null});case 24:return t.abrupt("return",{extent:c,pixelBlock:"vector-uv"===e.layer.rasterInfo.dataType?(0,B.KC)(m,"vector-uv"):m});case 25:case"end":return t.stop()}}),t)})));return function(e,r,i,n){return t.apply(this,arguments)}}(),e}return(0,o.Z)(r,[{key:"updating",get:function(){return!this.attached||this._strategy.updating}},{key:"attach",value:function(){var e=this;this._projectFullExtentPromise=this._getProjectedFullExtent(this.view.spatialReference),this._strategy=new H({container:this.container,fetchPixels:this._fetchpixels}),this.handles.add((0,d.YP)((function(){return e.layer.renderer}),(function(t){return e._updateSymbolizerParams(t)}),d.tX),"attach")}},{key:"detach",value:function(){this._strategy.destroy(),this.container.children.forEach((function(e){return e.destroy()})),this.container.removeAllChildren(),this.handles.remove("attach"),this._strategy=this.container=this._projectFullExtentPromise=null}},{key:"getPixelData",value:function(){var e,t=null===(e=this.container.children[0])||void 0===e?void 0:e.rawPixelData;return this.updating||!t?null:{extent:t.extent,pixelBlock:t.pixelBlock}}},{key:"hitTest",value:function(e){return new c.Z({attributes:{},geometry:e.clone(),layer:this.layer})}},{key:"update",value:function(e){this._strategy.update(e,this._symbolizerParams)}},{key:"redraw",value:function(){var e=this.layer.renderer;e&&(this._updateSymbolizerParams(e),this._strategy.redraw(this._symbolizerParams))}},{key:"_canReuseVectorFieldData",value:function(e){var t=this._dataParameters.exportParametersVersion===e.exportParametersVersion,r=this._dataParameters.time===e.time,i=this._dataParameters.symbolTileSize===e.symbolTileSize,n=this._dataParameters.bbox===e.bbox;return t&&r&&i&&n}},{key:"_getProjectedFullExtent",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,j.tB)(this.layer.fullExtent,t);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.prev=8,e.next=11,(0,F.default)(this.layer.url,{query:{option:"footprints",outSR:t.wkid||JSON.stringify(t.toJSON()),f:"json"}});case 11:return r=e.sent.data.featureCollection.layers[0].layerDefinition.extent,e.abrupt("return",r?E.Z.fromJSON(r):null);case 15:return e.prev=15,e.t1=e.catch(8),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,this,[[0,6],[8,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateSymbolizerParams",value:function(e){"vector-field"===e.type&&(this._symbolizerParams=this.layer.symbolizer.generateWebGLParameters({pixelBlock:null}))}}]),r}(D.r);(0,u._)([(0,h.Cb)()],L.prototype,"attached",void 0),(0,u._)([(0,h.Cb)()],L.prototype,"container",void 0),(0,u._)([(0,h.Cb)()],L.prototype,"layer",void 0),(0,u._)([(0,h.Cb)()],L.prototype,"timeExtent",void 0),(0,u._)([(0,h.Cb)()],L.prototype,"type",void 0),(0,u._)([(0,h.Cb)()],L.prototype,"view",void 0),(0,u._)([(0,h.Cb)()],L.prototype,"updating",null);var X=L=(0,u._)([(0,y.j)("esri.views.2d.layers.imagery.VectorFieldView2D")],L),Y=r(10064),W=r(585),K=r(45948),Q=r(86638),$=r(24405),ee=r(67581),te=function(e){(0,s.Z)(r,e);var t=(0,l.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.apply(this,arguments))._exportImageVersion=-1,e._highlightGraphics=new v.J,e._highlightView=void 0,e.layer=null,e.subview=null,e}return(0,o.Z)(r,[{key:"pixelData",get:function(){var e=this.subview;return this.updating||!e?null:"getPixelData"in e?e.getPixelData():null}},{key:"hitTest",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.subview?[{type:"graphic",graphic:this.subview.hitTest(t),layer:this.layer,mapPoint:t}]:null);case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"update",value:function(e){var t;null===(t=this.subview)||void 0===t||t.update(e)}},{key:"attach",value:function(){var e=this;this.layer.increaseRasterJobHandlerUsage(),this._setSubView(),this.view&&(this._highlightView=new g.Z({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:function(){return e.requestUpdate()},container:new b.Z(this.view.featuresTilingScheme)}),this.container.addChild(this._highlightView.container)),this.addAttachHandles([(0,d.YP)((function(){var t;return null!==(t=e.layer.blendMode)&&void 0!==t?t:"normal"}),(function(t){return e.subview&&(e.subview.container.blendMode=t)}),d.tX),(0,d.YP)((function(){var t;return null!==(t=e.layer.effect)&&void 0!==t?t:null}),(function(t){return e.subview&&(e.subview.container.effect=t)}),d.tX),(0,d.YP)((function(){return e.layer.exportImageServiceParameters.version}),(function(t){t&&e._exportImageVersion!==t&&(e._exportImageVersion=t,e.requestUpdate())}),d.Z_),(0,d.YP)((function(){return e.timeExtent}),(function(t){var r=e.subview;r&&(r.timeExtent=t,"redraw"in r?e.requestUpdate():r.redrawOrRefetch())}),d.Z_),this.layer.on("redraw",(function(){var t=e.subview;t&&("redraw"in t?t.redraw():t.redrawOrRefetch())})),(0,d.YP)((function(){return e.layer.renderer}),(function(){return e._setSubView()}))])}},{key:"detach",value:function(){var e,t;this.layer.decreaseRasterJobHandlerUsage(),this.container.removeAllChildren(),this._detachSubview(this.subview),null!==(e=this.subview)&&void 0!==e&&e.destroy(),this.subview=null,null!==(t=this._highlightView)&&void 0!==t&&t.destroy(),this._exportImageVersion=-1}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"highlight",value:function(e,t){var r=this;if(!((Array.isArray(e)?e[0]:p.Z.isCollection(e)?e.at(0):e)instanceof c.Z))return{remove:function(){}};var i=[];return Array.isArray(e)||p.Z.isCollection(e)?i=e.map((function(e){return e.clone()})):e instanceof c.Z&&(i=[e.clone()]),this._highlightGraphics.addMany(i),{remove:function(){r._highlightGraphics.removeMany(i)}}}},{key:"doRefresh",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.requestUpdate();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isUpdating",value:function(){return!this.subview||this.subview.updating}},{key:"_setSubView",value:function(){var e;if(this.view){var t=null===(e=this.layer.renderer)||void 0===e?void 0:e.type,r="imagery";if("vector-field"===t?r="imageryVF":"flow"===t&&(r="flow"),this.subview){var i,n=this.subview.type;if(n===r)return this._attachSubview(this.subview),void("flow"===n?this.subview.redrawOrRefetch():"imagery"===n&&"lerc"===this.layer.format?this.subview.redraw():this.requestUpdate());this._detachSubview(this.subview),null===(i=this.subview)||void 0===i||i.destroy()}this.subview="imagery"===r?new S({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):"imageryVF"===r?new X({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):new f.Z({layer:this.layer,layerView:this}),this._attachSubview(this.subview),this.requestUpdate()}}},{key:"_attachSubview",value:function(e){e&&!e.attached&&(e.attach(),e.attached=!0,this.container.addChildAt(e.container,0),e.container.blendMode=this.layer.blendMode,e.container.effect=this.layer.effect)}},{key:"_detachSubview",value:function(e){(null===e||void 0===e?void 0:e.attached)&&(this.container.removeChild(e.container),e.detach(),e.attached=!1)}}]),r}(function(e){var t=function(e){(0,s.Z)(r,e);var t=(0,l.Z)(r);function r(){var e;return(0,a.Z)(this,r),(e=t.apply(this,arguments)).view=null,e}return(0,o.Z)(r,[{key:"fetchPopupFeatures",value:function(){var e=(0,n.Z)((0,i.Z)().mark((function e(t,r){var n,a,o,s,l,u,c,p,d,h,y,v,f;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.layer,t){e.next=3;break}throw new Y.Z("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:n});case 3:if(a=n.popupEnabled,o=(0,$.V5)(n,r),a&&null!=o){e.next=6;break}throw new Y.Z("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:a,popupTemplate:o});case 6:return e.next=8,o.getRequiredFields();case 8:return s=e.sent,(l=new Q.Z).timeExtent=this.timeExtent,l.geometry=t,l.outFields=s,l.outSpatialReference=t.spatialReference,u=this.view,c=u.resolution,p=u.spatialReference,d="2d"===this.view.type?new W.Z(c,c,p):new W.Z(.5*c,.5*c,p),h=o.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},y=h.returnTopmostRaster,v=h.showNoDataRecords,f={returnDomainValues:!0,returnTopmostRaster:y,pixelSize:d,showNoDataRecords:v,signal:null!=r?r.signal:null},e.abrupt("return",n.queryVisibleRasters(l,f).then((function(e){return e})));case 13:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"canResume",value:function(){var e;return!!(0,I.Z)((0,O.Z)(r.prototype),"canResume",this).call(this)&&!(null!==(e=this.timeExtent)&&void 0!==e&&e.isEmpty)}}]),r}(e);return(0,u._)([(0,h.Cb)()],t.prototype,"layer",void 0),(0,u._)([(0,h.Cb)()],t.prototype,"suspended",void 0),(0,u._)([(0,h.Cb)(K.qG)],t.prototype,"timeExtent",void 0),(0,u._)([(0,h.Cb)()],t.prototype,"view",void 0),t=(0,u._)([(0,y.j)("esri.views.layers.ImageryLayerView")],t)}((0,r(13107).Z)((0,m.y)(ee.Z))));(0,u._)([(0,h.Cb)()],te.prototype,"pixelData",null),(0,u._)([(0,h.Cb)()],te.prototype,"subview",void 0);var re=te=(0,u._)([(0,y.j)("esri.views.2d.layers.ImageryLayerView2D")],te)},83978:function(e,t,r){r.d(t,{Z:function(){return v}});var i=r(15671),n=r(43144),a=r(11752),o=r(61120),s=r(60136),l=r(29388),u=r(27366),c=(r(32718),r(25243),r(63780),r(93169),r(10064),r(69912)),p=r(80613),d=r(82022),h=r(8548),y=function(e){(0,s.Z)(r,e);var t=(0,l.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,n.Z)(r,[{key:"doRender",value:function(e){e.drawPhase===p.jx.HIGHLIGHT&&(0,a.Z)((0,o.Z)(r.prototype),"doRender",this).call(this,e)}},{key:"renderChildren",value:function(e){if(this.attributeView.update(),this.children.some((function(e){return e.hasData}))){this.attributeView.bindTextures(e.context),(0,a.Z)((0,o.Z)(r.prototype),"renderChildren",this).call(this,e);var t=e.painter.effects.highlight;t.bind(e),e.context.setColorMask(!0,!0,!0,!0),e.context.clear(h.lk.COLOR_BUFFER_BIT),this._renderChildren(e,t.defines.concat(["highlightAll"])),t.draw(e),t.unbind()}}}]),r}(d.Z),v=y=(0,u._)([(0,c.j)("esri.views.2d.layers.support.HighlightGraphicContainer")],y)}}]);
//# sourceMappingURL=8396.8724bb74.chunk.js.map