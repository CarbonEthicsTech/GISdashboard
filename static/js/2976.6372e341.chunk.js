"use strict";(self.webpackChunkgis_dashboard=self.webpackChunkgis_dashboard||[]).push([[2976],{67077:function(e,t,r){function n(){return[0,0,0,0]}function i(e,t,r,n){return[e,t,r,n]}function a(e,t){return new Float64Array(e,t,4)}function u(){return[0,0,0,0]}function o(){return i(1,1,1,1)}function l(){return i(1,0,0,0)}function s(){return i(0,1,0,0)}function c(){return i(0,0,1,0)}function f(){return i(0,0,0,1)}r.d(t,{a:function(){return a},c:function(){return n},f:function(){return i}});var h=[0,0,0,0],d=o(),v=l(),y=s(),p=c(),w=f();Object.freeze(Object.defineProperty({__proto__:null,ONES:d,UNIT_W:w,UNIT_X:v,UNIT_Y:y,UNIT_Z:p,ZEROS:h,clone:function(e){return[e[0],e[1],e[2],e[3]]},create:n,createView:a,fromArray:function(e){for(var t=[0,0,0,0],r=Math.min(4,e.length),n=0;n<r;++n)t[n]=e[n];return t},fromValues:i,ones:o,unitW:f,unitX:l,unitY:s,unitZ:c,zeros:u},Symbol.toStringTag,{value:"Module"}))},27811:function(e,t,r){r.d(t,{AJ:function(){return c},If:function(){return y},QM:function(){return d},hy:function(){return v},k0:function(){return s},nu:function(){return l},uI:function(){return h},wx:function(){return p}});var n=r(37762),i=r(16889),a=r(17842),u=r(90045),o=r(67077),l=2.4;function s(e){return(0,a.Wz)(e*l)}function c(e){return(0,a.F2)(e)/l}function f(e,t,r,n){var a=t.color,o=t.ratio,l=r.color,s=r.ratio;if(s===o){var c=1e-6;1===s?o-=c:s+=c}var f=(0,i.uZ)((n-o)/(s-o),0,1);(0,u.l)(e,a.toArray(),l.toArray(),f)}function h(e){var t=new Uint8ClampedArray(2048);if(e=e.filter((function(e){var t=e.ratio;return t>=0&&t<=1})).sort((function(e,t){return e.ratio-t.ratio})).map((function(e){var t=e.color,r=e.ratio;return{color:t,ratio:Math.max(r,.001)}})),e.length<1)return t;for(var r=e[0],n=e[0],i=1,a=(0,o.c)(),u=0;u<512;u++){for(var l=(u+.5)/512;l>n.ratio&&i<e.length;)r=n,n=e[i++];f(a,r,n,l),t.set(a,4*u)}return t}function d(e,t,r,i){var u,o,l=t.radius,s=t.fieldOffset,c=t.field,f=Math.round((0,a.F2)(l)),h=new Float64Array(r*i),d=Number.NEGATIVE_INFINITY,v=function(e,t){return null!=e?"string"==typeof t?function(t){return-1*+t.readAttribute(e)}:function(r){return+r.readAttribute(e)+t}:function(e){return 1}}(c,s),p=new Set,w=(0,n.Z)(e);try{for(w.s();!(o=w.n()).done;)for(var g=o.value.getCursor();g.next();){var m=g.getObjectId();if(!p.has(m)){p.add(m);var _=g.readLegacyPointGeometry(),Z=128;if(!(_.x<-Z||_.x>=r+Z||_.y<-Z||_.y>i+Z))for(var k=+v(g),I=Math.max(0,Math.round(_.x)-f),x=Math.max(0,Math.round(_.y)-f),b=Math.min(i,Math.round(_.y)+f),M=Math.min(r,Math.round(_.x)+f),S=x;S<b;S++)for(var T=I;T<M;T++){var R=S*r+T,V=y(_.x-T,_.y-S,f);(u=h[R]+=V*k)>d&&(d=u)}}}}catch(C){w.e(C)}finally{w.f()}return{matrix:h.buffer,max:d}}function v(e,t,r,n,a,u){e.canvas.width=e.canvas.height=t,e.clearRect(0,0,t,t);var o=e.getImageData(0,0,t,t);r&&n&&o.data.set(new Uint8ClampedArray(function(e,t,r,n,a){for(var u=new Uint32Array(e*e),o=("buffer"in t?t:new Float64Array(t)),l=("buffer"in r?new Uint32Array(r.buffer):new Uint32Array(new Uint8Array(r).buffer)),s=l.length/(a-n),c=0;c<o.length;c++){var f=o[c],h=Math.floor((f-n)*s);u[c]=l[(0,i.uZ)(h,0,l.length-1)]}return u.buffer}(t,r,n,a,u))),e.putImageData(o,0,0)}function y(e,t,r){var n=Math.sqrt(Math.pow(e,2)+Math.pow(t,2))/r;return n>1?0:3/(Math.PI*Math.pow(r,2))*Math.pow(1-Math.pow(n,2),2)}function p(e,t){return"function"==typeof e?e:e?"string"==typeof t?function(t){return-1*+t[e]}:function(r){return+r[e]+t}:function(){return 1}}},55067:function(e,t,r){r.d(t,{Z:function(){return p}});var n=r(37762),i=r(15671),a=r(43144),u=r(11752),o=r(61120),l=r(60136),s=r(29388),c=r(93169),f=r(80613),h=r(64510),d=r(52424),v=r(40655),y=function(e,t){return e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col},p=function(e){(0,l.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this))._tileInfoView=e,n}return(0,a.Z)(r,[{key:"requiresDedicatedFBO",get:function(){return!1}},{key:"renderChildren",value:function(e){this.sortChildren(y),this.setStencilReference(e),(0,u.Z)((0,o.Z)(r.prototype),"renderChildren",this).call(this,e)}},{key:"createRenderParams",value:function(e){var t=e.state,n=(0,u.Z)((0,o.Z)(r.prototype),"createRenderParams",this).call(this,e);return n.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,n.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(t.scale),n}},{key:"prepareRenderPasses",value:function(e){var t=this,n=(0,u.Z)((0,o.Z)(r.prototype),"prepareRenderPasses",this).call(this,e);return n.push(e.registerRenderPass({name:"stencil",brushes:[v.Z],drawPhase:f.jx.DEBUG|f.jx.MAP|f.jx.HIGHLIGHT,target:function(){return t.getStencilTarget()}})),(0,c.Z)("esri-tiles-debug")&&n.push(e.registerRenderPass({name:"tileInfo",brushes:[d.Z],drawPhase:f.jx.DEBUG,target:function(){return t.children}})),n}},{key:"getStencilTarget",value:function(){return this.children}},{key:"setStencilReference",value:function(e){var t,r=1,i=(0,n.Z)(this.children);try{for(i.s();!(t=i.n()).done;){t.value.stencilRef=r++}}catch(a){i.e(a)}finally{i.f()}}}]),r}(h.Z)},72900:function(e,t,r){r.d(t,{I:function(){return f}});var n=r(29439),i=r(15671),a=r(43144),u=r(60136),o=r(29388),l=r(22753),s=r(87422),c=r(73828),f=function(e){(0,u.Z)(r,e);var t=(0,o.Z)(r);function r(e,n,a,u,o,l){var s,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:o,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:l;return(0,i.Z)(this,r),(s=t.call(this)).triangleCountReportedInDebug=0,s.triangleCount=0,s.texture=null,s.key=new c.Z(e),s.resolution=n,s.x=a,s.y=u,s.width=o,s.height=l,s.rangeX=f,s.rangeY=h,s}return(0,a.Z)(r,[{key:"destroy",value:function(){this.texture&&(this.texture.dispose(),this.texture=null)}},{key:"setTransform",value:function(e){var t=this.resolution/(e.resolution*e.pixelRatio),r=this.transforms.tileMat3,i=e.toScreenNoRotation([0,0],[this.x,this.y]),a=(0,n.Z)(i,2),u=a[0],o=a[1],s=this.width/this.rangeX*t,c=this.height/this.rangeY*t;(0,l.s)(r,s,0,0,0,c,0,u,o,1),(0,l.m)(this.transforms.dvs,e.displayViewMat3,r)}}]),r}(s.s)},4321:function(e,t,r){r.d(t,{Y:function(){return c}});var n=r(15671),i=r(43144),a=r(60136),u=r(29388),o=r(27366),l=(r(32718),r(25243),r(63780),r(93169),r(10064),r(69912)),s=r(9849),c=function(e){var t=function(e){(0,a.Z)(r,e);var t=(0,u.Z)(r);function r(){return(0,n.Z)(this,r),t.apply(this,arguments)}return(0,i.Z)(r,[{key:"attach",value:function(){this.view.timeline.record("".concat(this.layer.title," (BitmapTileLayer) Attach")),this._bitmapView=new s.s(this._tileInfoView),this.container.addChild(this._bitmapView)}},{key:"detach",value:function(){var e;this.container.removeChild(this._bitmapView),null===(e=this._bitmapView)||void 0===e||e.removeAllChildren()}}]),r}(e);return t=(0,o._)([(0,l.j)("esri.views.2d.layers.BitmapTileLayerView2D")],t)}},5738:function(e,t,r){r.r(t),r.d(t,{default:function(){return A}});var n=r(1413),i=r(74165),a=r(15861),u=r(29439),o=r(15671),l=r(43144),s=r(11752),c=r(61120),f=r(60136),h=r(29388),d=r(27366),v=r(32718),y=r(66978),p=r(94172),w=r(49861),g=(r(25243),r(63780),r(93169),r(69912)),m=r(92975),_=r(4321),Z=r(95986),k=r(34622),I=r(37995),x=r(73828),b=r(32344),M=r(85269),S=r(67581),T=r(13107),R=[102113,102100,3857,3785,900913],V=[0,0],C=function(e){(0,f.Z)(r,e);var t=(0,h.Z)(r);function r(){var e;return(0,o.Z)(this,r),(e=t.apply(this,arguments))._tileStrategy=null,e._fetchQueue=null,e._tileRequests=new Map,e.layer=null,e}return(0,l.Z)(r,[{key:"tileMatrixSet",get:function(){var e=this._getTileMatrixSetBySpatialReference(this.layer.activeLayer);return e?(e.id!==this.layer.activeLayer.tileMatrixSetId&&(this.layer.activeLayer.tileMatrixSetId=e.id),e):null}},{key:"update",value:function(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume()}},{key:"attach",value:function(){var e,t=this,n=null===(e=this.tileMatrixSet)||void 0===e?void 0:e.tileInfo;n&&(this._tileInfoView=new I.Z(n),this._fetchQueue=new b.Z({tileInfoView:this._tileInfoView,concurrency:16,process:function(e,r){return t.fetchTile(e,r)}}),this._tileStrategy=new M.Z({cachePolicy:"keep",resampling:!0,acquireTile:function(e){return t.acquireTile(e)},releaseTile:function(e){return t.releaseTile(e)},tileInfoView:this._tileInfoView}),this.addAttachHandles((0,p.YP)((function(){var e;return[null===(e=t.layer)||void 0===e||null===(e=e.activeLayer)||void 0===e?void 0:e.styleId,t.tileMatrixSet]}),(function(){return t._refresh()}))),(0,s.Z)((0,c.Z)(r.prototype),"attach",this).call(this))}},{key:"detach",value:function(){var e,t;(0,s.Z)((0,c.Z)(r.prototype),"detach",this).call(this),null!==(e=this._tileStrategy)&&void 0!==e&&e.destroy(),null!==(t=this._fetchQueue)&&void 0!==t&&t.destroy(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null}},{key:"moveStart",value:function(){this.requestUpdate()}},{key:"viewChange",value:function(){this.requestUpdate()}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"releaseTile",value:function(e){this._fetchQueue.abort(e.key.id),this._bitmapView.removeChild(e),e.once("detach",(function(){return e.destroy()})),this.requestUpdate()}},{key:"acquireTile",value:function(e){var t,r,n,i=this._bitmapView.createTile(e),a=i.bitmap;return t=this._tileInfoView.getTileCoords(V,i.key),r=(0,u.Z)(t,2),a.x=r[0],a.y=r[1],a.resolution=this._tileInfoView.getTileResolution(i.key),n=(0,u.Z)(this._tileInfoView.tileInfo.size,2),a.width=n[0],a.height=n[1],this._enqueueTileFetch(i),this._bitmapView.addChild(i),this.requestUpdate(),i}},{key:"doRefresh",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:!this.attached||this.updateRequested||this.suspended||this._refresh();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isUpdating",value:function(){var e,t;return null!==(e=null===(t=this._fetchQueue)||void 0===t?void 0:t.updating)&&void 0!==e&&e}},{key:"fetchTile",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r,a,u,o,l,s,c,f,h,d,v=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:{},a="tilemapCache"in this.layer?this.layer.tilemapCache:null,u=r.signal,o=r.resamplingLevel,l=void 0===o?0:o,a){e.next=4;break}return e.abrupt("return",this._fetchImage(t,u));case 4:return s=new x.Z(0,0,0,0),e.prev=5,e.next=8,a.fetchAvailabilityUpsample(t.level,t.row,t.col,s,{signal:u});case 8:return e.next=10,this._fetchImage(s,u);case 10:c=e.sent,e.next=26;break;case 13:if(e.prev=13,e.t0=e.catch(5),!(0,y.D_)(e.t0)){e.next=17;break}throw e.t0;case 17:if(!(l<3)){e.next=25;break}if(!(f=this._tileInfoView.getTileParentId(t.id))){e.next=25;break}return h=new x.Z(f),e.next=23,this.fetchTile(h,(0,n.Z)((0,n.Z)({},r),{},{resamplingLevel:l+1}));case 23:return d=e.sent,e.abrupt("return",(0,k.i)(this._tileInfoView,d,h,t));case 25:throw e.t0;case 26:return e.abrupt("return",(0,k.i)(this._tileInfoView,c,s,t));case 27:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"canResume",value:function(){var e=(0,s.Z)((0,c.Z)(r.prototype),"canResume",this).call(this);return e?null!==this.tileMatrixSet:e}},{key:"supportsSpatialReference",value:function(e){var t,r;return null!==(t=null===(r=this.layer.activeLayer.tileMatrixSets)||void 0===r?void 0:r.some((function(t){var r;return(0,m.fS)(null===(r=t.tileInfo)||void 0===r?void 0:r.spatialReference,e)})))&&void 0!==t&&t}},{key:"_enqueueTileFetch",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r,n=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._fetchQueue.has(t.key.id)){e.next=12;break}return e.prev=1,e.next=4,this._fetchQueue.push(t.key);case 4:r=e.sent,t.bitmap.source=r,t.bitmap.width=this._tileInfoView.tileInfo.size[0],t.bitmap.height=this._tileInfoView.tileInfo.size[1],t.once("attach",(function(){return n.requestUpdate()})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),(0,y.D_)(e.t0)||v.Z.getLogger(this).error(e.t0);case 11:this.requestUpdate();case 12:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchImage",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.layer.fetchImageBitmapTile(t.level,t.row,t.col,{signal:r}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_refresh",value:function(){var e=this;this._fetchQueue.reset(),this._tileStrategy.refresh((function(t){if(t.bitmap.source){var r={id:t.key.id,fulfilled:!1,promise:e._fetchQueue.push(t.key).then((function(e){t.bitmap.source=e})).catch((function(e){(0,y.D_)(e)||(t.bitmap.source=null)})).finally((function(){t.requestRender(),r.fulfilled=!0}))};e._tileRequests.set(t,r)}}))}},{key:"_getTileMatrixSetBySpatialReference",value:function(e){var t=this.view.spatialReference;if(!e.tileMatrixSets)return null;var r=e.tileMatrixSets.find((function(e){var r;return(0,m.fS)(null===(r=e.tileInfo)||void 0===r?void 0:r.spatialReference,t)}));return!r&&t.isWebMercator&&(r=e.tileMatrixSets.find((function(e){var t,r;return R.includes(null!==(t=null===(r=e.tileInfo)||void 0===r?void 0:r.spatialReference.wkid)&&void 0!==t?t:-1)}))),r}}]),r}((0,T.Z)((0,_.Y)((0,Z.y)(S.Z))));(0,d._)([(0,w.Cb)()],C.prototype,"_fetchQueue",void 0),(0,d._)([(0,w.Cb)({readOnly:!0})],C.prototype,"tileMatrixSet",null);var A=C=(0,d._)([(0,g.j)("esri.views.2d.layers.WMTSLayerView2D")],C)},34622:function(e,t,r){r.d(t,{V:function(){return a},i:function(){return i}});var n=r(29439);function i(e,t,r,n){if(r.level===n.level)return t;var i=e.tileInfo.size,u=e.getTileResolution(r.level),o=e.getTileResolution(n.level),l=e.getLODInfoAt(n.level),s=l.getXForColumn(n.col),c=l.getYForRow(n.row),f=(l=e.getLODInfoAt(r.level)).getXForColumn(r.col),h=l.getYForRow(r.row),d=function(e){return e instanceof HTMLImageElement?e.naturalWidth:e.width}(t)/i[0],v=function(e){return e instanceof HTMLImageElement?e.naturalHeight:e.height}(t)/i[1],y=Math.round(d*((s-f)/u)),p=Math.round(v*(-(c-h)/u)),w=Math.round(d*i[0]*(o/u)),g=Math.round(v*i[1]*(o/u)),m=a(i);return m.getContext("2d").drawImage(t,y,p,w,g,0,0,i[0],i[1]),m}function a(e){var t,r=document.createElement("canvas");return t=(0,n.Z)(e,2),r.width=t[0],r.height=t[1],r}}}]);
//# sourceMappingURL=2976.6372e341.chunk.js.map