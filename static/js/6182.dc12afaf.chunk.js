"use strict";(self.webpackChunkgis_dashboard=self.webpackChunkgis_dashboard||[]).push([[6182],{48732:function(e,t,r){r.d(t,{Hg:function(){return v},V7:function(){return h},uD:function(){return f}});var n=r(4942),i=r(37762),a=r(7138),o=r(40281),s=r(23879),u=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function l(e){return e instanceof a.Z}function p(e){return e instanceof o.Z?Object.keys(e.items):l(e)?(0,s.vw)(e).keys():e?Object.keys(e):[]}function d(e,t){return e instanceof o.Z?e.items[t]:e[t]}function c(e){return e?e.declaredClass:null}function y(e,t){var r=e.diff;if(r&&"function"==typeof r)return r(e,t);var a=p(e),o=p(t);if(0!==a.length||0!==o.length){if(!a.length||!o.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};var s,f=o.filter((function(e){return!a.includes(e)})),h=a.filter((function(e){return!o.includes(e)})),v=a.filter((function(r){return o.includes(r)&&d(e,r)!==d(t,r)})).concat(f,h).sort(),m=c(e);if(m&&u.includes(m)&&v.length)return{type:"complete",oldValue:e,newValue:t};var g,b=l(e)&&l(t),w=(0,i.Z)(v);try{for(w.s();!(g=w.n()).done;){var _=g.value,k=d(e,_),Z=d(t,_),C=void 0;if((b||"function"!=typeof k&&"function"!=typeof Z)&&k!==Z&&(null!=k||null!=Z)){var x;if(r&&r[_]&&"function"==typeof r[_])C=null===(x=r[_])||void 0===x?void 0:x.call(r,k,Z);else if(k instanceof Date&&Z instanceof Date){if(k.getTime()===Z.getTime())continue;C={type:"complete",oldValue:k,newValue:Z}}else C="object"==typeof k&&"object"==typeof Z&&c(k)===c(Z)?y(k,Z):{type:"complete",oldValue:k,newValue:Z};null!=C&&(null!=s?s.diff[_]=C:s={type:"partial",diff:(0,n.Z)({},_,C)})}}}catch(T){w.e(T)}finally{w.f()}return s}}function f(e,t){if(null==e)return!1;var r,n=t.split("."),a=e,o=(0,i.Z)(n);try{for(o.s();!(r=o.n()).done;){var s=r.value;if("complete"===a.type)return!0;if("partial"!==a.type)return!1;var u=a.diff[s];if(!u)return!1;a=u}}catch(l){o.e(l)}finally{o.f()}return!0}function h(e,t){var r,n=(0,i.Z)(t);try{for(n.s();!(r=n.n()).done;){if(f(e,r.value))return!0}}catch(a){n.e(a)}finally{n.f()}return!1}function v(e,t){if("function"!=typeof e&&"function"!=typeof t&&(null!=e||null!=t))return null==e||null==t||"object"==typeof e&&"object"==typeof t&&c(e)!==c(t)?{type:"complete",oldValue:e,newValue:t}:y(e,t)}},84683:function(e,t,r){r.d(t,{bU:function(){return d},fC:function(){return f},tp:function(){return y},v7:function(){return c}});var n=new Float64Array(2),i=new Float64Array(2),a="0123456789bcdefghjkmnpqrstuvwxyz";function o(e){return a[e]}function s(e){return(e[0]+e[1])/2}function u(e,t,r){return e[0]=t,e[1]=r,e}function l(e,t){var r=s(e),n=t,i=!t;e[0]=i*e[0]+n*r,e[1]=i*r+n*e[1]}function p(e,t){var r=t>s(e);return l(e,r),r}function d(e,t){for(var r=-90,n=90,i=-180,a=180,o=0;o<t;o++){for(var s=Math.ceil((o+1)/2),u=Math.floor((o+1)/2),l=1-o%2,p=30-(3*s+2*u),d=30-(2*s+3*u),c=3*l+2*(1-l),y=2*l+3*(1-l),f=3*l+7*(1-l)<<d,h=(7*l+3*(1-l)<<p&e.geohashX)>>p,v=(f&e.geohashY)>>d,m=c-1;m>=0;m--){var g=(i+a)/2,b=h&1<<m?1:0;i=(1-b)*i+b*g,a=(1-b)*g+b*a}for(var w=y-1;w>=0;w--){var _=(r+n)/2,k=v&1<<w?1:0;r=(1-k)*r+k*_,n=(1-k)*_+k*n}}return[i,r,a,n]}function c(e,t,r,n){n%2&&(n+=1);for(var i=0,a=0,o=-90,s=90,u=-180,l=180,p=0;p<n/2;p++){for(var d=0;d<5;d++){var c=(u+l)/2,y=r>c?1:0;i|=y<<29-(d+5*p),u=(1-y)*u+y*c,l=(1-y)*c+y*l}for(var f=0;f<5;f++){var h=(o+s)/2,v=t>h?1:0;a|=v<<29-(f+5*p),o=(1-v)*o+v*h,s=(1-v)*h+v*s}}e.geohashX=i,e.geohashY=a}function y(e,t,r,n,i){i%2&&(i+=1);for(var a=0,o=0,s=-90,u=90,l=-180,p=180,d=0;d<i/2;d++){for(var c=0;c<5;c++){var y=(l+p)/2,f=n>y?1:0;a|=f<<29-(c+5*d),l=(1-f)*l+f*y,p=(1-f)*y+f*p}for(var h=0;h<5;h++){var v=(s+u)/2,m=r>v?1:0;o|=m<<29-(h+5*d),s=(1-m)*s+m*v,u=(1-m)*v+m*u}}e[2*t]=a,e[2*t+1]=o}function f(e,t,r){for(var a="",s=u(n,-90,90),l=u(i,-180,180),d=0;d<r;d++){var c=0;d%2?(c|=p(s,e)<<4,c|=p(l,t)<<3,c|=p(s,e)<<2,c|=p(l,t)<<1,c|=p(s,e)<<0):(c|=p(l,t)<<4,c|=p(s,e)<<3,c|=p(l,t)<<2,c|=p(s,e)<<1,c|=p(l,t)<<0),a+=o(c)}return a}},22688:function(e,t,r){r.r(t),r.d(t,{default:function(){return Fr}});var n=r(37762),i=r(74165),a=r(15861),o=r(15671),s=r(43144),u=r(82963),l=r(60136),p=r(29388),d=r(27366),c=(r(59486),r(40281)),y=r(10064),f=r(32718),h=r(66978),v=r(49861),m=(r(25243),r(63780),r(93169)),g=r(69912),b=r(84683),w=r(30651),_=r(83406),k=r(80457),Z=r(29439),C=r(7138),x=r(76672),T=r(80885),E=r(52587),I=r(92975),M=r(3182),S=function(){function e(){(0,o.Z)(this,e),this._featureLookup=new Map}return(0,s.Z)(e,[{key:"deleteFromStore",value:function(e){var t=this;e.forEach((function(e){t._featureLookup.delete(e)}))}},{key:"readFromStoreByList",value:function(e){var t=this,r=[];return e.forEach((function(e){var n=t.readFromStoreById(e);n&&r.push(n)})),r}},{key:"readFromStoreById",value:function(e){var t;return null!==(t=this._featureLookup.get(e))&&void 0!==t?t:null}},{key:"writeToStore",value:function(e,t,r){var n=this,i=[];return e.forEach((function(e){if(e&&e.id){e.properties||(e.properties=[]);var a,o=null;if(r&&(o=e.properties[r]?(0,_.GH)(e.properties[r]):null),"originId"in e&&"destinationId"in e&&(e.properties.ESRI__ORIGIN_ID=e.originId,e.properties.ESRI__DESTINATION_ID=e.destinationId),e.properties[t]=e.id,e.id&&n._featureLookup.has(e.id)&&n._featureLookup.get(e.id).attributes){var s=n._featureLookup.get(e.id);a=new M.u_(o?JSON.parse(JSON.stringify(o)):null!==s&&void 0!==s&&s.geometry?JSON.parse(JSON.stringify(s.geometry)):null,JSON.parse(JSON.stringify(Object.assign(s.attributes,e.properties))),null,e.properties[t])}else a=new M.u_(o?JSON.parse(JSON.stringify(o)):null,e.properties,null,e.properties[t]);n._featureLookup.set(e.id,a),i.push(a)}})),i}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}},{key:"resetInstance",value:function(){e.instance&&(e.instance=null)}}]),e}(),L=r(1413),D=r(19545),j=r(76200),R=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).resultRows=[],n}return(0,s.Z)(r)}(C.Z);(0,d._)([(0,v.Cb)()],R.prototype,"resultRows",void 0);var G=R=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.GraphQueryResult")],R),N=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).resultRowsStream=new ReadableStream,n}return(0,s.Z)(r)}(C.Z);(0,d._)([(0,v.Cb)()],N.prototype,"resultRowsStream",void 0);var F=N=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.GraphQueryResult")],N),O=r(46784),P=r(78952),A=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).name=null,n.unique=null,n.ascending=null,n.description=null,n.fieldNames=null,n}return(0,s.Z)(r)}(O.wq);(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],A.prototype,"name",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],A.prototype,"unique",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],A.prototype,"ascending",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],A.prototype,"description",void 0),(0,d._)([(0,v.Cb)({type:[String],json:{write:!0}})],A.prototype,"fieldNames",void 0);var z=A=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.FieldIndex")],A),q=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).name=null,n.alias=null,n.fieldType=null,n.geometryType=null,n.hasM=null,n.hasZ=null,n.nullable=null,n.editable=null,n.required=null,n.defaultVisibility=null,n.systemMaintained=null,n.role=null,n.defaultValue=null,n}return(0,s.Z)(r)}(O.wq);(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],q.prototype,"name",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],q.prototype,"alias",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],q.prototype,"fieldType",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],q.prototype,"geometryType",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],q.prototype,"hasM",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],q.prototype,"hasZ",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],q.prototype,"nullable",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],q.prototype,"editable",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],q.prototype,"required",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],q.prototype,"defaultVisibility",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],q.prototype,"systemMaintained",void 0),(0,d._)([(0,v.Cb)()],q.prototype,"role",void 0),(0,d._)([(0,v.Cb)({type:Object,json:{type:String,write:{writer:function(e,t){t.defaultValue=null!=e?e.toString():null}}}})],q.prototype,"defaultValue",void 0);var Q=q=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.GraphProperty")],q),U=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).name=null,n.alias=null,n.role=null,n.strict=null,n.properties=null,n.fieldIndexes=null,n}return(0,s.Z)(r)}(O.wq);(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],U.prototype,"name",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],U.prototype,"alias",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],U.prototype,"role",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],U.prototype,"strict",void 0),(0,d._)([(0,v.Cb)({type:[Q],json:{write:!0}})],U.prototype,"properties",void 0),(0,d._)([(0,v.Cb)({type:[z],json:{write:!0}})],U.prototype,"fieldIndexes",void 0);var V=U=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.GraphObjectType")],U),B=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){return(0,o.Z)(this,r),t.call(this,e)}return(0,s.Z)(r)}(V),H=B=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.EntityType")],B),Y=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).endPoints=[],n}return(0,s.Z)(r)}(V);(0,d._)([(0,v.Cb)()],Y.prototype,"endPoints",void 0);var J=Y=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.RelationshipType")],Y),W=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).timestamp=null,n.spatialReference=null,n.strict=null,n.objectIdField=null,n.globalIdField=null,n.arcgisManaged=null,n.identifierInfo=null,n.searchIndexes=null,n.entityTypes=null,n.relationshipTypes=null,n}return(0,s.Z)(r)}(O.wq);(0,d._)([(0,v.Cb)({type:Date,json:{type:Number,write:{writer:function(e,t){t.timestamp=null===e||void 0===e?void 0:e.getTime()}}}})],W.prototype,"timestamp",void 0),(0,d._)([(0,v.Cb)({type:P.Z,json:{write:!0}})],W.prototype,"spatialReference",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],W.prototype,"strict",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],W.prototype,"objectIdField",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],W.prototype,"globalIdField",void 0),(0,d._)([(0,v.Cb)()],W.prototype,"arcgisManaged",void 0),(0,d._)([(0,v.Cb)()],W.prototype,"identifierInfo",void 0),(0,d._)([(0,v.Cb)()],W.prototype,"searchIndexes",void 0),(0,d._)([(0,v.Cb)({type:[H],json:{write:!0}})],W.prototype,"entityTypes",void 0),(0,d._)([(0,v.Cb)({type:[J],json:{write:!0}})],W.prototype,"relationshipTypes",void 0);var K=W=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.DataModel")],W),$=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).capabilities=[],n.supportsSearch=!1,n.supportedQueryFormats=[],n.allowGeometryUpdates=!1,n.searchMaxRecordCount=null,n.serviceCapabilities=null,n.maxRecordCount=null,n.description="",n.copyrightText="",n.units="",n.spatialReference=null,n.currentVersion=null,n.dateFieldsTimeReference=null,n.serviceItemId="",n.supportsDocuments=!1,n.dataEditingNotSupported=!1,n.schemaEditingNotSupported=!1,n}return(0,s.Z)(r)}(O.wq);(0,d._)([(0,v.Cb)({type:[String],json:{write:!0}})],$.prototype,"capabilities",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],$.prototype,"supportsSearch",void 0),(0,d._)([(0,v.Cb)({type:[String],json:{write:!0}})],$.prototype,"supportedQueryFormats",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],$.prototype,"allowGeometryUpdates",void 0),(0,d._)([(0,v.Cb)({type:Number,json:{write:!0}})],$.prototype,"searchMaxRecordCount",void 0),(0,d._)([(0,v.Cb)({type:Object,json:{write:!0}})],$.prototype,"serviceCapabilities",void 0),(0,d._)([(0,v.Cb)({type:Number,json:{write:!0}})],$.prototype,"maxRecordCount",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],$.prototype,"description",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],$.prototype,"copyrightText",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],$.prototype,"units",void 0),(0,d._)([(0,v.Cb)({type:Object,json:{write:!0}})],$.prototype,"spatialReference",void 0),(0,d._)([(0,v.Cb)({type:Number,json:{write:!0}})],$.prototype,"currentVersion",void 0),(0,d._)([(0,v.Cb)({type:Object,json:{write:!0}})],$.prototype,"dateFieldsTimeReference",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],$.prototype,"serviceItemId",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],$.prototype,"supportsDocuments",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],$.prototype,"dataEditingNotSupported",void 0),(0,d._)([(0,v.Cb)({type:Boolean,json:{write:!0}})],$.prototype,"schemaEditingNotSupported",void 0);var X=$=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.ServiceDefinition")],$),ee=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).dataModel=null,n.serviceDefinition=null,n}return(0,s.Z)(r)}(O.wq);(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],ee.prototype,"url",void 0),(0,d._)([(0,v.Cb)({type:K,json:{write:!0}})],ee.prototype,"dataModel",void 0),(0,d._)([(0,v.Cb)({type:X,json:{write:!0}})],ee.prototype,"serviceDefinition",void 0);var te,re=ee=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.KnowledgeGraph")],ee),ne=r(65905),ie="esri/rest/knowledgeGraph/wasmInterface/",ae=null;function oe(){return se.apply(this,arguments)}function se(){return se=(0,a.Z)((0,i.Z)().mark((function e(){var t,r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=null!==(t=ae)&&void 0!==t?t:te)){e.next=3;break}return e.abrupt("return",r);case 3:return n=(0,m.Z)("wasm-simd"),e.abrupt("return",te=ue(n));case 5:case"end":return e.stop()}}),e)}))),se.apply(this,arguments)}function ue(e){return le.apply(this,arguments)}function le(){return le=(0,a.Z)((0,i.Z)().mark((function e(t){var n,a,o,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,r.e(2717).then(r.bind(r,2717)).then((function(e){return e.a}));case 3:return n=e.sent,a=n.default,e.abrupt("return",a({locateFile:function(e){return(0,ne.V)(ie+e)}}));case 6:return e.next=8,r.e(3415).then(r.bind(r,43415)).then((function(e){return e.a}));case 8:return o=e.sent,s=o.default,e.abrupt("return",s({locateFile:function(e){return(0,ne.V)(ie+e)}}));case 11:case"end":return e.stop()}}),e)}))),le.apply(this,arguments)}var pe=r(77577),de=r(585),ce=r(29909),ye=r(32238);function fe(e,t){var r=new t.ArrayValue;return r.deleteLater(),e.forEach((function(e){r.add_value(be(e,t))})),r}function he(e,t){var r=new t.ObjectValue;r.deleteLater();for(var n=0,i=Object.entries(e);n<i.length;n++){var a=(0,Z.Z)(i[n],2),o=a[0],s=a[1];r.set_key_value(o,be(s,t))}return r}function ve(e,t){if(e instanceof pe.Z)return function(e,t){var r=new t.GeometryValue;r.deleteLater(),r.geometry_type=r.geometry_type=t.esriGeometryType.esriGeometryMultipoint,r.has_z=e.hasZ,r.has_m=e.hasM;var n=[],i=[];i[0]=e.points.length;var a=0;return e.points.forEach((function(e){e.forEach((function(e){n[a]=e,a++}))})),r.coords=new Float64Array(n),r.lengths=new Uint32Array(i),r}(e,t);if(e instanceof de.Z)return function(e,t){var r=new t.GeometryValue;r.deleteLater(),r.geometry_type=t.esriGeometryType.esriGeometryPoint,r.has_z=e.hasZ,r.has_m=e.hasM;var n=[],i=[];i[0]=1,n[0]=e.x,n[1]=e.y;var a=2;return e.hasZ&&(n[a]=e.z,a++),e.hasM&&(n[a]=e.m,a++),r.coords=new Float64Array(n),r.lengths=new Uint32Array(i),r}(e,t);if(e instanceof ce.Z||e instanceof T.Z)return function(e,t){var r=new t.GeometryValue;r.deleteLater(),r.has_z=e.hasZ,r.has_m=e.hasM;var n=[],i=[],a=[];e instanceof ce.Z?(r.geometry_type=t.esriGeometryType.esriGeometryPolyline,a=e.paths):e instanceof T.Z&&(r.geometry_type=t.esriGeometryType.esriGeometryPolygon,a=e.rings);var o=0,s=0;return a.forEach((function(e){var t=0;e.forEach((function(e){t++,e.forEach((function(e){n[s]=e,s++}))})),i[o]=t,o++})),r.coords=new Float64Array(n),r.lengths=new Uint32Array(i),r}(e,t);throw new y.Z("knowledge-graph:unsupported-geometry","Only Point, Multipoint, Polyline, and Polygon geometry are supported by ArcGIS Knowledge",{geometry:e})}function me(e,t){t.input_quantization_parameters={xy_resolution:e.xyResolution,x_false_origin:e.xFalseOrigin,y_false_origin:e.yFalseOrigin,z_resolution:e.zResolution,z_false_origin:e.zFalseOrigin,m_resolution:e.mResolution,m_false_origin:e.mFalseOrigin}}function ge(e,t,r){if(!e.extent)throw new y.Z("knowledge-graph:illegal-output-quantization","The Output quantization provided to the encoder had an illegal value as part of its extent",e.extent);if(!e.quantizeMode)throw new y.Z("knowledge-graph:illegal-output-quantization","The Output quantization contained an illegal mode setting",e.quantizeMode);if(!e.tolerance)throw new y.Z("knowledge-graph:illegal-output-quantization","The Output quantization contained an illegal tolerance setting",e.quantizeMode);t.output_quantization_parameters={extent:{xmax:e.extent.xmax,ymax:e.extent.ymax,xmin:e.extent.xmin,ymin:e.extent.ymin},quantize_mode:r.esriQuantizeMode[e.quantizeMode],tolerance:e.tolerance}}function be(e,t){if(null==e)return"";if("object"!=typeof e)return e;if(e instanceof Date)return e;if(e instanceof ye.Z)return ve(e,t);if(Array.isArray(e)){var r=new t.ArrayValue;return r.deleteLater(),e.forEach((function(e){r.add_value(be(e,t))})),r}return he(e,t)}var we=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).properties=null,n}return(0,s.Z)(r)}(O.wq);(0,d._)([(0,v.Cb)({json:{write:!0}})],we.prototype,"properties",void 0);var _e=we=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.GraphObject")],we),ke=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).typeName=null,n.id=null,n}return(0,s.Z)(r)}(_e);(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],ke.prototype,"typeName",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],ke.prototype,"id",void 0);var Ze=ke=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.GraphNamedObject")],ke),Ce=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).layoutGeometry=null,n}return(0,s.Z)(r)}(Ze);(0,d._)([(0,v.Cb)({type:de.Z,json:{write:!0}})],Ce.prototype,"layoutGeometry",void 0);var xe=Ce=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.Entity")],Ce),Te=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).originId=null,n.destinationId=null,n.layoutGeometry=null,n}return(0,s.Z)(r)}(Ze);(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],Te.prototype,"originId",void 0),(0,d._)([(0,v.Cb)({type:String,json:{write:!0}})],Te.prototype,"destinationId",void 0),(0,d._)([(0,v.Cb)({type:ce.Z,json:{write:!0}})],Te.prototype,"layoutGeometry",void 0);var Ee=Te=(0,d._)([(0,g.j)("esri.rest.Relationship.Relationship")],Te);function Ie(e,t){if(!e.typeName)throw new y.Z("knowledge-graph:no-type-name","You must indicate the entity/relationship named object type to apply edits");if(e instanceof xe){var r=new t.EntityValue;r.deleteLater(),r.type_name=e.typeName;for(var n=0,i=Object.entries(e.properties);n<i.length;n++){var a=(0,Z.Z)(i[n],2),o=a[0],s=a[1];r.set_key_value(o,Se(s,t))}return e.id&&r.set_id(e.id),r}if(e instanceof Ee){var u=new t.RelationshipValue;u.deleteLater(),u.type_name=e.typeName;for(var l=0,p=Object.entries(e.properties);l<p.length;l++){var d=(0,Z.Z)(p[l],2),c=d[0],f=d[1];u.set_key_value(c,Se(f,t))}return e.id&&u.set_id(e.id),e.originId&&e.destinationId&&u.set_related_entity_ids(e.originId,e.destinationId),u}throw new y.Z("knowledge-graph:applyEdits-encoding-failure","Could not determine the type of a named graph object passed to the encoder")}function Me(e){return{xy_resolution:e.xyResolution,x_false_origin:e.xFalseOrigin,y_false_origin:e.yFalseOrigin,z_resolution:e.zResolution,z_false_origin:e.zFalseOrigin,m_resolution:e.mResolution,m_false_origin:e.mFalseOrigin}}function Se(e,t){return null==e?"":"object"!=typeof e||e instanceof Date?e:e instanceof ye.Z?ve(e,t):""}var Le=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).name=null,n.supportedCategory=null,n.analyzers=[],n.searchProperties=new Map,n}return(0,s.Z)(r)}(C.Z);(0,d._)([(0,v.Cb)()],Le.prototype,"name",void 0),(0,d._)([(0,v.Cb)()],Le.prototype,"supportedCategory",void 0),(0,d._)([(0,v.Cb)()],Le.prototype,"analyzers",void 0),(0,d._)([(0,v.Cb)()],Le.prototype,"searchProperties",void 0);var De,je,Re,Ge,Ne,Fe,Oe,Pe=Le=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.SearchIndex")],Le);function Ae(e){var t,r,n,i;return e.deleteLater(),new K({timestamp:e.timestamp,spatialReference:new P.Z(e.spatial_reference),strict:e.strict,objectIdField:e.objectid_property,globalIdField:e.globalid_property,arcgisManaged:e.arcgis_managed,identifierInfo:{identifierMappingInfo:{identifierInfoType:Oe[null===(t=e.identifier_info)||void 0===t||null===(t=t.identifier_mapping_info)||void 0===t||null===(t=t.identifier_info_type)||void 0===t?void 0:t.value],databaseNativeIdentifier:null===(r=e.identifier_info)||void 0===r||null===(r=r.identifier_mapping_info)||void 0===r?void 0:r.database_native_identifier,uniformPropertyIdentifier:{identifierPropertyName:null===(n=e.identifier_info)||void 0===n||null===(n=n.identifier_mapping_info)||void 0===n||null===(n=n.uniform_property_identifier)||void 0===n?void 0:n.identifier_property_name}},identifierGenerationInfo:{uuidMethodHint:Ge[null===(i=e.identifier_info)||void 0===i||null===(i=i.identifier_generation_info)||void 0===i||null===(i=i.uuid_method_hint)||void 0===i?void 0:i.value]}},searchIndexes:Ke(e.search_indexes),entityTypes:Be(e.entity_types),relationshipTypes:We(e.relationship_types)})}function ze(e){return e.deleteLater(),new H(Qe(e))}function qe(e){return e.deleteLater(),new z({name:e.name,unique:e.unique,ascending:e.ascending,description:e.description,fieldNames:He(e.fields)})}function Qe(e){return{name:e.name,alias:e.alias,role:De[e.role.value]?De[e.role.value]:null,strict:e.strict,properties:Ye(e.properties),fieldIndexes:Je(e.field_indexes)}}function Ue(e){return e.deleteLater(),new Q({alias:e.alias,name:e.name,fieldType:je[e.field_type.value]?je[e.field_type.value]:null,geometryType:Re[e.geometry_type.value]?Re[e.geometry_type.value]:null,hasM:e.has_m,hasZ:e.has_z,nullable:e.nullable,editable:e.editable,required:e.required,defaultVisibility:e.default_visibility,systemMaintained:e.system_maintained,role:Fe[e.role.value],defaultValue:e.default_value})}function Ve(e){e.deleteLater();for(var t=Qe(e),r=[],n=0;n<e.end_points.size();n++){var i=e.end_points.get(n);r.push({originEntityType:i.origin_entity_type,destinationEntityType:i.dest_entity_type})}return new J(Object.assign({endPoints:r},t))}function Be(e){for(var t=[],r=0;r<e.size();r++)t.push(ze(e.get(r)));return t}function He(e){for(var t=[],r=0;r<e.size();r++)t.push(e.get(r));return t}function Ye(e){for(var t=[],r=0;r<e.size();r++)t.push(Ue(e.get(r)));return t}function Je(e){for(var t=[],r=0;r<e.size();r++)t.push(qe(e.get(r)));return t}function We(e){for(var t=[],r=0;r<e.size();r++)t.push(Ve(e.get(r)));return t}function Ke(e){for(var t=[],r=0;r<e.size();r++){var n=new Pe,i=e.get(0);n.name=i.name,n.supportedCategory=Ne[i.supported_category.value];for(var a=i.analyzers.size(),o=0;o<a;o++)n.analyzers.push({name:i.analyzers.get(o).name});for(var s=0;s<i.search_properties.keys().size();s++){for(var u=i.search_properties.keys().get(s),l=i.search_properties.get(u),p=[],d=0;d<l.property_names.size();d++)p.push(l.property_names.get(d));n.searchProperties.set(u,{propertyNames:p})}t.push(n)}return t}!function(e){e[e.Regular=0]="Regular",e[e.Provenance=1]="Provenance",e[e.Document=2]="Document"}(De||(De={})),function(e){e[e.esriFieldTypeSmallInteger=0]="esriFieldTypeSmallInteger",e[e.esriFieldTypeInteger=1]="esriFieldTypeInteger",e[e.esriFieldTypeSingle=2]="esriFieldTypeSingle",e[e.esriFieldTypeDouble=3]="esriFieldTypeDouble",e[e.esriFieldTypeString=4]="esriFieldTypeString",e[e.esriFieldTypeDate=5]="esriFieldTypeDate",e[e.esriFieldTypeOID=6]="esriFieldTypeOID",e[e.esriFieldTypeGeometry=7]="esriFieldTypeGeometry",e[e.esriFieldTypeBlob=8]="esriFieldTypeBlob",e[e.esriFieldTypeRaster=9]="esriFieldTypeRaster",e[e.esriFieldTypeGUID=10]="esriFieldTypeGUID",e[e.esriFieldTypeGlobalID=11]="esriFieldTypeGlobalID",e[e.esriFieldTypeXML=12]="esriFieldTypeXML",e[e.esriFieldTypeBigInteger=13]="esriFieldTypeBigInteger"}(je||(je={})),function(e){e[e.esriGeometryNull=0]="esriGeometryNull",e[e.esriGeometryPoint=1]="esriGeometryPoint",e[e.esriGeometryMultipoint=2]="esriGeometryMultipoint",e[e.esriGeometryPolyline=3]="esriGeometryPolyline",e[e.esriGeometryPolygon=4]="esriGeometryPolygon",e[e.esriGeometryEnvelope=5]="esriGeometryEnvelope",e[e.esriGeometryAny=6]="esriGeometryAny",e[e.esriGeometryMultiPatch=7]="esriGeometryMultiPatch"}(Re||(Re={})),function(e){e[e.esriMethodHintUNSPECIFIED=0]="esriMethodHintUNSPECIFIED",e[e.esriUUIDESRI=1]="esriUUIDESRI",e[e.esriUUIDRFC4122=2]="esriUUIDRFC4122"}(Ge||(Ge={})),function(e){e[e.esriTypeUNSPECIFIED=0]="esriTypeUNSPECIFIED",e[e.esriTypeEntity=1]="esriTypeEntity",e[e.esriTypeRelationship=2]="esriTypeRelationship",e[e.esriTypeBoth=4]="esriTypeBoth"}(Ne||(Ne={})),function(e){e[e.esriGraphPropertyUNSPECIFIED=0]="esriGraphPropertyUNSPECIFIED",e[e.esriGraphPropertyRegular=1]="esriGraphPropertyRegular",e[e.esriGraphPropertyDocumentName=2]="esriGraphPropertyDocumentName",e[e.esriGraphPropertyDocumentTitle=3]="esriGraphPropertyDocumentTitle",e[e.esriGraphPropertyDocumentUrl=4]="esriGraphPropertyDocumentUrl",e[e.esriGraphPropertyDocumentText=5]="esriGraphPropertyDocumentText",e[e.esriGraphPropertyDocumentKeywords=6]="esriGraphPropertyDocumentKeywords",e[e.esriGraphPropertyDocumentContentType=7]="esriGraphPropertyDocumentContentType",e[e.esriGraphPropertyDocumentMetadata=8]="esriGraphPropertyDocumentMetadata",e[e.esriGraphPropertyDocumentFileExtension=9]="esriGraphPropertyDocumentFileExtension"}(Fe||(Fe={})),function(e){e[e.esriIdentifierInfoTypeUNSPECIFIED=0]="esriIdentifierInfoTypeUNSPECIFIED",e[e.esriIdentifierInfoTypeDatabaseNative=1]="esriIdentifierInfoTypeDatabaseNative",e[e.esriIdentifierInfoTypeUniformProperty=2]="esriIdentifierInfoTypeUniformProperty"}(Oe||(Oe={}));var $e=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){return(0,o.Z)(this,r),t.call(this,e)}return(0,s.Z)(r)}(_e),Xe=$e=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.ObjectValue")],$e),et=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).path=null,n}return(0,s.Z)(r)}(O.wq);(0,d._)([(0,v.Cb)({type:[_e],json:{write:!0}})],et.prototype,"path",void 0);var tt,rt,nt,it=et=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.Path")],et);function at(e){var t={},r=ot(e,t),n=e.lengths,i=e.coords,a="";if(e.geometry_type.value===tt.ESRI_GEOMETRY_POLYGON)a="rings";else{if(e.geometry_type.value!==tt.ESRI_GEOMETRY_POLYLINE)throw new y.Z("KnowledgeGraph:illegal-geometry-type","Illegal Geometry type for multipath conversion");a="paths"}t[a]=[];var o=0;return n.forEach((function(e){for(var n=[],s=0;s<e;s++){for(var u=[],l=0;l<r;l++)u[l]=i[o],o++;n.push(u)}t[a].push(n)})),t}function ot(e,t){var r=2;return e.has_z?(t.hasZ=e.has_z,r++):t.hasZ=!1,e.has_m?(t.hasM=e.has_m,r++):t.hasM=!1,r}!function(e){e[e.ESRI_GEOMETRY_NULL=0]="ESRI_GEOMETRY_NULL",e[e.ESRI_GEOMETRY_POINT=1]="ESRI_GEOMETRY_POINT",e[e.ESRI_GEOMETRY_MULTIPOINT=2]="ESRI_GEOMETRY_MULTIPOINT",e[e.ESRI_GEOMETRY_POLYLINE=3]="ESRI_GEOMETRY_POLYLINE",e[e.ESRI_GEOMETRY_POLYGON=4]="ESRI_GEOMETRY_POLYGON",e[e.ESRI_GEOMETRY_ENVELOPE=5]="ESRI_GEOMETRY_ENVELOPE",e[e.ESRI_GEOMETRY_ANY=6]="ESRI_GEOMETRY_ANY",e[e.ESRI_GEOMETRY_MULTI_PATCH=7]="ESRI_GEOMETRY_MULTI_PATCH"}(tt||(tt={})),function(e){e[e.OBJECT=0]="OBJECT",e[e.ENTITY=1]="ENTITY",e[e.RELATIONSHIP=2]="RELATIONSHIP",e[e.PATH=3]="PATH",e[e.ARRAY=4]="ARRAY"}(rt||(rt={})),function(e){e[e.view=0]="view",e[e.edit=1]="edit"}(nt||(nt={}));var st=f.Z.getLogger("esri.rest.knowledgeGraph.WasmToQueryResponseObjConstructors"),ut={decodedWasmObjToQueryResponseObj:function(e,t){if(null==e)return null;if("object"!=typeof e)return e;if("getDate"in e)return e;if("geometry_type"in e)switch(e.geometry_type.value){case null:return null;case tt.ESRI_GEOMETRY_POINT:return function(e){var t={},r=2;ot(e,t);var n=e.coords;return t.x=n[0],t.y=n[1],e.has_z&&(t.z=n[r],r++),e.has_m&&(t.m=n[r]),new de.Z(t)}(e);case tt.ESRI_GEOMETRY_MULTIPOINT:return function(e){var t={},r=ot(e,t),n=e.lengths,i=e.coords,a=n[0];t.points=[];for(var o=0,s=0;s<a;s++){for(var u=[],l=0;l<r;l++)u[l]=i[o],o++;t.points.push(u)}return new pe.Z(t)}(e);case tt.ESRI_GEOMETRY_POLYLINE:return function(e){return new ce.Z(at(e))}(e);case tt.ESRI_GEOMETRY_POLYGON:return function(e){return new T.Z(at(e))}(e);case tt.ESRI_GEOMETRY_ENVELOPE:case tt.ESRI_GEOMETRY_MULTI_PATCH:return st.warnOnce("Envelope and Multipatch are not supported on knowledge entities, but one of those geometry types was detected. Result interpreted as null"),null;case tt.ESRI_GEOMETRY_NULL:case tt.ESRI_GEOMETRY_ANY:default:return st.warnOnce("Unknown or blank geometry type returned - Result interpreted as null"),null}else{if(!("object_value_type"in e))return st.warnOnce("A decoded value came back of a type that is not supported. Result interpreted as null"),null;switch(e.object_value_type.value){case rt.OBJECT:return function(e,t){return new Xe(dt(e,t))}(e,t);case rt.ENTITY:return pt(e,t);case rt.RELATIONSHIP:return ct(e,t);case rt.PATH:return function(e,t){for(var r=e.entity_count(),n=e.relationship_count(),i=[],a=0;a<r;a++)i.push(pt(e.get_entity_at(a),t)),a<n&&i.push(ct(e.get_relationship_at(a),t));return new it({path:i})}(e,t);case rt.ARRAY:return function(e,t){for(var r=[],n=e.count(),i=0;i<n;i++){var a=e.get_value_at(i);r.push(lt(a,t))}return r}(e,t);default:return st.warnOnce("Unknown graph object type detected!  Result interpreted as null"),null}}}};function lt(e,t){return ut.decodedWasmObjToQueryResponseObj(e,t)}function pt(e,t){var r=e.type_name,n=dt(e,t),i=e.get_id();return new xe(Object.assign({typeName:r,id:i},n))}function dt(e,t){for(var r={},n=e.key_count(),i=0;i<n;i++)r[e.get_key_at(i)]=lt(e.get_value_at(i),t);return{properties:r}}function ct(e,t){var r=e.type_name,n=dt(e,t);return new Ee(Object.assign({typeName:r,id:e.get_id(),originId:e.get_origin_entity_id(),destinationId:e.get_destination_entity_id()},n))}var yt=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).hasError=null,n.error=null,n.editResults=[],n}return(0,s.Z)(r)}(C.Z);(0,d._)([(0,v.Cb)()],yt.prototype,"hasError",void 0),(0,d._)([(0,v.Cb)()],yt.prototype,"error",void 0),(0,d._)([(0,v.Cb)()],yt.prototype,"editResults",void 0);var ft=yt=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.GraphApplyEdits")],yt);function ht(e){var t=new ft;t.hasError=e.has_error(),t.hasError&&(t.error={errorCode:e.error.error_code,errorMessage:e.error.error_message});for(var r=e.get_edit_results_count(),n=0;n<r;n++){for(var i=e.get_edit_results_at(n),a=e.get_edit_results_type_name_at(n),o=[],s=[],u=[],l=i.get_add_results_count(),p=i.get_update_results_count(),d=i.get_delete_results_count(),c=0;c<l;c++){var y=i.get_add_result_at(c);o.push({id:y.id,error:{errorCode:y.error.error_code,errorMessage:y.error.error_message}})}for(var f=0;f<p;f++){var h=i.get_update_result_at(f);s.push({id:h.id,error:{errorCode:h.error.error_code,errorMessage:h.error.error_message}})}for(var v=0;v<d;v++){var m=i.get_delete_result_at(v);u.push({id:m.id,error:{errorCode:m.error.error_code,errorMessage:m.error.error_message}})}t.editResults.push({typeName:a,adds:o,updates:s,deletes:u})}return t}var vt={fetchKnowledgeGraph:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new re({url:t}),(n=[]).push(wt(r)),n.push(kt(r)),e.next=5,Promise.all(n);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),refreshDataModel:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qt(t);case 2:t.dataModel=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),refreshServiceDefinition:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r,n,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.default)(t.url,{query:{f:"json"}});case 2:return a=e.sent.data,e.abrupt("return",(a.capabilities=null===a||void 0===a||null===(r=a.capabilities)||void 0===r?void 0:r.split(","),a.supportedQueryFormats=null===a||void 0===a||null===(n=a.supportedQueryFormats)||void 0===n?void 0:n.split(","),t.serviceDefinition=new X(a),t.serviceDefinition));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),executeQueryStreaming:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r,n){var a,o,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(t.url,"/graph/query"),e.next=3,Tt(t);case 3:return e.next=5,Nt(a,n);case 5:return o=e.sent,e.next=8,Dt(r,t);case 8:return o.data.body=e.sent,e.next=11,Ct(o.data.url,o.data);case 11:if(s=e.sent,!t.dataModel){e.next=19;break}return e.t0=F,e.next=16,zt(s,t.dataModel);case 16:return e.t1=e.sent,e.t2={resultRowsStream:e.t1},e.abrupt("return",new e.t0(e.t2));case 19:throw new y.Z("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model");case 20:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),executeApplyEdits:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r,n){var a,o,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(a=t.serviceDefinition)||void 0===a||!a.dataEditingNotSupported){e.next=2;break}throw new y.Z("knowledge-graph:data-editing-not-supported","The Knowledge Graph Service definition indicated that data editing is not supported");case 2:return o="".concat(t.url,"/graph/applyEdits"),e.next=5,Tt(t);case 5:return e.next=7,Nt(o,n);case 7:return s=e.sent,e.next=10,St(r,t);case 10:return s.data.body=e.sent,e.t0=Ot,e.next=14,Ct(s.data.url,s.data);case 14:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 16:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),executeQuery:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r,n){var a,o,s,u,l,p;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="".concat(t.url,"/graph/query"),e.next=3,(0,j.default)(o,{responseType:"array-buffer",query:(0,L.Z)({f:"pbf",openCypherQuery:r.openCypherQuery},null===n||void 0===n?void 0:n.query),signal:null===n||void 0===n?void 0:n.signal,timeout:null===n||void 0===n?void 0:n.timeout});case 3:if(s=e.sent,u=null===(a=s.getHeader)||void 0===a?void 0:a.call(s,"content-type"),l=s.data,null===u||void 0===u||!u.includes("application/x-protobuf")){e.next=14;break}return e.next=9,oe();case 9:if(e.t0=e.sent.GraphQueryDecoder,(p=new e.t0).deleteLater(),!t.dataModel){e.next=13;break}return e.abrupt("return",new G({resultRows:At(p,l,t.dataModel)}));case 13:throw new y.Z("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model");case 14:throw new y.Z("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:u,data:s.data});case 15:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),executeSearch:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r,n){var a,o,s,u,l,p,d;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.typeCategoryFilter,s="".concat(t.url,"/graph/search"),e.next=4,(0,j.default)(s,{responseType:"array-buffer",query:(0,L.Z)({f:"pbf",searchQuery:'"'.concat(r.searchQuery,'"'),typeCategoryFilter:o},null===n||void 0===n?void 0:n.query),signal:null===n||void 0===n?void 0:n.signal,timeout:null===n||void 0===n?void 0:n.timeout});case 4:if(u=e.sent,l=null===(a=u.getHeader)||void 0===a?void 0:a.call(u,"content-type"),p=u.data,null===l||void 0===l||!l.includes("application/x-protobuf")){e.next=15;break}return e.next=10,oe();case 10:if(e.t0=e.sent.GraphQueryDecoder,(d=new e.t0).deleteLater(),!t.dataModel){e.next=14;break}return e.abrupt("return",new G({resultRows:At(d,p,t.dataModel)}));case 14:throw new y.Z("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model");case 15:throw new y.Z("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:l,data:u.data});case 16:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),executeSearchStreaming:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r,n){var a,o,s;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(t.url,"/graph/search"),e.next=3,Tt(t);case 3:return e.next=5,Nt(a,n);case 5:return o=e.sent,e.next=8,Rt(r);case 8:return o.data.body=e.sent,e.next=11,Ct(o.data.url,o.data);case 11:if(s=e.sent,!t.dataModel){e.next=19;break}return e.t0=F,e.next=16,zt(s,t.dataModel);case 16:return e.t1=e.sent,e.t2={resultRowsStream:e.t1},e.abrupt("return",new e.t0(e.t2));case 19:throw new y.Z("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model");case 20:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),_fetchWrapper:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(t,r));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()};function mt(e,t,r){return gt.apply(this,arguments)}function gt(){return gt=(0,a.Z)((0,i.Z)().mark((function e(t,r,n){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vt.executeQueryStreaming(t,r,n));case 1:case"end":return e.stop()}}),e)}))),gt.apply(this,arguments)}function bt(){return bt=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vt.fetchKnowledgeGraph(t));case 1:case"end":return e.stop()}}),e)}))),bt.apply(this,arguments)}function wt(e){return _t.apply(this,arguments)}function _t(){return _t=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vt.refreshDataModel(t));case 1:case"end":return e.stop()}}),e)}))),_t.apply(this,arguments)}function kt(e){return Zt.apply(this,arguments)}function Zt(){return Zt=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vt.refreshServiceDefinition(t));case 1:case"end":return e.stop()}}),e)}))),Zt.apply(this,arguments)}function Ct(e,t){return xt.apply(this,arguments)}function xt(){return xt=(0,a.Z)((0,i.Z)().mark((function e(t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",vt._fetchWrapper(t,r));case 1:case"end":return e.stop()}}),e)}))),xt.apply(this,arguments)}function Tt(e){return Et.apply(this,arguments)}function Et(){return Et=(0,a.Z)((0,i.Z)().mark((function e(t){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null===D.id||void 0===D.id?void 0:D.id.findCredential(t.url),e.t0=r,e.t0){e.next=10;break}if(!t.dataModel){e.next=8;break}return e.next=6,Qt(t);case 6:e.next=10;break;case 8:return e.next=10,wt(t);case 10:case"end":return e.stop()}}),e)}))),Et.apply(this,arguments)}function It(e,t,r){if(0!==e.error_code)throw new y.Z(t,r,{errorCode:e.error_code,errorMessage:e.error_message})}function Mt(e,t,r,n){null==t?r.set_param_key_value(e,""):"object"!=typeof t||t instanceof Date?r.set_param_key_value(e,t):t instanceof ye.Z?r.set_param_key_value(e,ve(t,n)):t instanceof Array?r.set_param_key_value(e,fe(t,n)):r.set_param_key_value(e,he(t,n))}function St(e,t){return Lt.apply(this,arguments)}function Lt(){return Lt=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n,a,o,s,u,l,p,d,c,f,h,v,m;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r.dataModel,e.t0){e.next=4;break}return e.next=4,wt(r);case 4:if(r.dataModel){e.next=6;break}throw new y.Z("knowledge-graph:data-model-undefined","Encoding could not proceed because a data model was not provided and it could not be determined from the service");case 6:return e.next=8,oe();case 8:s=e.sent,u=!(null===(n=t.options)||void 0===n||!n.cascadeDelete),(l=new s.GraphApplyEditsEncoder(s.SpatialReferenceUtil.WGS84(),null!==(a=t.options)&&void 0!==a&&a.inputQuantizationParameters?Me(null===(o=t.options)||void 0===o?void 0:o.inputQuantizationParameters):s.InputQuantizationUtil.WGS84_lossless())).deleteLater(),l.cascade_delete=u,e.prev=12,null!==(p=t.entityAdds)&&void 0!==p&&p.forEach((function(e){It(l.add_entity(Ie(e,s)),"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits - an entity failed to be added to the encoder")})),null!==(d=t.relationshipAdds)&&void 0!==d&&d.forEach((function(e){if(!e.originId||!e.destinationId)throw new y.Z("knowledge-graph:relationship-origin-destination-missing","When adding a new relationship, you must provide both an origin and destination id on the appropriate class property");It(l.add_relationship(Ie(e,s)),"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits - a relationship failed to be added to the encoder")})),null!==(c=t.entityUpdates)&&void 0!==c&&c.forEach((function(e){if(!e.id)throw new y.Z("knowledge-graph:entity-id-missing","When updating an entity or relationship, you must specify the id on the class level property");It(l.update_entity(Ie(e,s)),"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits - an entity failed to be added to the encoder")})),null!==(f=t.relationshipUpdates)&&void 0!==f&&f.forEach((function(e){if(!e.id)throw new y.Z("knowledge-graph:relationship-id-missing","When updating an entity or relationship, you must specify the id on the class level property");It(l.update_relationship(Ie(e,s)),"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits - a relationship failed to be added to the encoder")})),null!==(h=t.entityDeletes)&&void 0!==h&&h.forEach((function(e){var t;if(!e.typeName)throw new y.Z("knowledge-graph:no-type-name","You must indicate the entity/relationship named object type to apply edits - delete");var r=l.make_delete_helper(e.typeName,!0);r.deleteLater(),null===(t=e.ids)||void 0===t||t.forEach((function(e){r.delete_by_id(e)}))})),null!==(v=t.relationshipDeletes)&&void 0!==v&&v.forEach((function(e){var t;if(!e.typeName)throw new y.Z("knowledge-graph:no-type-name","You must indicate the entity/relationship named object type to apply edits - delete");var r=l.make_delete_helper(e.typeName,!1);null===(t=e.ids)||void 0===t||t.forEach((function(e){r.delete_by_id(e)}))})),l.encode(),e.next=19;break;case 16:throw e.prev=16,e.t1=e.catch(12),new y.Z("knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits failed",{error:e.t1});case 19:return m=l.get_encoding_result(),e.abrupt("return",(It(m.error,"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits failed"),m.get_byte_buffer()));case 21:case"end":return e.stop()}}),e,null,[[12,16]])}))),Lt.apply(this,arguments)}function Dt(e,t){return jt.apply(this,arguments)}function jt(){return jt=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n,a,o,s,u,l,p,d,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe();case 2:if(n=e.sent,(a=new n.GraphQueryRequestEncoder).deleteLater(),a.output_spatial_reference=n.SpatialReferenceUtil.WGS84(),a.open_cypher_query=t.openCypherQuery,t.bindParameters)for(o=0,s=Object.entries(t.bindParameters);o<s.length;o++)u=(0,Z.Z)(s[o],2),l=u[0],p=u[1],Mt(l,p,a,n);if(!t.bindGeometryQuantizationParameters){e.next=9;break}me(t.bindGeometryQuantizationParameters,a),e.next=16;break;case 9:if(e.t0=r.dataModel,e.t0){e.next=13;break}return e.next=13,wt(r);case 13:if(4326===(null===(d=r.dataModel)||void 0===d||null===(d=d.spatialReference)||void 0===d?void 0:d.wkid)){e.next=15;break}throw new y.Z("knowledge-graph:SR-quantization-mismatch","If the DataModel indicates a coordinate system other than WGS84, inputQuantizationParameters must be provided to the query encoder");case 15:a.input_quantization_parameters=n.InputQuantizationUtil.WGS84_lossless();case 16:t.outputQuantizationParameters&&ge(t.outputQuantizationParameters,a,n),e.prev=17,a.encode(),e.next=24;break;case 21:throw e.prev=21,e.t1=e.catch(17),new y.Z("knowledge-graph:query-encoding-failed","Attempting to encode the query failed",{error:e.t1});case 24:if(0===(c=a.get_encoding_result()).error.error_code){e.next=27;break}throw new y.Z("knowledge-graph:query-encoding-failed","Attempting to encode the query failed",{errorCode:c.error.error_code,errorMessage:c.error.error_message});case 27:return e.abrupt("return",c.get_byte_buffer());case 28:case"end":return e.stop()}}),e,null,[[17,21]])}))),jt.apply(this,arguments)}function Rt(e){return Gt.apply(this,arguments)}function Gt(){return Gt=(0,a.Z)((0,i.Z)().mark((function e(t){var r,n,a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe();case 2:if(n=e.sent,(a=new n.GraphSearchRequestEncoder).deleteLater(),a.search_query=t.searchQuery,a.type_category_filter=n.esriNamedTypeCategory[t.typeCategoryFilter],!0===t.returnSearchContext&&(a.return_search_context=t.returnSearchContext),null!=t.start&&t.start>0&&(a.start_index=t.start),null!=t.num&&(a.max_num_results=t.num),!(null!=t.idsFilter&&Array.isArray(t.idsFilter)&&t.idsFilter.length>0)){e.next=12;break}e.prev=5,a.set_ids_filter(fe(t.idsFilter,n)),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(5),new y.Z("knowledge-graph:ids-format-error","Attempting to set ids filter failed.  This is usually caused by an incorrectly formatted UUID string",{error:e.t0});case 12:null===(r=t.namedTypesFilter)||void 0===r||r.forEach((function(e){a.add_named_type_filter(e)})),e.prev=13,a.encode(),e.next=20;break;case 17:throw e.prev=17,e.t1=e.catch(13),new y.Z("knowledge-graph:search-encoding-failed","Attempting to encode the search failed",{error:e.t1});case 20:if(0===(o=a.get_encoding_result()).error.error_code){e.next=23;break}throw new y.Z("knowledge-graph:search-encoding-failed","Attempting to encode the search failed",{errorCode:o.error.error_code,errorMessage:o.error.error_message});case 23:return e.abrupt("return",o.get_byte_buffer());case 24:case"end":return e.stop()}}),e,null,[[5,9],[13,17]])}))),Gt.apply(this,arguments)}function Nt(e,t){return Ft.apply(this,arguments)}function Ft(){return Ft=(0,a.Z)((0,i.Z)().mark((function e(t,r){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,j.default)(t,{responseType:"native-request-init",method:"post",query:(0,L.Z)({f:"pbf"},null===r||void 0===r?void 0:r.query),body:"x",headers:{"Content-Type":"application/octet-stream"},signal:null===r||void 0===r?void 0:r.signal,timeout:null===r||void 0===r?void 0:r.timeout}));case 1:case"end":return e.stop()}}),e)}))),Ft.apply(this,arguments)}function Ot(e){return Pt.apply(this,arguments)}function Pt(){return Pt=(0,a.Z)((0,i.Z)().mark((function e(t){var r,n,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=t.headers.get("content-type"))||void 0===r||!r.includes("application/x-protobuf")){e.next=10;break}return e.next=4,t.arrayBuffer();case 4:return n=e.sent,e.next=7,oe();case 7:return e.t0=e.sent.GraphApplyEditsDecoder,a=new e.t0,e.abrupt("return",(a.deleteLater(),a.decode(new Uint8Array(n)),ht(a)));case 10:throw new y.Z("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:r,data:t.text()});case 11:case"end":return e.stop()}}),e)}))),Pt.apply(this,arguments)}function At(e,t,r){e.push_buffer(new Uint8Array(t));for(var n=[],i=0;e.next_row();){i||(i=e.get_header_keys().size());for(var a=new Array(i),o=0;o<i;o++){var s=e.get_value(o);a[o]=lt(s,r)}n.push(a)}if(e.has_error())throw new y.Z("knowledge-graph:stream-decoding-error","One or more result rows were not successfully decoded",{errorCode:e.error.error_code,errorMessage:e.error.error_message});return n}function zt(e,t){return qt.apply(this,arguments)}function qt(){return qt=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n,o,s,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.headers.get("content-type"),t.headers.get("content-length")&&f.Z.getLogger("esri.rest.knowledgeGraph.knowledgeGraphService").warnOnce("Found `Content-Length` header when expecting a streaming HTTP response! Please investigate whether all intermediate HTTP proxies and/or load balancers are configured such that they don't forcefully buffer the entire response before returning it to the client. A valid HTTP streaming response should use Chunked Transfer Encoding and not have a Content Length defined."),null===n||void 0===n||!n.includes("application/x-protobuf")){e.next=8;break}return s=null===(o=t.body)||void 0===o?void 0:o.getReader(),e.next=5,oe();case 5:return e.t0=e.sent.GraphQueryDecoder,u=new e.t0,e.abrupt("return",(u.deleteLater(),new ReadableStream({start:function(e){return(0,a.Z)((0,i.Z)().mark((function t(){var n;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=function(){return null===s||void 0===s?void 0:s.read().then((function(t){var i,a=t.done,o=t.value;if(!a){var l=At(u,o,r);return l.length>0&&e.enqueue(l),n()}if(u.has_error()&&(i=new y.Z("knowledge-graph:stream-decoding-error","One or more result rows were not successfully decoded",{errorCode:u.error.error_code,errorMessage:u.error.error_message})),s.releaseLock(),i)throw e.error(i),i;e.close()}))},t.prev=1,t.abrupt("return",n());case 5:t.prev=5,t.t0=t.catch(1),null!==s&&void 0!==s&&s.releaseLock(),e.error(new y.Z("knowledge-graph:stream-decoding-error","The server returned a valid response, but there was an error decoding the response stream",{error:t.t0})),e.close();case 8:case"end":return t.stop()}}),t,null,[[1,5]])})))()}})));case 8:throw new y.Z("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:n,data:t.text()});case 9:case"end":return e.stop()}}),e)}))),qt.apply(this,arguments)}function Qt(e){return Ut.apply(this,arguments)}function Ut(){return Ut=(0,a.Z)((0,i.Z)().mark((function e(t){var r,n,a,o,s,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(t.url,"/dataModel/queryDataModel"),e.next=3,(0,j.default)(n,{responseType:"array-buffer",query:{f:"pbf"}});case 3:if(a=e.sent,o=null===(r=a.getHeader)||void 0===r?void 0:r.call(a,"content-type"),s=a.data,null===o||void 0===o||!o.includes("application/x-protobuf")){e.next=13;break}return e.next=9,oe();case 9:if(u=e.sent.decode_data_model_from_protocol_buffer(new Uint8Array(s))){e.next=12;break}throw new y.Z("knowledge-graph:data-model-decode-failure","The server responded to the data model query, but the response failed to be decoded.  This typically occurs when the Knowledge JS API (4.26 or later) is used with an unsupported backend (11.0 or earlier)");case 12:return e.abrupt("return",Ae(u));case 13:throw new y.Z("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:o,data:a.data});case 14:case"end":return e.stop()}}),e)}))),Ut.apply(this,arguments)}var Vt=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).openCypherQuery="",n}return(0,s.Z)(r)}(C.Z);(0,d._)([(0,v.Cb)()],Vt.prototype,"openCypherQuery",void 0);var Bt=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).bindParameters=null,n.bindGeometryQuantizationParameters=null,n.outputQuantizationParameters=null,n}return(0,s.Z)(r)}(Vt=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.GraphQuery")],Vt));(0,d._)([(0,v.Cb)()],Bt.prototype,"bindParameters",void 0),(0,d._)([(0,v.Cb)()],Bt.prototype,"bindGeometryQuantizationParameters",void 0),(0,d._)([(0,v.Cb)()],Bt.prototype,"outputQuantizationParameters",void 0);var Ht=Bt=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.GraphQueryStreaming")],Bt),Yt=r(86638),Jt="ESRI__ID",Wt="ESRI__ORIGIN_ID",Kt="ESRI__DESTINATION_ID",$t="ESRI__LAYOUT_GEOMETRY",Xt=12,er=f.Z.getLogger("esri.rest.knowledgeGraph.knowledgeGraphLayer.KnowledgeGraphLayerDataManager"),tr=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n,i,a,s;(0,o.Z)(this,r),(s=t.call(this,e)).inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},s.entityTypeNames=new Set,s.relationshipTypeNames=new Set,s.geographicLookup=new Map,s.sublayerCaches=new Map,s._processingCacheUpdatesLookup=new Map,s._memberIdTypeLookup=new Map;var u=new Map;return null!==(n=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==n&&n.forEach((function(t){var r,n;t.name&&(u.set(t.name,"entity"),s._processingCacheUpdatesLookup.set(t.name,[]),e.inclusionModeDefinition&&!(null!==(r=e.inclusionModeDefinition)&&void 0!==r&&r.generateAllSublayers)||s.entityTypeNames.add(t.name),null===(n=t.properties)||void 0===n||n.forEach((function(e){var r;e.geometryType&&"esriGeometryNull"!==e.geometryType&&s.geographicLookup.set(t.name,{name:null!==(r=e.name)&&void 0!==r?r:"",geometryType:e.geometryType})})))})),null!==(i=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==i&&i.forEach((function(t){var r,n;t.name&&(u.set(t.name,"relationship"),s._processingCacheUpdatesLookup.set(t.name,[]),e.inclusionModeDefinition&&!(null!==(r=e.inclusionModeDefinition)&&void 0!==r&&r.generateAllSublayers)||s.relationshipTypeNames.add(t.name),null===(n=t.properties)||void 0===n||n.forEach((function(e){var r;e.geometryType&&"esriGeometryNull"!==e.geometryType&&s.geographicLookup.set(t.name,{name:null!==(r=e.name)&&void 0!==r?r:"",geometryType:e.geometryType})})))})),null===(a=e.inclusionModeDefinition)||void 0===a||a.namedTypeDefinitions.forEach((function(t,r){var n;if("entity"===u.get(r))s.entityTypeNames.add(r);else{var i;if("relationship"!==u.get(r))return er.warn("A named type, ".concat(r,", was in the inclusion list that wasn't in the data model and will be removed")),void(null===(i=e.inclusionModeDefinition)||void 0===i||i.namedTypeDefinitions.delete(r));s.relationshipTypeNames.add(r)}var a=new Map;null!==(n=t.members)&&void 0!==n&&n.forEach((function(e){s._memberIdTypeLookup.set(e.id,r);var t=s.getById(e.id);t&&a.set(e.id,t)})),s.sublayerCaches.set(r,a)})),s}return(0,s.Z)(r,[{key:"addToLayerInclusionSet",value:function(e){var t=this;e.forEach((function(e){var r=e.typeName,n=e.id;if(!t.inclusionModeDefinition)throw new y.Z("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(t.inclusionModeDefinition.namedTypeDefinitions.has(r)){if(t.inclusionModeDefinition.namedTypeDefinitions.has(r)){var i=t.inclusionModeDefinition.namedTypeDefinitions.get(r);if(i.useAllData)throw new y.Z("knowledge-graph:layer-data-manager","You cannot add members to an exclusion list for a sublayer where the sublayer is set to always retrieve its entire data set");i.members||(i.members=new Map),i.members.set(n,{id:n}),t._memberIdTypeLookup.set(n,r)}}else{var a=new Map;a.set(n,{id:n}),t.inclusionModeDefinition.namedTypeDefinitions.set(r,{useAllData:!1,members:a}),t._memberIdTypeLookup.set(n,r)}}))}},{key:"getById",value:function(e){return S.getInstance().readFromStoreById(e)}},{key:"getData",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r,n){var a,o,s,u,l,p,d,c,y,f,h,v,m;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.objectType.name&&null!==(a=this.inclusionModeDefinition)&&void 0!==a&&a.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0)||this.inclusionModeDefinition.namedTypeDefinitions.has(r.objectType.name)){e.next=2;break}return e.abrupt("return",[]);case 2:if(o=t||new Yt.Z({where:"1=1",outFields:["*"]}),"link-chart"!==r.parentCompositeLayer.type){e.next=12;break}if(p=r.parentCompositeLayer,d=this._processingCacheUpdatesLookup.get(null!==(s=r.objectType.name)&&void 0!==s?s:""),c=o.outFields,y=o.geometry,f="",h="",y&&y.extent&&(f=(0,b.fC)(y.extent.ymin,y.extent.xmin,Xt),h=(0,b.fC)(y.extent.ymax,y.extent.xmax,Xt)),e.t0=c&&1===c.length&&c[0]===Jt&&"1=1"===o.where,e.t0){e.next=10;break}return e.next=10,Promise.all(null!==d&&void 0!==d?d:[]);case 10:return v=this.sublayerCaches.has(null!==(u=r.objectType.name)&&void 0!==u?u:"")?Array.from(null===(l=this.sublayerCaches.get(r.objectType.name))||void 0===l?void 0:l.values()):[],m=[],e.abrupt("return",(v.forEach((function(e){if(e.geometry=p.linkChartDiagramLookup.get(e.attributes[r.objectIdField]),e.attributes[$t]=e.geometry,f&&h){var t=p.linkChartGeohashLookup.get(e.attributes[r.objectIdField]);t?t>=f&&t<=h&&m.push(e):m.push(e)}else m.push(e)})),m));case 12:return e.abrupt("return",this.retrieveDataFromService(o,r,n));case 13:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getConnectedRecordIds",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r,n,o,s=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],n=[],o=new Map,t.forEach((function(e){if(s._memberIdTypeLookup.has(e)){var t,r=s._memberIdTypeLookup.get(e);if(!s.entityTypeNames.has(r))return;o.has(r)?null===(t=o.get(r))||void 0===t||t.push(e):o.set(r,[e])}})),o.forEach((function(e,t){var o="MATCH (n:".concat(t,")-[r]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]"),u=new Promise((function(t){(0,a.Z)((0,i.Z)().mark((function t(){var n,a,u,l,p,d;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,mt(s.knowledgeGraph,new Ht({openCypherQuery:o,bindParameters:{ids:e}}));case 2:n=t.sent.resultRowsStream.getReader(),t.prev=3;case 4:return t.next=6,n.read();case 6:if(a=t.sent,u=a.done,l=a.value,!u){t.next=11;break}return t.abrupt("break",14);case 11:for(p=0;p<l.length;p++)d=l[p],r.push({id:d[0],typeName:d[1]}),r.push({id:d[2],typeName:d[3]});case 12:t.next=4;break;case 14:t.next=21;break;case 16:if(t.prev=16,t.t0=t.catch(3),"AbortError"===t.t0.name){t.next=20;break}throw t.t0;case 20:er.info("Request aborted as expected");case 21:case"end":return t.stop()}}),t,null,[[3,16]])})))().then((function(){t()}))}));n.push(u)})),e.next=5,Promise.all(n);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"refreshCacheContent",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r,o){var s,u,l,p,d,c,f,h,v,m,g,b,w,_=this,k=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=!(k.length>3&&void 0!==k[3])||k[3],f=S.getInstance(),h=[],v=new Map,m=new Map,null!==(s=this.knowledgeGraph.dataModel.entityTypes)&&void 0!==s&&s.forEach((function(e){e.name&&m.set(e.name,e)})),null!==(u=this.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==u&&u.forEach((function(e){e.name&&m.set(e.name,e)})),t||this.inclusionModeDefinition?t?t.forEach((function(e){if(_._memberIdTypeLookup.has(e)){var t,r=_._memberIdTypeLookup.get(e);v.has(r)?null===(t=v.get(r))||void 0===t||t.push(e):v.set(r,[e])}})):null===(l=this.inclusionModeDefinition)||void 0===l||null===(l=l.namedTypeDefinitions)||void 0===l||l.forEach((function(e,t){e.useAllData?v.set(t,null):e.members&&e.members.forEach((function(e){var r;v.has(t)&&null!==v.get(t)?null===(r=v.get(t))||void 0===r||r.push(e.id):v.set(t,[e.id])}))})):(null!==(p=this.knowledgeGraph.dataModel.entityTypes)&&void 0!==p&&p.forEach((function(e){e.name&&v.set(e.name,null)})),null===(d=this.knowledgeGraph.dataModel.entityTypes)||void 0===d||d.forEach((function(e){e.name&&v.set(e.name,null)}))),g=(0,n.Z)(v),e.prev=4,w=(0,i.Z)().mark((function e(){var t,n,s,u,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,Z.Z)(b.value,2),s=n[0],u=n[1],l=new Promise((function(e){var t=function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,n,a,l,p,d,h,v,g,b;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new Set,a=[],p="",d=!1,r||null!==(t=m.get(s))&&void 0!==t&&null!==(t=t.properties)&&void 0!==t&&t.forEach((function(e){e.name&&n.add(e.name)})),o&&_.geographicLookup.has(s)&&(v=null===(h=_.geographicLookup.get(s))||void 0===h?void 0:h.name)&&n.add(v),!_.entityTypeNames.has(s)){e.next=7;break}p="MATCH (n:".concat(s,") ").concat(u?"WHERE id(n) IN $ids ":"","return ID(n)"),n.forEach((function(e){p+=", n.".concat(e),a.push(e)})),e.next=10;break;case 7:if(_.relationshipTypeNames.has(s)){e.next=9;break}throw new y.Z("knowledge-graph:layer-data-manager","The graph type of ".concat(s," could not be determined. Was this type set in the KG data model and inclusion definition?"));case 9:d=!0,p="MATCH ()-[n:".concat(s,"]->() ").concat(u?"WHERE id(n) IN $ids ":"","return ID(n), id(startNode(n)), id(endNode(n))"),n.forEach((function(e){p+=", n.".concat(e),a.push(e)}));case 10:return l=new Ht(u?{openCypherQuery:p,bindParameters:{ids:u}}:{openCypherQuery:p}),e.next=13,mt(_.knowledgeGraph,l);case 13:g=e.sent.resultRowsStream.getReader(),b=(0,i.Z)().mark((function e(){var t,r,n,o,u,l,p,y,h,v,m,b,w,k,Z;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.read();case 2:if(u=e.sent,l=u.done,p=u.value,!l){e.next=7;break}return e.abrupt("return",1);case 7:for(y=[],h=0;h<p.length;h++){for(v=p[h],b=0,(w={properties:{}}).id=v[m=0],m++,b++,d&&(w.originId=v[m],m++,b++,w.destinationId=v[m],m++,b++);m<v.length;m++)w.properties[a[m-b]]=v[m];y.push(w)}k=f.writeToStore(y,Jt,null===(t=_.geographicLookup.get(s))||void 0===t?void 0:t.name),_.sublayerCaches.has(s)||_.sublayerCaches.set(s,new Map),c&&!(null!==(r=_.inclusionModeDefinition)&&void 0!==r&&r.namedTypeDefinitions.has(s))&&null!==(n=_.inclusionModeDefinition)&&void 0!==n&&n.namedTypeDefinitions.set(s,{useAllData:!1,members:new Map}),c&&(null===(o=_.inclusionModeDefinition)||void 0===o||!o.namedTypeDefinitions.get(s).members)&&(_.inclusionModeDefinition.namedTypeDefinitions.get(s).members=new Map),Z=_.sublayerCaches.get(s),k.forEach((function(e){var t,r;null!==Z&&void 0!==Z&&Z.set(e.attributes[Jt],e),c&&(null===(t=_.inclusionModeDefinition)||void 0===t||!t.namedTypeDefinitions.get(s).members.has(e.attributes[Jt]))&&(null!==(r=_.inclusionModeDefinition)&&void 0!==r&&r.namedTypeDefinitions.get(s).members.set(e.attributes[Jt],{id:e.attributes[Jt]}),_._memberIdTypeLookup.set(e.attributes[Jt],s))}));case 13:case"end":return e.stop()}}),e)}));case 15:return e.delegateYield(b(),"t0",16);case 16:if(!e.t0){e.next=18;break}return e.abrupt("break",20);case 18:e.next=15;break;case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t().then((function(){e(null)}))})),h.push(l),null===(t=_._processingCacheUpdatesLookup.get(s))||void 0===t||t.push(l);case 3:case"end":return e.stop()}}),e)})),g.s();case 7:if((b=g.n()).done){e.next=11;break}return e.delegateYield(w(),"t0",9);case 9:e.next=7;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(4),g.e(e.t1);case 16:return e.prev=16,g.f(),e.finish(16);case 19:return e.next=21,Promise.all(h);case 21:case"end":return e.stop()}}),e,this,[[4,13,16,19]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"removeFromLayer",value:function(e){var t=this,r=new Set;e.forEach((function(e){var n;t._memberIdTypeLookup.get(e)&&r.add(t._memberIdTypeLookup.get(e)),t._memberIdTypeLookup.delete(e),null===(n=t.inclusionModeDefinition)||void 0===n||n.namedTypeDefinitions.forEach((function(t){var r;(null===(r=t.members)||void 0===r?void 0:r.has(e))&&t.members.delete(e)}))})),r.forEach((function(r){var n;null===(n=t.sublayerCaches.get(r))||void 0===n||n.forEach((function(n,i){var a;e.includes(i)&&(null===(a=t.sublayerCaches.get(r))||void 0===a||a.delete(i))}))}))}},{key:"retrieveDataFromService",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r,n){var a,o,s,u,l,p,d,c,y,f,h,v,m,g,b,w,_,k,Z,C,M,L,D,j,R,G,N,F,O,P,A,z,q,Q,U,V,B,H,Y,J,W,K;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=S.getInstance(),l=new Set,p=[],c="",y=[],f="relationship"===r.graphType,h=null===(a=this.inclusionModeDefinition)||void 0===a||null===(a=a.namedTypeDefinitions)||void 0===a||null===(a=a.get(r.objectType.name))||void 0===a?void 0:a.useAllData,v=r.parentCompositeLayer.sublayerIdsCache.get(r.objectType.name),m=!h&&v?Array.from(v).sort():null,null===(o=this.inclusionModeDefinition)||void 0===o||null===(o=o.namedTypeDefinitions)||void 0===o||null===(o=o.get(r.objectType.name))||void 0===o||!o.useAllData){e.next=8;break}(null===(s=this.inclusionModeDefinition)||void 0===s||null===(s=s.namedTypeDefinitions)||void 0===s||null===(s=s.get(r.objectType.name))||void 0===s?void 0:s.useAllData)&&null!=t.objectIds&&(m=t.objectIds),e.next=20;break;case 8:if(!(null!=t.objectIds&&m&&m.length>0)){e.next=13;break}g=t.objectIds,t.objectIds=m.filter((function(e){return g.includes(e)})),e.next=20;break;case 13:if(null==t.objectIds){e.next=17;break}m=t.objectIds,e.next=20;break;case 17:if(null===(b=this.inclusionModeDefinition)||void 0===b||!b.namedTypeDefinitions.has(r.objectType.name)||null!==(w=this.inclusionModeDefinition.namedTypeDefinitions.get(r.objectType.name))&&void 0!==w&&w.members&&!((null===(_=this.inclusionModeDefinition.namedTypeDefinitions.get(r.objectType.name))||void 0===_||null===(_=_.members)||void 0===_?void 0:_.size)<1)){e.next=19;break}return e.abrupt("return",(t.objectIds=[],[]));case 19:t.objectIds=m;case 20:if(null!=t.outFields&&((k=t.outFields).includes("*")?r.fields.forEach((function(e){l.add(e.name)})):k.forEach((function(e){e!==Jt&&e!==r.geometryFieldName&&l.add(e)}))),null==t.geometry){e.next=38;break}if(null===(M=t.geometry)||void 0===M||null===(Z=M.extent)||void 0===Z||!Z.spatialReference||null!==(C=M.spatialReference)&&void 0!==C&&C.isWGS84){e.next=29;break}return e.next=26,(0,E.initializeProjection)(M.extent.spatialReference,I.Zn);case 26:L=(0,E.project)(M.extent,I.Zn),e.next=30;break;case 29:L=M.extent;case 30:if(null==t.where||"1=1"===t.where){e.next=35;break}return e.next=33,(0,x.E)(t.where.toUpperCase(),r.fieldsIndex);case 33:D=e.sent,r.fields.forEach((function(e){D.fieldNames.includes(e.name)&&l.add(e.name)}));case 35:c=f?"Match ()-[n:".concat(r.objectType.name,"]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.").concat(r.geometryFieldName,") return ID(n), id(startNode(r)), id(endNode(r))"):"Match (n:".concat(r.objectType.name,") WHERE esri.graph.ST_Intersects($param_filter_geom, n.").concat(r.geometryFieldName,") return ID(n)"),r.geometryFieldName&&l.add(r.geometryFieldName),l.forEach((function(e){c+=", n.".concat(e),p.push(e)})),d=new Ht({openCypherQuery:c,bindParameters:{param_filter_geom:new T.Z({rings:[[[L.xmin,L.ymin],[L.xmin,L.ymax],[L.xmax,L.ymax],[L.xmax,L.ymin],[L.xmin,L.ymin]]]})}}),e.next=52;break;case 38:if(j="",null==t.where||"1=1"===t.where){e.next=48;break}return e.next=42,(0,x.E)(t.where,r.fieldsIndex);case 42:R=e.sent,r.fields.forEach((function(e){R.fieldNames.includes(e.name)&&l.add(e.name)})),G=["column-reference","string","number","binary-expression"],N=["=","<","<=","<>",">",">=","AND","OR","LIKE"],F=!1,O=function e(t){if("column-reference"===t.type)return"n.".concat(t.column);if("string"===t.type)return"'".concat(t.value,"'");if("number"===t.type)return"".concat(t.value);if("binary-expression"===t.type&&G.includes(t.left.type)&&G.includes(t.right.type)&&N.includes(t.operator))return"".concat(e(t.left)," ").concat(t.operator," ").concat(e(t.right));if("binary-expression"===t.type&&"LIKE"===t.operator){var r="";if("function"===t.left.type&&"column-reference"===t.left.args.value[0].type)r+="lower(n.".concat(t.left.args.value[0].column,")");else{if("column-reference"!==t.left.type)return F=!0,"";r+="lower(n.".concat(t.left.column,")")}if(r+=" CONTAINS (","string"!==t.right.type)return F=!0,"";var n=t.right.value;return"%"===n.charAt(0)&&(n=n.slice(1)),"%"===n.charAt(n.length-1)&&(n=n.slice(0,-1)),r+="'".concat(n.toLowerCase(),"')")}return F=!0,""},j=O(R.parseTree),F&&(j="");case 48:P="",P=f?"Match ()-[n:".concat(r.objectType.name,"]->()"):"Match (n:".concat(r.objectType.name,")"),A=!1,m&&(A=!0,P+=" WHERE ID(n) IN $ids"),j&&(P+=A?" AND":" WHERE",P+=" ".concat(j)),P+=" return ID(n)",f&&(P+=", id(startNode(n)), id(endNode(n))"),t.returnGeometry&&r.geometryFieldName&&l.add(r.geometryFieldName),l.forEach((function(e){P+=", n.".concat(e),p.push(e)})),d=new Ht(m?{openCypherQuery:P,bindParameters:{ids:m}}:{openCypherQuery:P});case 52:return e.next=54,mt(r.parentCompositeLayer.dataManager.knowledgeGraph,d,n);case 54:z=e.sent.resultRowsStream.getReader();case 55:return e.next=57,z.read();case 57:if(Q=e.sent,U=Q.done,V=Q.value,!U){e.next=62;break}return e.abrupt("break",67);case 62:for(B=[],H=0;H<V.length;H++){for(Y=V[H],W=0,(K={properties:{}}).id=Y[J=0],J++,W++,f&&(K.originId=Y[J],J++,W++,K.destinationId=Y[J],J++,W++);J<Y.length;J++)K.properties[p[J-W]]=Y[J];B.push(K)}y=y.concat(u.writeToStore(B,Jt,null===(q=r.parentCompositeLayer.dataManager.geographicLookup.get(r.objectType.name))||void 0===q?void 0:q.name));case 65:e.next=55;break;case 67:return e.abrupt("return",y);case 68:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(C.Z);(0,d._)([(0,v.Cb)()],tr.prototype,"knowledgeGraph",void 0),(0,d._)([(0,v.Cb)()],tr.prototype,"inclusionModeDefinition",void 0),(0,d._)([(0,v.Cb)()],tr.prototype,"entityTypeNames",void 0),(0,d._)([(0,v.Cb)()],tr.prototype,"relationshipTypeNames",void 0),(0,d._)([(0,v.Cb)()],tr.prototype,"geographicLookup",void 0),(0,d._)([(0,v.Cb)()],tr.prototype,"sublayerCaches",void 0),tr=(0,d._)([(0,g.j)("esri.rest.knowledgeGraph.knowledgeGraphLayer.KnowledgeGraphLayerDataManager")],tr);var rr=r(93433),nr=r(44055),ir=(r(94931),r(78451),r(98689),r(57823),r(32066),r(30505),r(34999),r(28189),r(9014)),ar=r(40464),or=(r(31009),r(97114)),sr=r(27011),ur=r(63543),lr=(0,r(25610).v)(),pr=r(6693),dr=r(64390),cr=r(71684),yr=r(56811),fr=r(83040),hr=r(37270),vr=r(49818),mr=r(81085),gr=r(82485),br=r(53866),wr=r(27823),_r=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n,i,a,s,l;if((0,o.Z)(this,r),(l=t.call(this,e)).capabilities=(0,ur.MS)(!1,!1),l.definitionExpression="",l.displayField="",l.elevationInfo=null,l.geometryType=null,l.geometryFieldName=null,l.graphType=null,l.hasM=!1,l.hasZ=!1,l.labelsVisible=null,l.labelingInfo=null,l.objectIdField=Jt,l.objectType=null,l.parentCompositeLayer=null,l.popupTemplate=null,l.source={openPorts:function(){return l.load().then((function(){var e=new MessageChannel;return new gr.Z(e.port1,{channel:e,client:{queryFeatures:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Yt.Z.fromJSON(e);return l.queryFeaturesJSON(r,t)}}},(function(){return null})),[e.port2]}))}},l.type="knowledge-graph-sublayer","link-chart"===e.parentCompositeLayer.type)"relationship"===e.graphType?l.geometryType="polyline":l.geometryType="point",l.geometryFieldName=$t;else if(null!==(n=e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name))&&void 0!==n&&n.geometryType&&"esriGeometryNull"!==(null===(i=e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name))||void 0===i?void 0:i.geometryType)){var p,d,c,y,f=e.parentCompositeLayer.dataManager.geographicLookup.get(e.objectType.name);l.geometryFieldName=null!==(p=null===f||void 0===f?void 0:f.name)&&void 0!==p?p:null,l.geometryType=null!==f&&void 0!==f&&f.geometryType?wr.M.fromJSON(f.geometryType):null;var h=null===f||void 0===f?void 0:f.name,v=h?null===(d=e.objectType.properties)||void 0===d?void 0:d[h]:null;v?(l.hasM=null!==(c=v.hasM)&&void 0!==c&&c,l.hasZ=null!==(y=v.hasZ)&&void 0!==y&&y):(l.hasM=!1,l.hasZ=!1)}else l.geometryType=null;return null!==(a=e.objectType.properties)&&void 0!==a&&a.forEach((function(e){var t=e.fieldType;"esriFieldTypeOID"===t&&(t="esriFieldTypeInteger"),l.fields.push(fr.Z.fromJSON({name:e.name,type:t,alias:e.alias,defaultValue:null,editable:e.editable,nullable:e.nullable}))})),l.fields.push(fr.Z.fromJSON({name:l.objectIdField,type:"esriFieldTypeString",alias:l.objectIdField,editable:!1})),l._set("fields",(0,rr.Z)(l.fields)),null!==(s=e.parentCompositeLayer.dataManager.knowledgeGraph.dataModel)&&void 0!==s&&s.spatialReference&&(l.spatialReference=e.parentCompositeLayer.dataManager.knowledgeGraph.dataModel.spatialReference),"link-chart"===e.parentCompositeLayer.type?"relationship"===e.graphType?l.renderer=(0,ir.i)((0,ur.bU)(wr.M.toJSON("polyline")).renderer):l.renderer=(0,ir.i)((0,ur.bU)(wr.M.toJSON("point")).renderer):l.renderer=(0,ir.i)((0,ur.bU)(wr.M.toJSON(l.geometryType)).renderer),(0,u.Z)(l)}return(0,s.Z)(r,[{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",set:function(e){(0,hr.YN)(e,this.fieldsIndex),this._set("renderer",e)}},{key:"createPopupTemplate",value:function(e){return(0,mr.eZ)(this,e)}},{key:"createQuery",value:function(){return new Yt.Z({where:"1=1",outFields:["*"]})}},{key:"getField",value:function(e){for(var t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];throw new Error("Field not found")}},{key:"getFieldDomain",value:function(e,t){return null}},{key:"queryFeatures",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n,a,o,s,u=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._setupQueryObjects(t);case 2:return n=e.sent,a=n.resolvedQuery,o=n.queryEngine,e.t0=vr.Z,e.next=8,o.executeQuery(a.toJSON(),null===r||void 0===r?void 0:r.signal);case 8:return e.t1=e.sent,s=e.t0.fromJSON.call(e.t0,e.t1),e.abrupt("return",(s.features.forEach((function(e){e.sourceLayer=u})),s));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryFeaturesJSON",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n,a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._setupQueryObjects(t);case 2:return n=e.sent,a=n.resolvedQuery,o=n.queryEngine,e.next=7,o.executeQuery(a.toJSON(),null===r||void 0===r?void 0:r.signal);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryFeatureCount",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n,a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._setupQueryObjects(t);case 2:return n=e.sent,a=n.resolvedQuery,o=n.queryEngine,e.abrupt("return",o.executeQueryForCount(a.toJSON(),null===r||void 0===r?void 0:r.signal));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"queryExtent",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,r,n,a,o,s,u,l,p,d,c,y,f=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=f.length>0&&void 0!==f[0]?f[0]:{},s=f.length>1?f[1]:void 0,u=(0,L.Z)((0,L.Z)({},o),{},{returnGeometry:!0}),e.next=5,this._setupQueryObjects(u);case 5:return l=e.sent,p=l.resolvedQuery,d=l.queryEngine,e.next=10,d.executeQueryForExtent(p.toJSON(),null===s||void 0===s?void 0:s.signal);case 10:return c=e.sent,e.abrupt("return",(y=null!=(null===(t=c.extent)||void 0===t?void 0:t.xmin)&&null!=(null===(r=c.extent)||void 0===r?void 0:r.xmax)&&null!=(null===(n=c.extent)||void 0===n?void 0:n.ymin)&&null!=(null===(a=c.extent)||void 0===a?void 0:a.ymax)?new br.Z(c.extent):new br.Z,{count:c.count,extent:y}));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"queryObjectIds",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n,a,o;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Yt.Z.from(t),"link-chart"!==this.parentCompositeLayer.type||!this._cachedQueryEngine){e.next=5;break}a=this._cachedQueryEngine,e.next=9;break;case 5:return e.next=7,this.parentCompositeLayer.dataManager.getData(n,this,r);case 7:o=e.sent,a=this.loadQueryEngine(o);case 9:return e.abrupt("return",a.executeQueryForIds(n.toJSON(),null===r||void 0===r?void 0:r.signal));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"loadQueryEngine",value:function(e){var t=new or.Z({geometryType:wr.M.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),r=new sr.q({fields:this.fields.map((function(e){return e.toJSON()})),geometryType:wr.M.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:null,featureStore:t});return r.featureStore.addMany(e),r}},{key:"refreshCachedQueryEngine",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.parentCompositeLayer.dataManager.getData(new Yt.Z({where:"1=1",outFields:[Jt]}),this);case 2:t=e.sent,this._cachedQueryEngine=this.loadQueryEngine(t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_setupQueryObjects",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t,r){var n,a,o,s,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Yt.Z.from(t),o=a.geometry,e.t0=o&&!(null!==(n=o.spatialReference)&&void 0!==n&&n.isWGS84),!e.t0){e.next=6;break}return e.next=5,(0,E.initializeProjection)(o.spatialReference,I.Zn);case 5:a.geometry=(0,E.project)(o instanceof T.Z||o instanceof ce.Z?o:o.extent,I.Zn);case 6:if("link-chart"!==this.parentCompositeLayer.type||!this._cachedQueryEngine){e.next=10;break}s=this._cachedQueryEngine,e.next=14;break;case 10:return e.next=12,this.parentCompositeLayer.dataManager.getData(a,this,r);case 12:u=e.sent,s=this.loadQueryEngine(u);case 14:return e.abrupt("return",{resolvedQuery:a,queryEngine:s});case 15:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),r}((0,dr.M)(function(e){var t=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,o.Z)(this,r),(e=t.apply(this,arguments)).fields=[],e.fieldsIndex=null,e}return(0,s.Z)(r)}(e);return(0,d._)([(0,v.Cb)(lr.fields)],t.prototype,"fields",void 0),(0,d._)([(0,v.Cb)(lr.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=(0,d._)([(0,g.j)("esri.layers.knowledgeGraphLayer.KnowledgeGraphSublayerBase")],t),t}((0,pr.h)((0,yr.M)((0,cr.Q)(w.Z))))));(0,d._)([(0,v.Cb)()],_r.prototype,"capabilities",void 0),(0,d._)([(0,v.Cb)({readOnly:!0})],_r.prototype,"defaultPopupTemplate",null),(0,d._)([(0,v.Cb)()],_r.prototype,"definitionExpression",void 0),(0,d._)([(0,v.Cb)()],_r.prototype,"displayField",void 0),(0,d._)([(0,v.Cb)()],_r.prototype,"elevationInfo",void 0),(0,d._)([(0,v.Cb)()],_r.prototype,"geometryType",void 0),(0,d._)([(0,v.Cb)()],_r.prototype,"geometryFieldName",void 0),(0,d._)([(0,v.Cb)()],_r.prototype,"graphType",void 0),(0,d._)([(0,v.Cb)()],_r.prototype,"hasM",void 0),(0,d._)([(0,v.Cb)()],_r.prototype,"hasZ",void 0),(0,d._)([(0,v.Cb)()],_r.prototype,"labelsVisible",void 0),(0,d._)([(0,v.Cb)()],_r.prototype,"labelingInfo",void 0),(0,d._)([(0,v.Cb)()],_r.prototype,"objectIdField",void 0),(0,d._)([(0,v.Cb)()],_r.prototype,"objectType",void 0),(0,d._)([(0,v.Cb)()],_r.prototype,"parentCompositeLayer",void 0),(0,d._)([(0,v.Cb)({type:nr.Z,json:{name:"popupInfo",write:!0}})],_r.prototype,"popupTemplate",void 0),(0,d._)([(0,v.Cb)({types:ar.A,json:{write:{target:"layerDefinition.drawingInfo.renderer"}}})],_r.prototype,"renderer",null),(0,d._)([(0,v.Cb)()],_r.prototype,"source",void 0),(0,d._)([(0,v.Cb)({json:{read:!1}})],_r.prototype,"type",void 0);var kr,Zr,Cr=_r=(0,d._)([(0,g.j)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],_r),xr=null;function Tr(){return kr||(kr=r.e(662).then(r.bind(r,39672)).then((function(e){return e.l})).then((function(e){return(0,e.default)({locateFile:function(e){return(0,ne.V)("esri/libs/linkchartlayout/".concat(e))}})})).then((function(e){!function(e){xr=e}(e)})),kr)}function Er(e,t,r,n,i,a){var o=r.length,s=i.length,u=Float64Array.BYTES_PER_ELEMENT,l=Uint32Array.BYTES_PER_ELEMENT,p=Uint8Array.BYTES_PER_ELEMENT,d=15+o*(p+2*u)+s*(2*l),c=xr._malloc(d);try{var y=c+16-c%16,f=y+o*u,h=f+o*u,v=h+s*l,m=v+s*l,g=function(){return[xr.HEAPF64.subarray(y>>3,(y>>3)+o),xr.HEAPF64.subarray(f>>3,(f>>3)+o),xr.HEAPU32.subarray(h>>2,(h>>2)+s),xr.HEAPU32.subarray(v>>2,(v>>2)+s),xr.HEAPU8.subarray(m,m+o)]},b=g(),w=(0,Z.Z)(b,5),_=w[0],k=w[1],C=w[2],x=w[3],T=w[4];_.set(r),k.set(n),C.set(i),x.set(a),T.set(t);var E=e(o,m,y,f,s,h,v),I=g(),M=(0,Z.Z)(I,5),S=M[0],L=M[1],D=M[2],j=M[3],R=M[4];return r.set(S),n.set(L),i.set(D),a.set(j),t.set(R),E}finally{xr._free(c)}}!function(e){e[e.None=0]="None",e[e.IsMovable=1]="IsMovable",e[e.IsGeographic=2]="IsGeographic",e[e.IsRoot=4]="IsRoot"}(Zr||(Zr={}));var Ir,Mr,Sr,Lr,Dr,jr,Rr,Gr;!function(e){e.getMinIdealEdgeLength=function(){return xr.getMinIdealEdgeLength()},e.apply=function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1;return Er((function(e,t,r,n,i,u,l){return xr.applyForceDirectedLayout(e,t,r,n,i,u,l,a,o,s)}),e,t,r,n,i)}}(Ir||(Ir={})),function(e){e.apply=function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:-1;return Er((function(e,t,r,n,i,u,l){return xr.applyCommunityLayout(e,t,r,n,i,u,l,a,o,s)}),e,t,r,n,i)}}(Mr||(Mr={})),function(e){e.apply=function(e,t,r,n,i){return Er(xr.applySimpleLayout,e,t,r,n,i)}}(Sr||(Sr={})),function(e){e.apply=function(e,t,r,n,i){return Er(xr.applyHierarchicalLayout,e,t,r,n,i)}}(Lr||(Lr={})),function(e){e.apply=function(e,t,r,n,i){return Er(xr.applyRadialTreeLayout,e,t,r,n,i)}}(Dr||(Dr={})),function(e){e.apply=function(e,t,r,n,i){return Er(xr.applySmartTreeLayout,e,t,r,n,i)}}(jr||(jr={})),function(e){e[e.Undirected=0]="Undirected",e[e.Directed=1]="Directed",e[e.Reversed=2]="Reversed"}(Rr||(Rr={})),function(e){e[e.ByCC_Raw=0]="ByCC_Raw",e[e.ByCC_NormalizeGlobally=1]="ByCC_NormalizeGlobally",e[e.ByCC_NormalizeByCC=2]="ByCC_NormalizeByCC"}(Gr||(Gr={}));var Nr=function(e){(0,l.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;if((0,o.Z)(this,r),(n=t.call(this,e)).dataPreloadedInLocalCache=!1,n._currentLinkChartConfig={layoutMode:"RADIAL_TREE",xScaleFactor:1,yScaleFactor:1},n._graphTypeLookup=new Map,n.layers=new c.Z,n.linkChartDiagramLookup=new Map,n.linkChartExtent=new br.Z({xmin:-1e-7,ymin:-1e-7,xmax:1e-7,ymax:1e-7}),n.linkChartGeohashLookup=new Map,n.sublayerIdsCache=new Map,n.tables=new c.Z,n.type="link-chart",n._originalInclusionList=e.inclusionModeDefinition,e.dataPreloadedInLocalCache&&!e.inclusionModeDefinition)throw new y.Z("knowledge-graph:linkchart-layer-constructor","If creating a link chart composite layer and configured that data is already loaded in the cache, you must specify an inclusion list so the Composite Layer knows what records belong to it");return(0,u.Z)(n)}return(0,s.Z)(r,[{key:"normalizeCtorArgs",value:function(e){return{url:e.url,title:e.title,dataPreloadedInLocalCache:e.dataPreloadedInLocalCache,defaultLinkChartConfig:e.defaultLinkChartConfig}}},{key:"_initializeLayerProperties",value:function(e){var t,r,n,i,a,o,s,u,l,p,d=this;if(!this.title&&this.url){var c=this.url.split("/");this.title=c[c.length-2]}var h=new Set,v=[],m=[];if(e.inclusionModeDefinition&&(!e.inclusionModeDefinition.namedTypeDefinitions||e.inclusionModeDefinition.namedTypeDefinitions.size<1))throw new y.Z("knowledge-graph:composite-layer-constructor","If an explicit inclusion definition is defined, at least one namedTypeDefinition must also be defined");null!==(t=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==t&&t.forEach((function(e){e.name&&d._graphTypeLookup.set(e.name,e)})),null!==(r=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==r&&r.forEach((function(e){e.name&&d._graphTypeLookup.set(e.name,e)})),null!==(n=e.inclusionModeDefinition)&&void 0!==n&&n.generateAllSublayers?(v=null!==(i=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==i?i:[],m=null!==(a=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==a?a:[]):null!==(o=e.inclusionModeDefinition)&&void 0!==o&&o.namedTypeDefinitions&&(null===(s=e.inclusionModeDefinition)||void 0===s?void 0:s.namedTypeDefinitions.size)>0?null===(u=e.inclusionModeDefinition)||void 0===u||u.namedTypeDefinitions.forEach((function(t,r){var n,i;if(!d._graphTypeLookup.get(r))return f.Z.getLogger(d).warn("A named type, ".concat(r,", was in the inclusion list that wasn't in the data model and will be removed")),void(null===(n=e.inclusionModeDefinition)||void 0===n||n.namedTypeDefinitions.delete(r));d._graphTypeLookup.get(r)instanceof J||"strictOrigin"in d._graphTypeLookup.get(r)?h.has(r)||(h.add(r),m.push(d._graphTypeLookup.get(r))):d._graphTypeLookup.get(r)instanceof H||"properties"in d._graphTypeLookup.get(r)?h.has(r)||(h.add(r),v.push(d._graphTypeLookup.get(r))):(f.Z.getLogger(d).warn("A named type, ".concat(r,", was in the inclusion list that wasn't properly modeled and will be removed")),null===(i=e.inclusionModeDefinition)||void 0===i||i.namedTypeDefinitions.delete(r))})):(v=null!==(l=e.knowledgeGraph.dataModel.entityTypes)&&void 0!==l?l:[],m=null!==(p=e.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==p?p:[]);var g=new tr({knowledgeGraph:e.knowledgeGraph,inclusionModeDefinition:e.inclusionModeDefinition});this.knowledgeGraph=e.knowledgeGraph,this.memberEntityTypes=v,this.memberRelationshipTypes=m,this.dataManager=g}},{key:"load",value:function(e){var t=this;return this.addResolvingPromise(new Promise((function(r){(function(e){return bt.apply(this,arguments)})(t.url).then((function(n){var o,s,u,l;if(t._initializeLayerProperties({knowledgeGraph:n,inclusionModeDefinition:t._originalInclusionList}),null!==(o=t.dataManager.inclusionModeDefinition)&&void 0!==o&&null!==(o=o.namedTypeDefinitions)&&void 0!==o&&o.size||(t.dataManager.inclusionModeDefinition={generateAllSublayers:!1,namedTypeDefinitions:new Map},null!==(s=t.dataManager.knowledgeGraph.dataModel.entityTypes)&&void 0!==s&&s.forEach((function(e){var r;e.name&&(null===(r=t.dataManager.inclusionModeDefinition)||void 0===r||r.namedTypeDefinitions.set(e.name,{useAllData:!0}))})),null!==(u=t.dataManager.knowledgeGraph.dataModel.relationshipTypes)&&void 0!==u&&u.forEach((function(e){var r;e.name&&(null===(r=t.dataManager.inclusionModeDefinition)||void 0===r||r.namedTypeDefinitions.set(e.name,{useAllData:!0}))}))),t.dataPreloadedInLocalCache)t.loadLayerAssumingLocalCache(),t.dataManager.inclusionModeDefinition&&(t.dataManager.inclusionModeDefinition.generateAllSublayers=!1),null===(l=t.dataManager.inclusionModeDefinition)||void 0===l||l.namedTypeDefinitions.forEach((function(e){var r;e.useAllData=!1,null!==(r=e.members)&&void 0!==r&&r.forEach((function(e){var r;r=e.linkChartLocation instanceof k.Z?e.linkChartLocation:e.linkChartLocation?(0,_.GH)(e.linkChartLocation):null,t.linkChartDiagramLookup.set(e.id,r),r&&2===r.coords.length&&0===r.lengths.length?t.linkChartGeohashLookup.set(e.id,(0,b.fC)(r.coords[1],r.coords[0],Xt)):t.linkChartGeohashLookup.set(e.id,"")})),t.addResolvingPromise(t._initializeDiagram().then((0,a.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.layers.forEach(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.refreshCachedQueryEngine();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.tables.forEach(function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.refreshCachedQueryEngine();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})))))}));else{var p,d="GEOGRAPHIC"===(null===(p=t.defaultLinkChartConfig)||void 0===p?void 0:p.layoutMode);t.addResolvingPromise(t.dataManager.refreshCacheContent(void 0,!1,d,!0).then((0,a.Z)((0,i.Z)().mark((function r(){var n,a;return(0,i.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(0,h.k_)(e),n=[],a=[],t.loadLayerAssumingLocalCache(),t.dataManager.inclusionModeDefinition&&(t.dataManager.inclusionModeDefinition.generateAllSublayers=!1,t.dataManager.inclusionModeDefinition.namedTypeDefinitions.forEach((function(e){e.useAllData=!1}))),r.next=6,t._initializeDiagram();case 6:return t.layers.forEach((function(e){a.push(e.refreshCachedQueryEngine()),n.push(new Promise((function(t){e.on("layerview-create",(function(){t(null)}))})))})),t.tables.forEach((function(e){a.push(e.refreshCachedQueryEngine())})),r.next=10,Promise.all(a);case 10:case"end":return r.stop()}}),r)})))))}r(null)}))}))),Promise.resolve(this)}},{key:"addRecords",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._handleNewRecords(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"expand",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r,n,a=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dataManager.getConnectedRecordIds(t);case 2:return r=e.sent,n=r.filter((function(e){var t;return!(null!==(t=a.sublayerIdsCache.get(e.typeName))&&void 0!==t&&t.has(e.id))})),e.next=6,this._handleNewRecords(r);case 6:return e.abrupt("return",{records:n});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadLayerAssumingLocalCache",value:function(){var e,t,r=this;this.memberRelationshipTypes.forEach((function(e){var t=new Cr({objectType:e,parentCompositeLayer:r,graphType:"relationship",title:e.name});t.geometryType?r.layers.push(t):r.tables.push(t),r.dataManager.sublayerCaches.has(e.name)||r.dataManager.sublayerCaches.set(e.name,new Map)})),this.memberEntityTypes.forEach((function(e){var t=new Cr({objectType:e,parentCompositeLayer:r,graphType:"entity",title:e.name});t.geometryType?r.layers.push(t):r.tables.push(t),r.dataManager.sublayerCaches.has(e.name)||r.dataManager.sublayerCaches.set(e.name,new Map)})),(null===(e=this.dataManager.inclusionModeDefinition)||void 0===e?void 0:e.namedTypeDefinitions)&&(null===(t=this.dataManager.inclusionModeDefinition)||void 0===t||t.namedTypeDefinitions.forEach((function(e,t){var n,i=function(e,t,r){return e.has(t)||e.set(t,r()),e.get(t)}(r.sublayerIdsCache,t,(function(){return new Set}));null===(n=e.members)||void 0===n||n.forEach((function(e){if(i.add(e.id),e.linkChartLocation)if(e.linkChartLocation instanceof k.Z)r.linkChartDiagramLookup.set(e.id,e.linkChartLocation),2===e.linkChartLocation.coords.length&&0===e.linkChartLocation.lengths.length?r.linkChartGeohashLookup.set(e.id,(0,b.fC)(e.linkChartLocation.coords[1],e.linkChartLocation.coords[0],Xt)):r.linkChartGeohashLookup.set(e.id,"");else{var t=(0,_.GH)(e.linkChartLocation);r.linkChartDiagramLookup.set(e.id,e.linkChartLocation?t:null),"x"in e.linkChartLocation&&"y"in e.linkChartLocation?r.linkChartGeohashLookup.set(e.id,(0,b.fC)(e.linkChartLocation.x,e.linkChartLocation.y,Xt)):r.linkChartGeohashLookup.set(e.id,"")}}))})))}},{key:"calculateLinkChartLayout",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,r,n,a,o,s,u,l,p,d,c,h,v,m,g,w,k,Z,C,x,T,E,I,M,S,L,D,j=this,R=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=R.length>0&&void 0!==R[0]?R[0]:"RADIAL_TREE",a=R.length>1?R[1]:void 0,o=[],s=[],this.dataManager.sublayerCaches.forEach((function(e,t){j.dataManager.entityTypeNames.has(t)?e.forEach((function(e){o.push({typeName:t,feature:e})})):j.dataManager.relationshipTypeNames.has(t)&&e.forEach((function(e){s.push({typeName:t,feature:e})}))})),this.linkChartDiagramLookup=new Map,u=new Map,l=new Map,p=new Map,d=new Map,c=new Uint8Array(o.length),h=new Float64Array(o.length),v=new Float64Array(o.length),m=new Uint32Array(s.length),g=new Uint32Array(s.length),w=[],"FORCE_DIRECTED",k=null!==(t=null===a||void 0===a?void 0:a.xScaleFactor)&&void 0!==t?t:1,Z=null!==(r=null===a||void 0===a?void 0:a.yScaleFactor)&&void 0!==r?r:1,C=new br.Z({xmin:-1e-7,ymin:-1e-7,xmax:1e-7,ymax:1e-7}),"FORCE_DIRECTED",T=0,E=0,e.t0="GEOGRAPHIC"===n?"FORCE_DIRECTED":n,e.next="FORCE_DIRECTED"===e.t0?9:"COMMUNITY"===e.t0?11:"HIERARCHICAL"===e.t0?13:"RADIAL_TREE"===e.t0?15:"SMART_TREE"===e.t0?17:19;break;case 9:return x=Ir.apply,e.abrupt("break",20);case 11:return x=Mr.apply,e.abrupt("break",20);case 13:return x=Lr.apply,e.abrupt("break",20);case 15:return x=Dr.apply,e.abrupt("break",20);case 17:return x=jr.apply,e.abrupt("break",20);case 19:x=Sr.apply;case 20:return o.forEach((function(e){var t,r,i,o,s,u,l=e.typeName,p=e.feature;if(null!==a&&void 0!==a&&null!==(t=a.lockedNodeLocations)&&void 0!==t&&t.has(p.attributes[Jt])){"GEOGRAPHIC"===n&&j.dataManager.geographicLookup.has(l)?c[T]=Zr.IsGeographic:c[T]=Zr.None;var y=a.lockedNodeLocations.get(p.attributes[Jt]);h[T]=y.x,v[T]=y.y}else if("GEOGRAPHIC"===n&&j.dataManager.geographicLookup.has(l)){var f;c[T]=Zr.IsGeographic;var m=null,g=p.attributes[j.dataManager.geographicLookup.get(l).name];switch(null===(f=j.dataManager.geographicLookup.get(l))||void 0===f?void 0:f.geometryType){case"esriGeometryPoint":h[T]=null===g||void 0===g?void 0:g.x,v[T]=null===g||void 0===g?void 0:g.y;break;case"esriGeometryPolygon":null!=(null===(r=m=null===g||void 0===g?void 0:g.centroid)||void 0===r?void 0:r.x)&&null!=(null===(i=m)||void 0===i?void 0:i.y)?(h[T]=m.x,v[T]=m.y):c[T]=Zr.IsMovable;break;case"esriGeometryPolyline":case"esriGeometryMultipoint":null!=(null===(s=m=null===g||void 0===g||null===(o=g.extent)||void 0===o?void 0:o.center)||void 0===s?void 0:s.x)&&null!=(null===(u=m)||void 0===u?void 0:u.y)?(h[T]=m.x,v[T]=m.y):c[T]=Zr.IsMovable;break;default:c[T]=Zr.IsMovable}(null==h[T]||null==v[T]||Number.isNaN(h[T])||Number.isNaN(v[T]))&&(c[T]=Zr.IsMovable,h[T]=0,v[T]=0)}else c[T]=Zr.IsMovable,h[T]=0,v[T]=0;d.set(p.attributes[Jt],T),w[T]={feature:p,typeName:l},T++})),I=!1,s.forEach((function(e){var t=d.get(e.feature.attributes[Wt]),r=d.get(e.feature.attributes[Kt]);void 0!==t&&void 0!==r?(m[E]=t,g[E]=r,E++):(I=!0,j.linkChartDiagramLookup.set(e.feature.attributes[Wt],null),j.linkChartGeohashLookup.set(e.feature.attributes[Wt],null))})),I&&f.Z.getLogger(this).warn("A relationship is a member of this layer that has either origin or destination entity nodes that are not members. The diagram geometry will be set to null"),e.next=26,Tr();case 26:if(x(c,h,v,m,g)){e.next=28;break}throw new y.Z("knowledge-graph:layout-failed","Attempting to arrange the records in the specified layout failed");case 28:for(M=0;M<w.length;M++)c[M]===Zr.IsMovable&&(h[M]=h[M]*k,v[M]=v[M]*Z),v[M]>84.9999&&(v[M]=84.9999),v[M]<-84.9999&&(v[M]=-84.9999),h[M]>179.9999&&(h[M]=179.9999),h[M]<-179.9999&&(h[M]=-179.9999),w[M].feature.attributes[$t]=new de.Z(h[M],v[M]),u.has(w[M].typeName)?null===(S=u.get(w[M].typeName))||void 0===S||S.set(w[M].feature.attributes[Jt],w[M].feature):((L=new Map).set(w[M].feature.attributes[Jt],w[M].feature),u.set(w[M].typeName,L)),p.set(w[M].feature.attributes[Jt],w[M].feature),D=(0,_.GH)(w[M].feature.attributes[$t]),this.linkChartDiagramLookup.set(w[M].feature.attributes[Jt],w[M].feature.attributes[$t]?D:null),this.linkChartGeohashLookup.set(w[M].feature.attributes[Jt],(0,b.fC)(w[M].feature.attributes[$t].y,w[M].feature.attributes[$t].x,Xt)),w[M].feature.attributes[$t].x<C.xmin&&(C.xmin=w[M].feature.attributes[$t].x),w[M].feature.attributes[$t].x>C.xmax&&(C.xmax=w[M].feature.attributes[$t].x),w[M].feature.attributes[$t].y<C.ymin&&(C.ymin=w[M].feature.attributes[$t].y),w[M].feature.attributes[$t].y>C.ymax&&(C.ymax=w[M].feature.attributes[$t].y);return e.abrupt("return",(this.linkChartExtent.xmin=C.xmin,this.linkChartExtent.xmax=C.xmax,this.linkChartExtent.ymin=C.ymin,this.linkChartExtent.ymax=C.ymax,s.forEach((function(e){var t,r,n=null===(t=w[d.get(e.feature.attributes[Wt])])||void 0===t?void 0:t.feature.attributes[$t],i=null===(r=w[d.get(e.feature.attributes[Kt])])||void 0===r?void 0:r.feature.attributes[$t];if(n&&i){var a=new ce.Z({paths:[[n.x,n.y],[i.x,i.y]]});if(e.feature.attributes[$t]=a,l.has(e.typeName)){var o=l.get(e.typeName);null===o||void 0===o||o.set(e.feature.attributes[Jt],e.feature)}else{var s=new Map;s.set(e.feature.attributes[Jt],e.feature),l.set(e.typeName,s)}p.set(e.feature.attributes[Jt],e.feature);var u=(0,_.GH)(e.feature.attributes[$t]);j.linkChartDiagramLookup.set(e.feature.attributes[Jt],e.feature.attributes[$t]?u:null),j.linkChartGeohashLookup.set(e.feature.attributes[Jt],"")}})),this._currentLinkChartConfig={layoutMode:n,xScaleFactor:k,yScaleFactor:Z},{nodes:u,links:l,idMap:p}));case 30:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"applyNewLinkChartLayout",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,r,n,a=arguments;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"RADIAL_TREE",r=a.length>1?a[1]:void 0,n=[],e.next=5,this.calculateLinkChartLayout(t,r);case 5:return this.layers.forEach((function(e){n.push(e.refreshCachedQueryEngine())})),e.next=8,Promise.all(n);case 8:this.layers.forEach((function(e){e.emit("refresh",{dataChanged:!0})}));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCurrentNodeLocations",value:function(){var e,t=new Map;return null!==(e=this.dataManager.inclusionModeDefinition)&&void 0!==e&&null!==(e=e.namedTypeDefinitions)&&void 0!==e&&e.forEach((function(e){var r;null===e||void 0===e||null===(r=e.members)||void 0===r||r.forEach((function(e){var r,n=e.linkChartLocation,i=e.id;n&&(r="x"in n?{x:n.x,y:n.y}:{x:n.coords[0],y:n.coords[1]},t.set(i,new de.Z({x:r.x,y:r.y})))}))})),t}},{key:"synchronizeInclusionListWithCache",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var r;null!==(r=t.dataManager.inclusionModeDefinition)&&void 0!==r&&r.namedTypeDefinitions.forEach((function(e,r){if(e.useAllData=!1,e.members&&e.members.size>0){if(!t.dataManager.sublayerCaches.get(r))return;var n=Array.from(t.dataManager.sublayerCaches.get(r).keys());Array.from(e.members.keys()).filter((function(e){return!n.includes(e)})).forEach((function(t){var r;null===(r=e.members)||void 0===r||r.delete(t)}))}})),e()})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"refreshLinkChartCache",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dataManager.refreshCacheContent(t);case 2:return r=[],this.layers.forEach((function(e){r.push(e.refreshCachedQueryEngine())})),e.next=6,Promise.all(r);case 6:this.layers.forEach((function(e){e.emit("refresh",{dataChanged:!0})}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_handleNewRecords",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(t){var r,a,o,s,u,l,p,d,c,y;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],this.dataManager.addToLayerInclusionSet(t),a=(0,n.Z)(t);try{for(a.s();!(o=a.n()).done;)s=o.value,this.sublayerIdsCache.has(s.typeName)||(this.sublayerIdsCache.set(s.typeName,new Set),r.push(s.typeName)),this.sublayerIdsCache.get(s.typeName).add(s.id)}catch(i){a.e(i)}finally{a.f()}for(u=0,l=r;u<l.length;u++)p=l[u],this._graphTypeLookup.has(p)&&(d=this._graphTypeLookup.get(p),y=new Cr({objectType:d,parentCompositeLayer:this,graphType:c="endPoints"in d?"relationship":"entity",title:p}),"entity"===c?this.dataManager.entityTypeNames.add(p):this.dataManager.relationshipTypeNames.add(p),y.geometryType?this.layers.push(y):this.tables.push(y),this.dataManager.sublayerCaches.set(p,new Map));return e.next=7,this.dataManager.refreshCacheContent(t.map((function(e){return e.id})));case 7:return e.next=9,this.applyNewLinkChartLayout(this._currentLinkChartConfig.layoutMode,{xScaleFactor:this._currentLinkChartConfig.xScaleFactor,yScaleFactor:this._currentLinkChartConfig.xScaleFactor});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_initializeDiagram",value:function(){var e=(0,a.Z)((0,i.Z)().mark((function e(){var t,r=this;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.defaultLinkChartConfig){e.next=9;break}if(!this.defaultLinkChartConfig.doNotRecalculateLayout){e.next=5;break}null!==(t=this.dataManager.inclusionModeDefinition)&&void 0!==t&&null!==(t=t.namedTypeDefinitions)&&void 0!==t&&t.forEach((function(e){var t;null===e||void 0===e||null===(t=e.members)||void 0===t||t.forEach((function(e){var t,n=e.linkChartLocation,i=e.id;if(n){t="x"in n?{x:n.x,y:n.y}:{x:n.coords[0],y:n.coords[1]};var a=(0,_.GH)(t);r.linkChartDiagramLookup.set(i,a),r.linkChartGeohashLookup.set(i,(0,b.fC)(t.x,t.y,Xt)),r.linkChartExtent.xmin>t.x&&(r.linkChartExtent.xmin=t.x),r.linkChartExtent.xmax<t.x&&(r.linkChartExtent.xmax=t.x),r.linkChartExtent.ymin>t.y&&(r.linkChartExtent.ymin=t.y),r.linkChartExtent.ymax<t.y&&(r.linkChartExtent.ymax=t.y)}}))})),this.memberRelationshipTypes.forEach((function(e){var t;e.name&&(null===(t=r.dataManager.sublayerCaches.get(e.name))||void 0===t||t.forEach((function(e){var t=r.linkChartDiagramLookup.get(e.attributes[Wt]),n=r.linkChartDiagramLookup.get(e.attributes[Kt]);if(t&&n){var i=(0,_.GH)(new ce.Z({paths:[[t.coords[0],t.coords[1]],[n.coords[0],n.coords[1]]]}));r.linkChartDiagramLookup.set(e.attributes[Jt],i)}else r.linkChartDiagramLookup.set(e.attributes[Jt],null);r.linkChartGeohashLookup.set(e.attributes[Jt],"")})))})),e.next=7;break;case 5:return e.next=7,this.calculateLinkChartLayout(this.defaultLinkChartConfig.layoutMode,{xScaleFactor:this.defaultLinkChartConfig.xScaleFactor,yScaleFactor:this.defaultLinkChartConfig.yScaleFactor,lockedNodeLocations:this.getCurrentNodeLocations()});case 7:e.next=11;break;case 9:return e.next=11,this.calculateLinkChartLayout("RADIAL_TREE",{lockedNodeLocations:this.getCurrentNodeLocations()});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}((0,pr.h)((0,yr.M)(w.Z)));(0,d._)([(0,v.Cb)()],Nr.prototype,"dataPreloadedInLocalCache",void 0),(0,d._)([(0,v.Cb)()],Nr.prototype,"defaultLinkChartConfig",void 0),(0,d._)([(0,v.Cb)()],Nr.prototype,"dataManager",void 0),(0,d._)([(0,v.Cb)()],Nr.prototype,"knowledgeGraph",void 0),(0,d._)([(0,v.Cb)()],Nr.prototype,"layers",void 0),(0,d._)([(0,v.Cb)()],Nr.prototype,"linkChartDiagramLookup",void 0),(0,d._)([(0,v.Cb)()],Nr.prototype,"linkChartExtent",void 0),(0,d._)([(0,v.Cb)()],Nr.prototype,"linkChartGeohashLookup",void 0),(0,d._)([(0,v.Cb)()],Nr.prototype,"memberEntityTypes",void 0),(0,d._)([(0,v.Cb)()],Nr.prototype,"memberRelationshipTypes",void 0),(0,d._)([(0,v.Cb)()],Nr.prototype,"sublayerIdsCache",void 0),(0,d._)([(0,v.Cb)()],Nr.prototype,"tables",void 0),(0,d._)([(0,v.Cb)({json:{read:!1}})],Nr.prototype,"type",void 0);var Fr=Nr=(0,d._)([(0,g.j)("esri.layers.LinkChartLayer")],Nr)},63543:function(e,t,r){r.d(t,{Dm:function(){return c},Hq:function(){return y},MS:function(){return f},bU:function(){return l}});var n=r(4942),i=r(1413),a=r(93169),o=r(84652),s=r(60480),u=r(76115);function l(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?u.I4:"esriGeometryPolyline"===e?u.ET:u.lF}}}var p=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/,d=1;function c(e,t){if((0,a.Z)("esri-csp-restrictions"))return function(){return(0,i.Z)((0,n.Z)({},t,null),e)};try{var r="this.".concat(t," = null;");for(var o in e)r+="this".concat(p.test(o)?".".concat(o):'["'.concat(o,'"]')," = ").concat(JSON.stringify(e[o]),";");var s=new Function("\n      return class AttributesClass$".concat(d++," {\n        constructor() {\n          ").concat(r,";\n        }\n      }\n    "))();return function(){return new s}}catch(u){return function(){return(0,i.Z)((0,n.Z)({},t,null),e)}}}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,o.d9)(e)}}]}function f(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:s.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1}}}},64390:function(e,t,r){r.d(t,{M:function(){return P}});var n,i=r(93433),a=r(15671),o=r(43144),s=r(60136),u=r(29388),l=r(27366),p=r(49861),d=(r(25243),r(63780),r(93169),r(69912)),c=r(67040),y=r(87562),f=r(44055),h=(r(94931),r(78451),r(98689),r(57823),r(32066),r(30505),r(34999)),v=(r(28189),r(9014)),m=r(40464),g=r(84652),b=r(18202),w=r(27135),_=r(38511),k=r(31201),Z=r(45948),C=r(62594),x=r(77748),T=n=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).type="binning",n.binType="geohash",n.fixedBinLevel=3,n.labelingInfo=null,n.labelsVisible=!0,n.maxScale=0,n.popupEnabled=!0,n.popupTemplate=null,n.fields=[],n.renderer=null,n}return(0,o.Z)(r,[{key:"writeFields",value:function(e,t,r){var n=e.filter((function(e){return"avg_angle"!==e.statisticType})).map((function(e){return e.toJSON()}));(0,b.RB)(r,n,t)}},{key:"readRenderer",value:function(e,t,r){var n,i,a=null===(n=t.drawingInfo)||void 0===n?void 0:n.renderer;return a?null!==(i=(0,v.a)(a,t,r))&&void 0!==i?i:void 0:(0,C.Ob)(t,r)}},{key:"clone",value:function(){return new n({fields:(0,g.d9)(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:(0,g.d9)(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:(0,g.d9)(this.popupTemplate),renderer:(0,g.d9)(this.renderer)})}}]),r}(y.B);(0,l._)([(0,w.J)({binning:"binning"})],T.prototype,"type",void 0),(0,l._)([(0,w.J)({geohash:"geohash"})],T.prototype,"binType",void 0),(0,l._)([(0,p.Cb)({type:Number,range:{min:1,max:9},json:{write:!0}})],T.prototype,"fixedBinLevel",void 0),(0,l._)([(0,p.Cb)({type:[x.Z],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],T.prototype,"labelingInfo",void 0),(0,l._)([(0,p.Cb)(Z.iR)],T.prototype,"labelsVisible",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],T.prototype,"maxScale",void 0),(0,l._)([(0,p.Cb)(Z.C_)],T.prototype,"popupEnabled",void 0),(0,l._)([(0,p.Cb)({type:f.Z,json:{name:"popupInfo",write:!0}})],T.prototype,"popupTemplate",void 0),(0,l._)([(0,p.Cb)({type:[c.Z],json:{write:!0}})],T.prototype,"fields",void 0),(0,l._)([(0,k.c)("fields")],T.prototype,"writeFields",null),(0,l._)([(0,p.Cb)({types:m.A,json:{write:{target:"drawingInfo.renderer"}}})],T.prototype,"renderer",void 0),(0,l._)([(0,_.r)("renderer",["drawingInfo.renderer"])],T.prototype,"readRenderer",null);var E,I=T=n=(0,l._)([(0,d.j)("esri.layers.support.FeatureReductionBinning")],T),M=r(51508),S=r(46784),L=r(17842);function D(e){var t;return"simple"===e.type&&!(null!==(t=e.visualVariables)&&void 0!==t&&t.length)}var j=E=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).type="cluster",n.clusterRadius=(0,L.t_)("80px"),n.clusterMinSize=(0,L.t_)("12px"),n.clusterMaxSize=(0,L.t_)("50px"),n.maxScale=0,n.popupEnabled=!0,n.popupTemplate=null,n.renderer=null,n.symbol=null,n.labelingInfo=null,n.labelsVisible=!0,n.fields=null,n}return(0,o.Z)(r,[{key:"readRenderer",value:function(e,t,r){var n,i,a,o=null===(n=t.drawingInfo)||void 0===n?void 0:n.renderer;return null!==o&&void 0!==o&&null!==(i=o.authoringInfo)&&void 0!==i&&i.isAutoGenerated?null:o?D(o)?null:null!==(a=(0,v.a)(o,t,r))&&void 0!==a?a:void 0:(0,C.Ob)(t,r)}},{key:"readSymbol",value:function(e,t,r){var n,i,a=null===(n=t.drawingInfo)||void 0===n?void 0:n.renderer;if(null!==a&&void 0!==a&&null!==(i=a.authoringInfo)&&void 0!==i&&i.isAutoGenerated)return null;if(a&&D(a)){var o=(0,v.a)(a,t,r);return null===o||void 0===o?void 0:o.symbol}return null}},{key:"writeSymbol",value:function(e,t,r,n){var i,a=null===(i=this.renderer)||void 0===i||null===(i=i.authoringInfo)||void 0===i?void 0:i.isAutoGenerated;if(!this.renderer||a){var o=new h.Z({symbol:e});t.drawingInfo={renderer:o.write({},n)}}}},{key:"writeFields",value:function(e,t,r){var n=e.filter((function(e){return"avg_angle"!==e.statisticType})).map((function(e){return e.toJSON()}));(0,b.RB)(r,n,t)}},{key:"readFields",value:function(e,t,r){return e.filter((function(e){return!e.isAutoGenerated})).map((function(e){return c.Z.fromJSON(e)}))}},{key:"clone",value:function(){return new E({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:(0,g.d9)(this.labelingInfo),labelsVisible:this.labelsVisible,fields:(0,g.d9)(this.fields),maxScale:this.maxScale,renderer:(0,g.d9)(this.renderer),symbol:(0,g.d9)(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:(0,g.d9)(this.popupTemplate)})}}]),r}(S.wq);(0,l._)([(0,p.Cb)({type:["cluster"],readOnly:!0,json:{write:!0}})],j.prototype,"type",void 0),(0,l._)([(0,p.Cb)({type:Number,cast:function(e){return"auto"===e?e:(0,L.t_)(e)},json:{write:!0}})],j.prototype,"clusterRadius",void 0),(0,l._)([(0,p.Cb)({type:Number,cast:L.t_,json:{write:!0}})],j.prototype,"clusterMinSize",void 0),(0,l._)([(0,p.Cb)({type:Number,cast:L.t_,json:{write:!0}})],j.prototype,"clusterMaxSize",void 0),(0,l._)([(0,p.Cb)({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],j.prototype,"maxScale",void 0),(0,l._)([(0,p.Cb)(Z.C_)],j.prototype,"popupEnabled",void 0),(0,l._)([(0,p.Cb)({type:f.Z,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],j.prototype,"popupTemplate",void 0),(0,l._)([(0,p.Cb)({types:m.A,json:{write:{target:"drawingInfo.renderer"}}})],j.prototype,"renderer",void 0),(0,l._)([(0,_.r)("renderer",["drawingInfo.renderer"])],j.prototype,"readRenderer",null),(0,l._)([(0,p.Cb)({types:M.AH})],j.prototype,"symbol",void 0),(0,l._)([(0,_.r)("symbol",["drawingInfo.renderer"])],j.prototype,"readSymbol",null),(0,l._)([(0,k.c)("symbol")],j.prototype,"writeSymbol",null),(0,l._)([(0,p.Cb)({type:[x.Z],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],j.prototype,"labelingInfo",void 0),(0,l._)([(0,p.Cb)(Z.iR)],j.prototype,"labelsVisible",void 0),(0,l._)([(0,p.Cb)({type:[c.Z],json:{write:!0}})],j.prototype,"fields",void 0),(0,l._)([(0,k.c)("fields")],j.prototype,"writeFields",null),(0,l._)([(0,_.r)("fields")],j.prototype,"readFields",null);var R=j=E=(0,l._)([(0,d.j)("esri.layers.support.FeatureReductionCluster")],j),G=r(10536),N={key:"type",base:y.B,typeMap:{cluster:R,binning:I}},F={types:{key:"type",base:y.B,typeMap:{selection:G.Z,cluster:R,binning:I}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:N},"portal-item":{types:N},"web-scene":{types:{key:"type",base:y.B,typeMap:{selection:G.Z}}}}}},O=r(20478),P=function(e){var t=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).own(e.watch("renderer",(function(){if(e.featureReduction){var t=e._normalizeFeatureReduction(e.featureReduction);e._set("featureReduction",t)}}),!0)),e}return(0,o.Z)(r,[{key:"featureReduction",set:function(e){var t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}},{key:"renderer",set:function(e){}},{key:"_normalizeFeatureReduction",value:function(e){var t,r;if("cluster"!==(null===e||void 0===e?void 0:e.type))return e;var n=e.clone(),a=[new c.Z({name:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],o=(null!==(t=n.fields)&&void 0!==t?t:[]).filter((function(e){return!e.isAutoGenerated}));if(e.renderer&&(null===(r=e.renderer.authoringInfo)||void 0===r||!r.isAutoGenerated))return n.fields=[].concat(a,(0,i.Z)(o)),n;if(e.symbol)return n.fields=[].concat(a,(0,i.Z)(o)),n.renderer=null,n;if(!this.renderer)return e;var s=(0,O.S1)(a,this.renderer,e,null,!1);return n.fields=[].concat(a,(0,i.Z)(o)),n.renderer=s,n}}]),r}(e);return(0,l._)([(0,p.Cb)(F)],t.prototype,"featureReduction",null),t=(0,l._)([(0,d.j)("esri.layers.mixins.FeatureReductionLayer")],t)}},71684:function(e,t,r){r.d(t,{Q:function(){return x}});var n=r(74165),i=r(15861),a=r(15671),o=r(43144),s=r(97326),u=r(60136),l=r(29388),p=r(27366),d=r(32718),c=r(66978),y=r(49861),f=(r(25243),r(63780),r(93169),r(69912)),h=r(37762),v=r(40281),m=(r(10064),r(2173),r(27088)),g=new v.Z,b=new WeakMap;function w(e){return null!=e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e}function _(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:_(t,e%t):0}var k=0,Z=0;function C(){var e,t=Date.now(),r=(0,h.Z)(g);try{for(r.s();!(e=r.n()).done;){var n,i=e.value;if(i.refreshInterval)t-(null!==(n=b.get(i))&&void 0!==n?n:0)+5>=6e4*i.refreshInterval&&(b.set(i,t),i.refresh(t))}}catch(a){r.e(a)}finally{r.f()}}(0,m.EH)((function(){var e,t=Date.now(),r=0,n=(0,h.Z)(g);try{for(n.s();!(e=n.n()).done;){var i=e.value;r=_(Math.round(6e4*i.refreshInterval),r),i.refreshInterval?b.get(i)||b.set(i,t):b.delete(i)}}catch(a){n.e(a)}finally{n.f()}if(r!==Z){if(Z=r,clearInterval(k),0===Z)return void(k=0);k=setInterval(C,Z)}}));var x=function(e){var t=function(e){(0,u.Z)(r,e);var t=(0,l.Z)(r);function r(){var e;(0,a.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).refreshInterval=0,e.refreshTimestamp=0,e._debounceHasDataChanged=(0,c.Ds)((function(){return e.hasDataChanged()})),e.when().then((function(){e.destroyed||function(e){w(e)&&g.push(e)}((0,s.Z)(e))}),(function(){})),e}return(0,o.Z)(r,[{key:"destroy",value:function(){!function(e){w(e)&&g.includes(e)&&g.remove(e)}(this)}},{key:"refreshParameters",get:function(){return{_ts:this.refreshTimestamp||null}}},{key:"refresh",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();(0,c.R8)(this._debounceHasDataChanged()).then((function(r){r&&e._set("refreshTimestamp",t),e.emit("refresh",{dataChanged:r})}),(function(t){d.Z.getLogger(e).error(t),e.emit("refresh",{dataChanged:!1,error:t})}))}},{key:"hasDataChanged",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),r}(e);return(0,p._)([(0,y.Cb)({type:Number,cast:function(e){return e>=.1?e:e<=0?0:.1},json:{write:!0}})],t.prototype,"refreshInterval",void 0),(0,p._)([(0,y.Cb)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),(0,p._)([(0,y.Cb)()],t.prototype,"refreshParameters",null),t=(0,p._)([(0,f.j)("esri.layers.mixins.RefreshableLayer")],t),t}},87562:function(e,t,r){r.d(t,{B:function(){return d}});var n=r(43144),i=r(15671),a=r(60136),o=r(29388),s=r(27366),u=r(46784),l=r(49861),p=(r(25243),r(63780),r(93169),r(69912)),d=function(e){(0,a.Z)(r,e);var t=(0,o.Z)(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).type=null,e}return(0,n.Z)(r)}(u.wq);(0,s._)([(0,l.Cb)({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],d.prototype,"type",void 0),d=(0,s._)([(0,p.j)("esri.layers.support.FeatureReduction")],d)},10536:function(e,t,r){r.d(t,{Z:function(){return y}});var n,i=r(15671),a=r(43144),o=r(60136),s=r(29388),u=r(27366),l=r(49861),p=(r(25243),r(63780),r(93169),r(69912)),d=r(87562),c=n=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).type="selection",n}return(0,a.Z)(r,[{key:"clone",value:function(){return new n}}]),r}(d.B);(0,u._)([(0,l.Cb)({type:["selection"]})],c.prototype,"type",void 0);var y=c=n=(0,u._)([(0,p.j)("esri.layers.support.FeatureReductionSelection")],c)},83040:function(e,t,r){r.d(t,{Z:function(){return w}});var n,i=r(15671),a=r(43144),o=r(60136),s=r(29388),u=r(27366),l=r(43404),p=r(46784),d=r(49861),c=r(25243),y=(r(63780),r(93169),r(27135)),f=r(38511),h=r(69912),v=r(66591),m=r(85249),g=new l.X({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"}),b=n=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).alias=null,n.defaultValue=void 0,n.description=null,n.domain=null,n.editable=!0,n.length=-1,n.name=null,n.nullable=!0,n.type=null,n.valueType=null,n.visible=!0,n}return(0,a.Z)(r,[{key:"readDescription",value:function(e,t){var r,n,i=t.description,a=null;try{a=i?JSON.parse(i):null}catch(o){}return null!==(r=null===(n=a)||void 0===n?void 0:n.value)&&void 0!==r?r:null}},{key:"readValueType",value:function(e,t){var r=t.description,n=null;try{n=r?JSON.parse(r):null}catch(i){}return n?g.fromJSON(n.fieldValueType):null}},{key:"clone",value:function(){return new n({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}}]),r}(p.wq);(0,u._)([(0,d.Cb)({type:String,json:{write:!0}})],b.prototype,"alias",void 0),(0,u._)([(0,d.Cb)({type:[String,Number],json:{write:{allowNull:!0}}})],b.prototype,"defaultValue",void 0),(0,u._)([(0,d.Cb)()],b.prototype,"description",void 0),(0,u._)([(0,f.r)("description")],b.prototype,"readDescription",null),(0,u._)([(0,d.Cb)({types:v.V5,json:{read:{reader:v.im},write:!0}})],b.prototype,"domain",void 0),(0,u._)([(0,d.Cb)({type:Boolean,json:{write:!0}})],b.prototype,"editable",void 0),(0,u._)([(0,d.Cb)({type:c.z8,json:{write:!0}})],b.prototype,"length",void 0),(0,u._)([(0,d.Cb)({type:String,json:{write:!0}})],b.prototype,"name",void 0),(0,u._)([(0,d.Cb)({type:Boolean,json:{write:!0}})],b.prototype,"nullable",void 0),(0,u._)([(0,y.J)(m.v)],b.prototype,"type",void 0),(0,u._)([(0,d.Cb)()],b.prototype,"valueType",void 0),(0,u._)([(0,f.r)("valueType",["description"])],b.prototype,"readValueType",null),(0,u._)([(0,d.Cb)({type:Boolean,json:{read:!1}})],b.prototype,"visible",void 0);var w=b=n=(0,u._)([(0,h.j)("esri.layers.support.Field")],b)},45948:function(e,t,r){r.d(t,{qG:function(){return _},PV:function(){return v},id:function(){return Z},iR:function(){return y},rn:function(){return h},rT:function(){return T},u1:function(){return x},rO:function(){return C},Oh:function(){return b},bT:function(){return w},C_:function(){return c},Lx:function(){return m},vg:function(){return k},YI:function(){return d},HQ:function(){return f}});var n=r(1413),i=r(62044),a=r(53866),o=r(78952),s=r(53283),u=(r(63780),r(66978),r(86710));var l=r(64575),p=r(81219),d={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:!0}},c={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:function(e,t){return!t.disablePopup}},write:{enabled:!0,writer:function(e,t,r){t[r]=!e}}}},y={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:!0}},f={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:s.w}}},h={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:!0}},v={value:null,type:l.Z,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:!0}};function m(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}var g={write:!0,read:!0},b={type:Number,json:{origins:{"web-document":g,"portal-item":{write:!0}}}},w=(0,n.Z)((0,n.Z)({},b),{},{json:(0,n.Z)((0,n.Z)({},b.json),{},{origins:{"web-document":(0,n.Z)((0,n.Z)({},g),{},{write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}})},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:function(e,t,r){return r&&"service"!==r.origin||!t.drawingInfo||void 0===t.drawingInfo.transparency?t.layerDefinition&&t.layerDefinition.drawingInfo&&void 0!==t.layerDefinition.drawingInfo.transparency?(0,p.b)(t.layerDefinition.drawingInfo.transparency):void 0:(0,p.b)(t.drawingInfo.transparency)}}})}),_={type:i.Z,readOnly:!0,get:function(){var e,t;if(null===(e=this.layer)||void 0===e||!e.timeInfo)return null;var r=this.layer,n=r.datesInUnknownTimezone,a=r.timeOffset,o=r.useViewTime,s=null===(t=this.view)||void 0===t?void 0:t.timeExtent,l=this.layer.timeExtent;n&&(l=function(e){if(!e)return e;var t=e.start,r=e.end;return new i.Z({start:null!=t?(0,u.Nm)(t,t.getTimezoneOffset(),"minutes"):t,end:null!=r?(0,u.Nm)(r,r.getTimezoneOffset(),"minutes"):r})}(l));var p=o?s&&l?s.intersection(l):s||l:l;if(!p||p.isEmpty||p.isAllTime)return p;a&&(p=p.offset(-a.value,a.unit)),n&&(p=function(e){if(!e)return e;var t=e.start,r=e.end;return new i.Z({start:null!=t?(0,u.Nm)(t,-t.getTimezoneOffset(),"minutes"):t,end:null!=r?(0,u.Nm)(r,-r.getTimezoneOffset(),"minutes"):r})}(p));var d=this._get("timeExtent");return p.equals(d)?d:p}},k={type:a.Z,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:function(e,t){var r=a.Z.fromJSON(e);return null!=t.spatialReference&&"object"==typeof t.spatialReference&&(r.spatialReference=o.Z.fromJSON(t.spatialReference)),r}}}},read:!1}},Z={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},C={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}},x={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}},T={json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}}},66591:function(e,t,r){r.d(t,{im:function(){return I},V5:function(){return E}});r(93169);var n,i=r(15671),a=r(43144),o=r(60136),s=r(29388),u=r(27366),l=r(84652),p=r(49861),d=(r(25243),r(27135)),c=r(69912),y=r(46784),f=(r(63780),n=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).name=null,n.code=null,n}return(0,a.Z)(r,[{key:"clone",value:function(){return new n({name:this.name,code:this.code})}}]),r}(y.wq));(0,u._)([(0,p.Cb)({type:String,json:{write:!0}})],f.prototype,"name",void 0),(0,u._)([(0,p.Cb)({type:[String,Number],json:{write:!0}})],f.prototype,"code",void 0),f=n=(0,u._)([(0,c.j)("esri.layers.support.CodedValue")],f);var h=new(r(43404).X)({inherited:"inherited",codedValue:"coded-value",range:"range"}),v=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).name=null,n.type=null,n}return(0,a.Z)(r)}(y.wq);(0,u._)([(0,p.Cb)({type:String,json:{write:!0}})],v.prototype,"name",void 0),(0,u._)([(0,d.J)(h)],v.prototype,"type",void 0);var m,g=v=(0,u._)([(0,c.j)("esri.layers.support.Domain")],v),b=m=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).codedValues=null,n.type="coded-value",n}return(0,a.Z)(r,[{key:"getName",value:function(e){var t=null;if(this.codedValues){var r=String(e);this.codedValues.some((function(e){return String(e.code)===r&&(t=e.name),!!t}))}return t}},{key:"clone",value:function(){return new m({codedValues:(0,l.d9)(this.codedValues),name:this.name})}}]),r}(g);(0,u._)([(0,p.Cb)({type:[f],json:{write:!0}})],b.prototype,"codedValues",void 0),(0,u._)([(0,d.J)({codedValue:"coded-value"})],b.prototype,"type",void 0);var w,_=b=m=(0,u._)([(0,c.j)("esri.layers.support.CodedValueDomain")],b),k=(r(32718),r(10064),w=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).type="inherited",n}return(0,a.Z)(r,[{key:"clone",value:function(){return new w}}]),r}(g));(0,u._)([(0,d.J)({inherited:"inherited"})],k.prototype,"type",void 0);var Z,C=k=w=(0,u._)([(0,c.j)("esri.layers.support.InheritedDomain")],k),x=Z=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).maxValue=null,n.minValue=null,n.type="range",n}return(0,a.Z)(r,[{key:"clone",value:function(){return new Z({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}}]),r}(g);(0,u._)([(0,p.Cb)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(e,t,r){t[r]=[this.minValue||0,e]}}}})],x.prototype,"maxValue",void 0),(0,u._)([(0,p.Cb)({type:Number,json:{type:[Number],read:{source:"range",reader:function(e,t){return t.range&&t.range[0]}},write:{target:"range",writer:function(e,t,r){t[r]=[e,this.maxValue||0]}}}})],x.prototype,"minValue",void 0),(0,u._)([(0,d.J)({range:"range"})],x.prototype,"type",void 0);var T=x=Z=(0,u._)([(0,c.j)("esri.layers.support.RangeDomain")],x),E={key:"type",base:g,typeMap:{range:x,"coded-value":_,inherited:C}};function I(e){if(!e||!e.type)return null;switch(e.type){case"range":return T.fromJSON(e);case"codedValue":return _.fromJSON(e);case"inherited":return C.fromJSON(e)}return null}},85249:function(e,t,r){r.d(t,{v:function(){return n}});var n=new(r(43404).X)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"})},99837:function(e,t,r){r.d(t,{Z:function(){return v}});var n,i=r(15671),a=r(43144),o=r(60136),s=r(29388),u=r(27366),l=r(46784),p=r(84652),d=r(49861),c=r(25243),y=r(69912),f=r(31201),h=n=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(e){var n;return(0,i.Z)(this,r),(n=t.call(this,e)).attachmentTypes=null,n.attachmentsWhere=null,n.cacheHint=void 0,n.keywords=null,n.globalIds=null,n.name=null,n.num=null,n.objectIds=null,n.returnMetadata=!1,n.size=null,n.start=null,n.where=null,n}return(0,a.Z)(r,[{key:"writeStart",value:function(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}},{key:"clone",value:function(){return new n((0,p.d9)({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}}]),r}(l.wq);(0,u._)([(0,d.Cb)({type:[String],json:{write:!0}})],h.prototype,"attachmentTypes",void 0),(0,u._)([(0,d.Cb)({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],h.prototype,"attachmentsWhere",void 0),(0,u._)([(0,d.Cb)({type:Boolean,json:{write:!0}})],h.prototype,"cacheHint",void 0),(0,u._)([(0,d.Cb)({type:[String],json:{write:!0}})],h.prototype,"keywords",void 0),(0,u._)([(0,d.Cb)({type:[Number],json:{write:!0}})],h.prototype,"globalIds",void 0),(0,u._)([(0,d.Cb)({json:{write:!0}})],h.prototype,"name",void 0),(0,u._)([(0,d.Cb)({type:Number,json:{read:{source:"resultRecordCount"}}})],h.prototype,"num",void 0),(0,u._)([(0,d.Cb)({type:[Number],json:{write:!0}})],h.prototype,"objectIds",void 0),(0,u._)([(0,d.Cb)({type:Boolean,json:{default:!1,write:!0}})],h.prototype,"returnMetadata",void 0),(0,u._)([(0,d.Cb)({type:[Number],json:{write:!0}})],h.prototype,"size",void 0),(0,u._)([(0,d.Cb)({type:Number,json:{read:{source:"resultOffset"}}})],h.prototype,"start",void 0),(0,u._)([(0,f.c)("start"),(0,f.c)("num")],h.prototype,"writeStart",null),(0,u._)([(0,d.Cb)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],h.prototype,"where",void 0),(h=n=(0,u._)([(0,y.j)("esri.rest.support.AttachmentQuery")],h)).from=(0,c.se)(h);var v=h},49818:function(e,t,r){r.d(t,{Z:function(){return x}});var n,i=r(29439),a=r(37762),o=r(15671),s=r(43144),u=r(60136),l=r(29388),p=r(27366),d=r(59486),c=r(52639),y=r(43404),f=r(46784),h=r(84652),v=r(49861),m=(r(25243),r(38511)),g=r(69912),b=r(31201),w=r(78952),_=r(77981),k=r(83040),Z=new y.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null}),C=n=function(e){(0,u.Z)(r,e);var t=(0,l.Z)(r);function r(e){var n;return(0,o.Z)(this,r),(n=t.call(this,e)).displayFieldName=null,n.exceededTransferLimit=!1,n.features=[],n.fields=null,n.geometryType=null,n.hasM=!1,n.hasZ=!1,n.queryGeometry=null,n.spatialReference=null,n}return(0,s.Z)(r,[{key:"readFeatures",value:function(e,t){for(var r=w.Z.fromJSON(t.spatialReference),n=[],i=0;i<e.length;i++){var a=e[i],o=c.Z.fromJSON(a),s=a.geometry&&a.geometry.spatialReference;null==o.geometry||s||(o.geometry.spatialReference=r);var u=a.aggregateGeometries,l=o.aggregateGeometries;if(u&&null!=l)for(var p in l){var d=l[p],y=u[p],f=null===y||void 0===y?void 0:y.spatialReference;null==d||f||(d.spatialReference=r)}n.push(o)}return n}},{key:"writeGeometryType",value:function(e,t,r,n){if(e)Z.write(e,t,r,n);else{var i=this.features;if(i){var o,s=(0,a.Z)(i);try{for(s.s();!(o=s.n()).done;){var u=o.value;if(u&&null!=u.geometry)return void Z.write(u.geometry.type,t,r,n)}}catch(l){s.e(l)}finally{s.f()}}}}},{key:"readQueryGeometry",value:function(e,t){if(!e)return null;var r=!!e.spatialReference,n=(0,_.im)(e);return n&&!r&&t.spatialReference&&(n.spatialReference=w.Z.fromJSON(t.spatialReference)),n}},{key:"writeSpatialReference",value:function(e,t){if(e)t.spatialReference=e.toJSON();else{var r=this.features;if(r){var n,i=(0,a.Z)(r);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o&&null!=o.geometry&&o.geometry.spatialReference)return void(t.spatialReference=o.geometry.spatialReference.toJSON())}}catch(s){i.e(s)}finally{i.f()}}}}},{key:"clone",value:function(){return new n(this.cloneProperties())}},{key:"cloneProperties",value:function(){return(0,h.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}},{key:"toJSON",value:function(e){var t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(var r=0;r<t.features.length;r++){var n=t.features[r];if(n.geometry){var i=e&&e[r];n.geometry=i&&i.toJSON()||n.geometry}}return t}},{key:"quantize",value:function(e){for(var t=(0,i.Z)(e.scale,2),r=t[0],n=t[1],a=(0,i.Z)(e.translate,2),o=a[0],s=a[1],u=this.features,l=this._getQuantizationFunction(this.geometryType,(function(e){return Math.round((e-o)/r)}),(function(e){return Math.round((s-e)/n)})),p=0,d=u.length;p<d;p++)(null===l||void 0===l?void 0:l(u[p].geometry))||(u.splice(p,1),p--,d--);return this.transform=e,this}},{key:"unquantize",value:function(){var e,t,r=this.geometryType,n=this.features,o=this.transform;if(!o)return this;var s=(0,i.Z)(o.translate,2),u=s[0],l=s[1],p=(0,i.Z)(o.scale,2),d=p[0],c=p[1],y=null,f=null;if(this.hasZ&&null!=(null===o||void 0===o||null===(e=o.scale)||void 0===e?void 0:e[2])){var h=(0,i.Z)(o.translate,3)[2],v=(0,i.Z)(o.scale,3)[2];y=function(e){return e*v+h}}if(this.hasM&&null!=(null===o||void 0===o||null===(t=o.scale)||void 0===t?void 0:t[3])){var m=(0,i.Z)(o.translate,4)[3],g=(0,i.Z)(o.scale,4)[3];f=function(e){return null==e?e:e*g+m}}var b,w=this._getHydrationFunction(r,(function(e){return e*d+u}),(function(e){return l-e*c}),y,f),_=(0,a.Z)(n);try{for(_.s();!(b=_.n()).done;){var k=b.value.geometry;null!=k&&w&&w(k)}}catch(Z){_.e(Z)}finally{_.f()}return this.transform=null,this}},{key:"_quantizePoints",value:function(e,t,r){for(var n,i,a=[],o=0,s=e.length;o<s;o++){var u=e[o];if(o>0){var l=t(u[0]),p=r(u[1]);l===n&&p===i||(a.push([l-n,p-i]),n=l,i=p)}else n=t(u[0]),i=r(u[1]),a.push([n,i])}return a.length>0?a:null}},{key:"_getQuantizationFunction",value:function(e,t,r){var n=this;return"point"===e?function(e){return e.x=t(e.x),e.y=r(e.y),e}:"polyline"===e||"polygon"===e?function(e){for(var i=(0,_.oU)(e)?e.rings:e.paths,a=[],o=0,s=i.length;o<s;o++){var u=i[o],l=n._quantizePoints(u,t,r);l&&a.push(l)}return a.length>0?((0,_.oU)(e)?e.rings=a:e.paths=a,e):null}:"multipoint"===e?function(e){var i=n._quantizePoints(e.points,t,r);return i&&i.length>0?(e.points=i,e):null}:"extent"===e?function(e){return e}:null}},{key:"_getHydrationFunction",value:function(e,t,r,n,i){return"point"===e?function(e){e.x=t(e.x),e.y=r(e.y),n&&(e.z=n(e.z))}:"polyline"===e||"polygon"===e?function(e){for(var a,o,s=(0,_.oU)(e)?e.rings:e.paths,u=0,l=s.length;u<l;u++)for(var p=s[u],d=0,c=p.length;d<c;d++){var y=p[d];d>0?(a+=y[0],o+=y[1]):(a=y[0],o=y[1]),y[0]=t(a),y[1]=r(o)}if(n&&i)for(var f=0,h=s.length;f<h;f++)for(var v=s[f],m=0,g=v.length;m<g;m++){var b=v[m];b[2]=n(b[2]),b[3]=i(b[3])}else if(n)for(var w=0,k=s.length;w<k;w++)for(var Z=s[w],C=0,x=Z.length;C<x;C++){var T=Z[C];T[2]=n(T[2])}else if(i)for(var E=0,I=s.length;E<I;E++)for(var M=s[E],S=0,L=M.length;S<L;S++){var D=M[S];D[2]=i(D[2])}}:"extent"===e?function(e){e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax),n&&null!=e.zmax&&null!=e.zmin&&(e.zmax=n(e.zmax),e.zmin=n(e.zmin)),i&&null!=e.mmax&&null!=e.mmin&&(e.mmax=i(e.mmax),e.mmin=i(e.mmin))}:"multipoint"===e?function(e){for(var a,o,s=e.points,u=0,l=s.length;u<l;u++){var p=s[u];u>0?(a+=p[0],o+=p[1]):(a=p[0],o=p[1]),p[0]=t(a),p[1]=r(o)}if(n&&i)for(var d=0,c=s.length;d<c;d++){var y=s[d];y[2]=n(y[2]),y[3]=i(y[3])}else if(n)for(var f=0,h=s.length;f<h;f++){var v=s[f];v[2]=n(v[2])}else if(i)for(var m=0,g=s.length;m<g;m++){var b=s[m];b[2]=i(b[2])}}:null}}]),r}(f.wq);(0,p._)([(0,v.Cb)({type:String,json:{write:!0}})],C.prototype,"displayFieldName",void 0),(0,p._)([(0,v.Cb)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],C.prototype,"exceededTransferLimit",void 0),(0,p._)([(0,v.Cb)({type:[c.Z],json:{write:!0}})],C.prototype,"features",void 0),(0,p._)([(0,m.r)("features")],C.prototype,"readFeatures",null),(0,p._)([(0,v.Cb)({type:[k.Z],json:{write:!0}})],C.prototype,"fields",void 0),(0,p._)([(0,v.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:Z.read}}})],C.prototype,"geometryType",void 0),(0,p._)([(0,b.c)("geometryType")],C.prototype,"writeGeometryType",null),(0,p._)([(0,v.Cb)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],C.prototype,"hasM",void 0),(0,p._)([(0,v.Cb)({type:Boolean,json:{write:{overridePolicy:function(e){return{enabled:e}}}}})],C.prototype,"hasZ",void 0),(0,p._)([(0,v.Cb)({types:d.qM,json:{write:!0}})],C.prototype,"queryGeometry",void 0),(0,p._)([(0,m.r)("queryGeometry")],C.prototype,"readQueryGeometry",null),(0,p._)([(0,v.Cb)({type:w.Z,json:{write:!0}})],C.prototype,"spatialReference",void 0),(0,p._)([(0,b.c)("spatialReference")],C.prototype,"writeSpatialReference",null),(0,p._)([(0,v.Cb)({json:{write:!0}})],C.prototype,"transform",void 0),(C=n=(0,p._)([(0,g.j)("esri.rest.support.FeatureSet")],C)).prototype.toJSON.isDefaultToJSON=!0;var x=C},81085:function(e,t,r){r.d(t,{eZ:function(){return p}});var n=r(1413),i=r(44055),a=r(37270),o=r(26418),s=(r(23046),r(1374),r(39384),r(29230)),u=(r(29514),r(44051),r(98752),r(16698)),l=r(91738);function p(e,t){var r=e.displayField,n=e.editFieldsInfo,u=e.fields,l=e.objectIdField,p=e.title;if(!u)return null;var d=y({editFieldsInfo:n,fields:u,objectIdField:l},t);if(!d.length)return null;var c=function(e){var t=(0,a.O5)(e),r=e.titleBase;return t?"".concat(r,": {").concat(t.trim(),"}"):null!==r&&void 0!==r?r:""}({titleBase:p,fields:u,displayField:r}),f=[new s.Z,new o.Z];return new i.Z({title:c,content:f,fieldInfos:d})}var d=function(e,t){return t.visibleFieldNames?t.visibleFieldNames.has(e.name):(0,a.Fv)(e,t)};function c(e,t){return"oid"===e.type?-1:"oid"===t.type?1:h(e)?-1:h(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function y(e,t){var r,i=null===t||void 0===t?void 0:t.visibleFieldNames;return function(e,t){var r=e;return t&&(e=e.filter((function(e){return!t.includes(e.type)}))),e===r&&(e=e.slice()),e.sort(c),e}(null!==(r=e.fields)&&void 0!==r?r:[],(null===t||void 0===t?void 0:t.ignoreFieldTypes)||v).map((function(t){return new u.Z({fieldName:t.name,isEditable:(0,a.Hp)(t,e),label:t.alias,format:f(t),visible:d(t,(0,n.Z)((0,n.Z)({},e),{},{visibleFieldNames:i}))})}))}function f(e){switch(e.type){case"small-integer":case"integer":case"single":return new l.Z({digitSeparator:!0,places:0});case"double":return new l.Z({digitSeparator:!0,places:2});case"date":return new l.Z({dateFormat:"long-month-day-year"});default:return"string"===e.type&&(0,a.Ec)(e.name)?new l.Z({digitSeparator:!0,places:0}):null}}function h(e){return"name"===(e.name&&e.name.toLowerCase())||"name"===(e.alias&&e.alias.toLowerCase())}var v=["geometry","blob","raster","guid","xml"]},76115:function(e,t,r){r.d(t,{ET:function(){return a},I4:function(){return i},eG:function(){return u},lF:function(){return o},lj:function(){return p},qP:function(){return s},wW:function(){return l}});var n=[252,146,31,255],i={type:"esriSMS",style:"esriSMSCircle",size:6,color:n,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},a={type:"esriSLS",style:"esriSLSSolid",width:.75,color:n},o={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},s={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},u={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},l={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},p={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}}}]);
//# sourceMappingURL=6182.dc12afaf.chunk.js.map